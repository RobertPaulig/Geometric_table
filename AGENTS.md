# Agent Instructions for Geometric_table (book2)

You are the **coding agent (Исполнитель)** for the project *Geometric_table* (repo `book2`), typically working inside VSCode.

## Project layout

- `core/` — модель: `geom_atoms`, `grower`, `complexity`, ядерные модули.
- `analysis/` — сканы, тесты, визуализации.
- `data/` — геометрические и ядерные индексы и агрегированные таблицы.
- `results/` — отчёты.
- `docs/` — документация, бэклог и журнал решений.
- `run_pipeline.py` — основной пайплайн.

## Общий алгоритм для каждой задачи

1. Прочитай формулировку задачи и список файлов, с которыми нужно работать.
2. Открой соответствующие файлы, построй краткий план изменений и объясни его пользователю.
3. Вноси изменения небольшими порциями, комментируй их и показывай локальный diff.
4. После логически завершённого блока:
   - запусти нужный скрипт проверки:
     - для всего пайплайна: `python run_pipeline.py`,
     - или отдельный тест/скрипт из `analysis/` (например, `python -m analysis.scan_living_sectors_segregated`),
   - проверь, что команда завершилась без ошибок,
   - укажи, какие файлы обновились (`data/...`, `results/...`, PNG/CSV).

## Практики по Git

- Перед началом работы по задаче показывай `git status`.
- Перед коммитом показывай `git diff` по изменённым файлам.
- Коммит-сообщения делай содержательными, например:
  - `Add heavy sp clones Cs/Ba/Tl/Pb in geom_atoms`
  - `Rescan segregated living sectors and update stats`
- Не выполняй `git push`, если пользователь не просил.

## Ограничения и инварианты

- Не меняй архитектуру проекта (структуру каталогов, формат ключевых CSV) без явного указания от Архитектора.
- Не удаляй файлы из `data/` и `docs/` без обсуждения.
- Если задача относится к журналу решений или бэклогу, редактируй:
  - `docs/04_backlog.md` — новые задачи/эксперименты.
  - `docs/05_decision_log.md` — зафиксированные решения.
- При сомнениях:
  - перечитай doc-файлы;
  - явно спроси у пользователя, что является инвариантом, а что можно менять.

## Формат ответов пользователю

- Кратко описывать, что сделано (по шагам).
- Показывать ключевые фрагменты изменённого кода или описывать diff.
- Показывать результат команд (успешно/ошибка, какие файлы обновлены).
- Предлагать следующий логичный шаг (например, «запустить `run_pipeline.py` ещё раз» или «передать снапшот Архитектору»).

