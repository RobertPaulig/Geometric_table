\documentclass[12pt,a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[russian]{babel}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{bm}
\usepackage{hyperref}
\usepackage{geometry}
\geometry{margin=2.5cm}

\title{Геометрическая таблица атомов на основе спектральной самоорганизации\\[4pt]
\large Самодостаточная постановка модели и вычислительного ТЗ}
\author{Роберт Паулиг}
\date{\today}

\begin{document}
\setlength{\emergencystretch}{2em} % снизить риск переполнения строк
\maketitle

\tableofcontents

% ==========================
% ЧАСТЬ I. ВВЕДЕНИЕ И КОНСТИТУЦИЯ МОДЕЛИ
% ==========================
\section{Введение}

\subsection{Зачем нужен этот документ}

Этот текст не претендует на роль учебника по физике для широкой аудитории.
Он написан как рабочая книга для узкого круга людей, которым важно:

\begin{itemize}
  \item иметь \textbf{цельную онтологию} физической реальности без
        релятивистской геометрии и квантовой мистики;
  \item иметь \textbf{один самодостаточный документ}, в котором собраны
        все ключевые определения, постулаты и функционалы модели;
  \item иметь \textbf{прямую связку} между идеями и кодом: формулы и
        структуры здесь должны быть реализуемы в виде программного
        комплекса без обращения к внешним источникам;
  \item избежать бесконечного хождения по статьям и заметкам, каждый
        раз заново восстанавливая, «что же мы на самом деле считаем».
\end{itemize}

Практически этот документ играет три роли:

\begin{enumerate}
  \item \textbf{Конституция модели.} Чётко сформулированные постулаты
        и онтология: что мы считаем реальным, а что осознанно выбрасываем
        (ОТО, СТО, четырёхмерное пространство-время).
  \item \textbf{Техническое задание (ТЗ).} Явное описание того, какие
        операторы, функционалы и алгоритмы должны быть реализованы в
        программном комплексе спектральной физики.
  \item \textbf{Дорожная карта (roadmap).} Разделение на \emph{зелёную
        зону} (что уже можно считать), \emph{жёлтую} (что структурировано,
        но не доведено до формул) и \emph{красную} (дальняя программа).
\end{enumerate}

Цель: чтобы любой участник проекта, открыв этот документ, мог:

\begin{itemize}
  \item понять, \emph{какую} реальность мы описываем;
  \item увидеть, \emph{какие} математические объекты нужно реализовать;
  \item быстро соотнести теорию с текущим состоянием кода.
\end{itemize}


\subsection{История идеи и мотивация}

Классическая картина физики XX века построена вокруг двух столпов:

\begin{itemize}
  \item относительность (СТО/ОТО), где гравитация трактуется как
        искривление пространства-времени;
  \item квантовая механика, где поведение микромира описывается через
        абстрактные волновые функции и вероятности.
\end{itemize}

Эта конструкция даёт впечатляющий объём совпадений с экспериментом, но:

\begin{itemize}
  \item она плохо согласуется с интуитивным представлением о \emph{реальной
        среде}, в которой происходят процессы;
  \item она приводит к сущностям вроде «чёрных дыр» и сингулярностей,
        которые выглядят как математические артефакты, а не физические объекты;
  \item она опирается на формализм, который трудно напрямую связать с
        вычислимой картиной непрерывного поля / среды.
\end{itemize}

Рабочая гипотеза, на которой строится этот документ:

\begin{quote}
  В основе физической реальности лежит \textbf{единая непрерывная Среда}
  в трёхмерном евклидовом пространстве. Материя, поля и гравитация
  возникают как различные режимы спектральной самоорганизации этой Среды.
\end{quote}

Из этого мы:

\begin{itemize}
  \item \textbf{отказываемся} от идеи искривлённого пространства-времени
        и любых релятивистских метрик как фундаментальных;
  \item \textbf{сохраняем} время как параметр эволюции процессов, а не
        как координату;
  \item \textbf{делаем ставку} на спектральное описание: локальная
        плотность состояний Среды, её спектральный потенциал и возникающие
        на этом фоне солитонные структуры.
\end{itemize}

Дополнительная мотивация:

\begin{itemize}
  \item В последние годы (2024--2025) появляются работы, где спектральные
        и геометрические подходы используются для описания атомов,
        вихревых солитонов и самоорганизации структур в конденсированных
        средах. Это подтверждает, что выбранное направление не изолировано
        от большой науки.
  \item Накоплен собственный код и набор численных экспериментов
        (спектральные тени, игрушечные операторы, LDOS-карты), который
        требует единой теоретической надстройки.
\end{itemize}

Этот документ --- попытка собрать разрозненные идеи и наработки в одну
логическую линию: от онтологии Среды до Геометрической Таблицы атомов
и требований к программному комплексу.


\subsection{Краткий обзор структуры книги}

Книга разбита на несколько частей, каждая из которых отвечает на свой
круг вопросов.

\begin{itemize}
  \item \textbf{Часть I. Введение и конституция модели.}\\
        Здесь формулируются базовые постулаты: трёхмерное евклидово
        пространство, единая Среда, спектральное описание, материя как
        солитоны, определение гравитации через спектральный потенциал.
        Эта часть задаёт «правила игры», от которых мы не отступаем.

  \item \textbf{Часть II. Среда и спектральное описание.}\\
        Вводятся локальная спектральная плотность
        $\rho_{\text{spec}}(\omega,x,t)$, гравитационно значимая мощность
        $I_{\text{grav}}(x,t)$, спектральный потенциал $\phi(x,t)$ и
        поле ускорений $\bm g(x,t) = -\nabla\phi(x,t)$. Обсуждается
        связь с понятием плотности состояний (DOS/LDOS).

  \item \textbf{Часть III. Солитоны, частицы и масса.}\\
        Даётся определение солитонов Среды, вводится топологическое
        описание (графы, узлы, деревья) и формула для эффективной массы
        как функционала от спектра и топологии конфигурации.

  \item \textbf{Часть IV. Спектральная гравитация.}\\
        Поясняется, как из спектрального потенциала выводятся привычные
        гравитационные эффекты: притяжение, орбиты, сдвиг частот процессов,
        отклонение волн в поле.

  \item \textbf{Часть V. Геометрическая Таблица атомов.}\\
        Формулируется понятие геометрического атома как минимума
        функционала $F_{\text{atom}} = F_{\text{levels}} + F_{\text{geom}}$,
        обсуждаются валентность и «порты» связей, строится прототип
        мини-таблицы для элементов H–Ne.

  \item \textbf{Часть VI. Вычислительное ТЗ и архитектура ПО.}\\
        Описывается структура программного комплекса: модули Среды и
        гравитации, оператора $H[\theta]$ и DOS/LDOS, оптимизации
        (Symmetric Newton), интеграции (FDM), визуализации. Эта часть
        задаёт требования к реальному коду.

  \item \textbf{Часть VII. Ограничения и дорожная карта.}\\
        Честно перечисляются области, где модель уже даёт расчёты
        (зелёная зона), области с частично прописанной математикой
        (жёлтая зона) и дальние направления (красная зона).

  \item \textbf{Приложения.}\\
        Содержат компактный список постулатов v0.1, минимальные
        математические определения, ссылки на ключевые внешние работы
        и краткое описание состояния кода.
\end{itemize}

Таким образом, документ одновременно выполняет роль концептуальной
записки, технического задания и рабочего журнала проекта спектральной
физики и Геометрической Таблицы атомов.

\section{Онтология и постулаты модели}
\label{sec:postulates}

В этой главе формулируются базовые постулаты модели. Они задают
онтологию: \emph{что считается реально существующим}, какие объекты
используются для описания мира и какие конструкции принципиально не
допускаются.

Все последующие определения, уравнения и вычислительные схемы должны
быть совместимы с этими постулатами. Если какое-то предложение
противоречит одному из них, оно либо ошибочно, либо относится к разделу
гипотез и дальнейших исследований.


\subsection{Антирелятивистский постулат}
\label{subsec:postulate-anti-rel}

\begin{quote}
  Фундаментальное описание мира не использует понятий
  искривлённого пространства-времени, динамической метрики,
  тензора кривизны и четырёхмерной геометрии.
\end{quote}

Это означает:

\begin{itemize}
  \item мы не вводим четырёхмерное пространство-время $(x^\mu)$ как
        первичную структуру;
  \item мы не используем тензор метрики $g_{\mu\nu}(x)$ как динамическое
        поле, не говорим о «кривизне» как о причине гравитации;
  \item любые попытки переписать нашу модель в терминах эффективных
        релятивистских метрик сознательно \textbf{не предпринимаются}.
\end{itemize}

Все эффекты, которые в стандартной физике описываются языком
относительности (замедление времени, гравитационный сдвиг частот,
отклонение света и т.д.), в данной модели \emph{обязаны} быть выражены
через свойства Среды и её спектра, а не через геометрию пространства.


\subsection{Постулат о пространстве и времени}
\label{subsec:postulate-space-time}

\begin{quote}
  Пространство --- трёхмерное евклидово, время --- параметр протекания
  процессов в Среде, а не геометрическая координата.
\end{quote}

Фон пространства фиксирован:

\begin{equation}
  X \simeq \mathbb{R}^3, \qquad \bar g_{ij} = \delta_{ij},
\end{equation}
где $x = (x^1,x^2,x^3)$ --- декартовы координаты, а $\delta_{ij}$ ---
единичная матрица.

Расстояние и объём определяются стандартно:

\begin{equation}
  |x-y| = \sqrt{(x^1-y^1)^2 + (x^2-y^2)^2 + (x^3-y^3)^2}, \qquad
  d^3x = dx^1 dx^2 dx^3.
\end{equation}

Время $t \in \mathbb{R}$:

\begin{itemize}
  \item \textbf{не} является четвёртой координатой;
  \item служит параметром, упорядочивающим эволюцию состояния Среды;
  \item измеряется через сравнение частот и периодов \emph{реальных}
        физических процессов (локальных солитонов, «часов»).
\end{itemize}

Таким образом, базовая геометрия мира определяется парой
$(X, t)$, где $X$ неизменно евклидово, а $t$ параметризует
последовательность состояний.


\subsection{Постулат о Среде}
\label{subsec:postulate-medium}

\begin{quote}
  Всё пространство $X$ заполнено единой непрерывной Средой, способной
  поддерживать колебания и нелинейные локализованные структуры.
\end{quote}

Свойства Среды на уровне модели:

\begin{itemize}
  \item Среда присутствует в каждой точке $x \in X$, нет «пустоты» в
        смысле отсутствия носителя физических процессов;
  \item малые возмущения вокруг некоторого фонового состояния вызывают
        распространение волн (продольных, поперечных и других типов);
  \item при достаточно сильных и/или нелинейных взаимодействиях Среда
        допускает устойчивые локализованные конфигурации (солитоны,
        вихри, узлы);
  \item существует выделенная система отсчёта --- \textbf{покой Среды};
        все скорости процессов выражаются относительно неё.
\end{itemize}

Мы сознательно не фиксируем в этом документе микроскопическую природу
Среды (её «атомарность» или отсутствие таковой). Нас интересует
эффективное описание через спектр колебаний и возникающие структуры.


\subsection{Постулат о спектральном описании}
\label{subsec:postulate-spectral}

\begin{quote}
  Состояние Среды описывается локальной спектральной плотностью
  по частотам и координатам.
\end{quote}

В каждой точке пространства и для каждого момента времени вводится
функция

\begin{equation}
  \rho_{\text{spec}}(\omega,x,t) \ge 0,
\end{equation}

которую можно интерпретировать как \emph{локальную спектральную
плотность} Среды: насколько сильно представлены моды с частотой
$\omega$ в окрестности точки $x$ в момент $t$.

Для гравитационно значимых эффектов вводится \emph{взвешенная мощность}

\begin{equation}
  I_{\text{grav}}(x,t)
  = \int_{\Omega} \alpha_{\text{grav}}(\omega)\,
      \rho_{\text{spec}}(\omega,x,t)\, d\omega,
\end{equation}

где $\Omega$ --- рабочий диапазон частот, а
$\alpha_{\text{grav}}(\omega)$ --- фиксированная весовая функция,
определяющая вклад частот в гравитационный сектор. В простейшем
приближении v0.1 можно брать
$\alpha_{\text{grav}}(\omega) \equiv 1$.


\subsection{Постулат о гравитации}
\label{subsec:postulate-gravity}

\begin{quote}
  Гравитация --- это не геометрия пространства, а эффект спектрального
  состояния Среды. Силы выводятся из градиента спектрального потенциала.
\end{quote}

\emph{Спектральный потенциал} определяется как

\begin{equation}
  \phi(x,t) = -\ln I_{\text{grav}}(x,t) + \text{const},
\end{equation}

а \emph{поле ускорений} (эффективная гравитация) задаётся градиентом
потенциала:

\begin{equation}
  \bm g(x,t) = -\nabla \phi(x,t).
  \label{eq:g}
\end{equation}

Любая масштабная «гравитационная сила» на пробный объект в данной
модели должна быть сведена к действию поля $\bm g(x,t)$, а сама
$\bm g(x,t)$ обязана быть вычислена через спектральные характеристики
Среды.

В ньютоновском диапазоне (малыe скорости, умеренные расстояния)
допускается \emph{эффективное} приближение вида

\begin{equation}
  \Delta \phi(x) \approx 4\pi G_{\text{eff}}\, \sigma(x),
\end{equation}

где $G_{\text{eff}}$ --- эффективная константа, а $\sigma(x)$ ---
некоторая \emph{спектральная} плотность источников, связанная с
локализованными солитонными структурами. Это уравнение не
рассматривается как фундаментальный закон, а лишь как удобное приближение
для определённого класса задач.

Эффекты, которые в стандартной физике описываются как «замедление
времени», «гравитационный сдвиг частот» и «гравитационное линзирование»,
в данной модели должны формулироваться в терминах изменения
$\rho_{\text{spec}}$ и, как следствие, изменения $I_{\text{grav}}$,
$\phi$ и траекторий распространения волн в Среде.


\subsection{Постулат о материи как солитонах}
\label{subsec:postulate-solitons}

\begin{quote}
  Материальные объекты --- это устойчивые локализованные процессы
  (солитоны, вихри, узлы) в Среде.
\end{quote}

Под \emph{солитоном} мы понимаем локализованную во времени и
пространстве конфигурацию полей Среды, которая:

\begin{itemize}
  \item обладает конечной энергией;
  \item сохраняет свою форму (или спектральный профиль) при эволюции
        на естественных масштабах времени;
  \item устойчивa к малым возмущениям.
\end{itemize}

Каждая солитонная конфигурация описывается:

\begin{itemize}
  \item набором непрерывных параметров $\theta$
        (масштаб, ориентации, внутренние доли и т.п.);
  \item \emph{топологией} --- графом или узлом $G_\theta$, который
        отражает структуру связей и замкнутых линий в конфигурации.
\end{itemize}

Тип частицы (например, «протоноподобный» или «электроноподобный» объект)
соответствует классу эквивалентности конфигураций с одинаковыми
спектральными и топологическими инвариантами и минимумом определённого
функционала $F_{\text{sol}}[\theta]$.


\subsection{Постулат о линейном операторе колебаний}
\label{subsec:postulate-H}

\begin{quote}
  Для каждой конфигурации Среды существует линейный оператор малых
  колебаний, спектр которого описывает локальные моды вокруг этой
  конфигурации.
\end{quote}

Формально, для данной конфигурации $\theta$ вводится оператор
$\hat H[\theta]$, действующий на малые возмущения состояния Среды
(например, скалярные или векторные функции на $X$). В простейшем
скалярном приближении его можно представить в виде

\begin{equation}
  \hat H[\theta] = -\nabla \cdot \big( c^2(\theta,x)\, \nabla \big),
\end{equation}

где $c(\theta,x)$ --- эффективная локальная «жёсткость» Среды: скорость
распространения малых возмущений в данной конфигурации.

Точный вид $\hat H[\theta]$ может быть усложнён (несколько компонент,
анизотропия и т.д.), но \emph{существование} такого оператора и его
роль как генератора спектра принимается как постулат.


\subsection{Постулат о DOS/LDOS и функции Грина}
\label{subsec:postulate-DOS}

\begin{quote}
  Спектральные свойства конфигурации задаются её плотностью состояний
  (DOS/LDOS), которая выражается через функцию Грина оператора
  $\hat H[\theta]$.
\end{quote}

Глобальная плотность состояний (DOS) определяется как

\begin{equation}
  \rho(\omega;\theta) = -\frac{1}{\pi}\,
    \Im \operatorname{Tr}\big( \omega + i0^+ - \hat H[\theta] \big)^{-1},
\end{equation}

а локальная плотность состояний (LDOS) в точке $x$:

\begin{equation}
  \rho(\omega,x;\theta) = -\frac{1}{\pi}\,
    \Im\, G(x,x;\omega + i0^+;\theta),
\end{equation}

где $G(z;\theta) = (z - \hat H[\theta])^{-1}$ --- функция Грина, а
$G(x,x';z)$ --- её кернел в координатном представлении.

Устойчивые моды и резонансы проявляются как пики $\rho(\omega;\theta)$
(в том числе сингулярности типа Ван Хова), а структура $\rho(\omega,x;\theta)$
определяет пространственную форму «орбиталей» и локальных полей.


\subsection{Постулат о массе и топологии}
\label{subsec:postulate-mass}

\begin{quote}
  Эффективная масса солитона определяется как функционал от его спектра
  и топологической структуры.
\end{quote}

Для солитонной конфигурации $\theta$ вводится эффективная масса

\begin{equation}
  M_{\text{sol}}[\theta]
  = M_{\text{spec}}\big[\rho(\omega;\theta)\big]
  + M_{\text{top}}[G_\theta],
\end{equation}

где:

\begin{itemize}
  \item $M_{\text{spec}}$ --- спектральный вклад, зависящий от DOS
        через интеграл с весовой функцией $w(\omega)$;
  \item $M_{\text{top}}$ --- топологический вклад, зависящий от
        инвариантов графа/узла $G_\theta$ (число пересечений и др.).
\end{itemize}

Конкретные формы $M_{\text{spec}}$ и $M_{\text{top}}$ уточняются
в последующих частях документа, но принципиально важно, что масса
\emph{вычисляется}, а не постулируется как табличная величина.


\subsection{Постулат о геометрической таблице атомов}
\label{subsec:postulate-geom-table}

\begin{quote}
  Атом описывается как солитонная конфигурация, минимизирующая
  функционал $F_{\text{atom}} = F_{\text{levels}} + F_{\text{geom}}$,
  а его валентность задаётся числом и ориентацией геометрических «портов».
\end{quote}

Для элемента с атомным номером $Z$ предполагается существование
конфигурации $\theta_Z$, которая является (локальным) минимумом
функционала

\begin{equation}
  F_{\text{atom}}[\theta_Z]
  = F_{\text{levels}}[\theta_Z] + F_{\text{geom}}[G_{\theta_Z}],
\end{equation}

где:

\begin{itemize}
  \item $F_{\text{levels}}$ --- функционал, сравнивающий спектральные
        линии оператора $\hat H[\theta_Z]$ с экспериментальными
        уровнями данного элемента;
  \item $F_{\text{geom}}$ --- функционал геометрической/топологической
        структуры ядра (сложность, симметрия, дерево связей).
\end{itemize}

Валентность и химические свойства выражаются через понятие
\emph{портов}: локальных направлений в конфигурации $\theta_Z$ и в
карте $\rho(\omega,x;\theta_Z)$, в которых возможно устойчивое
резонансное связывание с другими солитонами.


\subsection{Постулат о вычислимости}
\label{subsec:postulate-computability}

\begin{quote}
  Любое утверждение, относящееся к «физике» модели, должно быть в
  принципе вычислимо через оператор $\hat H[\theta]$, спектральные
  функции, потенциал $\phi(x)$ и заданные функционалы. Остальное
  относится к гипотезам и дорожной карте.
\end{quote}

Практически это означает:

\begin{itemize}
  \item если величину нельзя выразить через комбинацию
        $\rho_{\text{spec}}$, $\phi$, $\rho(\omega;\theta)$,
        $\rho(\omega,x;\theta)$, $M_{\text{sol}}$, $F_{\text{atom}}$
        и связанных с ними операторов и функционалов, то она не входит
        в ядро модели v0.1;
  \item все ключевые конструкции должны быть реализуемы в виде
        программных модулей (см. Часть VI);
  \item документ остаётся \emph{самодостаточным}: для построения
        прототипа программного комплекса не требуется обращаться
        к другим теориям и внешним постулатам.
\end{itemize}




% ==========================
% ЧАСТЬ II. СРЕДА И СПЕКТРАЛЬНОЕ ОПИСАНИЕ
% ==========================


% ==========================
% ЧАСТЬ II. СРЕДА И СПЕКТРАЛЬНОЕ ОПИСАНИЕ
% ==========================
\section{Фоновое пространство и физическая среда}

В предыдущей главе были сформулированы постулаты модели. Здесь мы
чуть более подробно и технически аккуратно раскрываем три ключевые
составляющие:

\begin{itemize}
  \item геометрию фонового пространства $X$;
  \item качественные свойства физической Среды, заполняющей $X$;
  \item роль параметра времени $t$ как параметра эволюции состояний.
\end{itemize}

Задача этой главы --- не вводить новые постулаты, а подготовить
рабочие определения и обозначения, которые далее будут использованы
в спектральном и вычислительном описании.


\subsection{Евклидово пространство}

Фоновое пространство фиксируется как трёхмерное евклидово
пространство:

\begin{equation}
  X \simeq \mathbb{R}^3,
\end{equation}

с декартовыми координатами $x = (x^1,x^2,x^3)$ и стандартной метрикой

\begin{equation}
  \bar g_{ij} = \delta_{ij} =
  \begin{cases}
    1, & i=j,\\
    0, & i \neq j.
  \end{cases}
\end{equation}

Далее мы будем опускать верхние/нижние индексы, так как в евклидовой
метрике это несущественно.

Расстояние между двумя точками $x,y \in X$ задаётся нормой

\begin{equation}
  |x-y| = \sqrt{(x^1-y^1)^2 + (x^2-y^2)^2 + (x^3-y^3)^2},
\end{equation}

объём элементарного параллелепипеда:

\begin{equation}
  d^3 x = dx^1\,dx^2\,dx^3.
\end{equation}

Дифференциальные операторы мы будем понимать в стандартном смысле:

\begin{align}
  \nabla f(x) &= \left(\frac{\partial f}{\partial x^1},
                     \frac{\partial f}{\partial x^2},
                     \frac{\partial f}{\partial x^3}\right),\\[4pt]
  \operatorname{div}\bm v(x) &= \sum_{i=1}^3 \frac{\partial v^i}{\partial x^i},\\[4pt]
  \Delta f(x) &= \operatorname{div}(\nabla f(x))
              = \sum_{i=1}^3 \frac{\partial^2 f}{\partial (x^i)^2}.
\end{align}

Важно подчеркнуть: в рамках данной модели эти определения \emph{никогда}
не модифицируются. Нет никакой динамической метрики, нет «кривизны»
пространства. Всё «движется и меняется» не геометрия $X$, а состояние
Среды, заполняющей $X$.


\subsection{Физическая Среда}

Под \textbf{Средой} мы понимаем единую физическую субстанцию, которая
заполняет всё пространство $X$ и является носителем всех процессов:

\begin{itemize}
  \item распространения волн;
  \item образования солитонов и узлов;
  \item взаимодействий, которые мы интерпретируем как гравитацию,
        электромагнетизм и т.п.
\end{itemize}

На уровне v0.1 мы задаём Среду не через «микроскопические кирпичики»,
а через её эффективные свойства:

\begin{enumerate}
  \item \textbf{Непрерывность.} В каждой точке $x$ Среда имеет
        определённое локальное состояние; между точками нет пустот,
        где «ничего нет».

  \item \textbf{Колебательность.} Малые возмущения вокруг некоторого
        фонового состояния порождают волны, распространяющиеся с
        конечной скоростью. В простейшем приближении можно думать о
        продольных и поперечных модах, но общее описание оставляем
        спектральным.

  \item \textbf{Нелинейность.} При достаточно больших амплитудах
        и/или на определённых частотах Среда ведёт себя нелинейно, что
        позволяет существовать устойчивым локализованным структурам
        (солитонам, вихрям).

  \item \textbf{Спектральность.} Для каждого участка пространства и
        каждого масштаба времени можно говорить о распределении
        амплитуд по частотам. Именно это распределение и будет
        основным объектом спектрального описания.

  \item \textbf{Предпочтительная система отсчёта.} Покой Среды
        фиксирует выделенную систему отсчёта. Скорости процессов
        (солитонов, волн, объектов) измеряются относительно покоя Среды.
        В рамках этой модели нет принципа относительности, который
        делал бы все инерциальные системы физически равноправными.
\end{enumerate}

Таким образом, все динамические и статические эффекты в модели должны
быть сведены к изменениям состояния этой Среды во времени и пространстве.


\subsection{Время как параметр протекания процессов}

Время $t$ не входит в геометрию пространства, но входит в описание
эволюции состояний Среды.

Мы рассматриваем семейство состояний

\begin{equation}
  \mathcal{S}(t) = \{\rho_{\text{spec}}(\omega,x,t),\ \text{солитоны
  и их параметры},\ \dots\},
\end{equation}

где $t \in \mathbb{R}$ --- эволюционный параметр.

Физический смысл времени задаётся через \emph{сравнение процессов}:

\begin{itemize}
  \item локальный солитон может выполнять квазипериодическое движение
        (колебания), характеризуемое собственной частотой
        $\omega_{\text{clock}}$;
  \item за интервал от $t_1$ до $t_2$ солитон совершит
        $N \approx \omega_{\text{clock}}(t_*) (t_2-t_1) / 2\pi$
        циклов, где $t_*$ --- некоторый промежуточный момент;
  \item сравнивая количество циклов разных процессов, мы получаем
        относительное «замедление» или «ускорение» их хода.
\end{itemize}

Если в разных областях пространства Среда имеет различное спектральное
состояние, то собственные частоты солитонов в этих областях будут
отличаться. Это и даёт эффекты, которые обычно описываются как
«замедление времени в гравитационном поле» или «частотный сдвиг».
В нашей картине время не «гнётся» и не «растягивается» --- изменяются
характерные частоты процессов из-за изменения спектра Среды.


\section{Спектральное состояние Среды}
\label{sec:spectral-state}

В качестве основного описания состояния Среды мы используем её
\textbf{локальную спектральную плотность}. Для каждой точки
$x \in X \simeq \mathbb{R}^3$, момента эволюционного параметра $t$
и частоты $\omega$ задаётся неотрицательная функция
\begin{equation}
  \rho_{\text{spec}}(\omega,x,t) \ge 0,
\end{equation}
которая показывает, насколько сильно в данной области пространства
возбуждены режимы колебаний с частотами в окрестности $\omega$.

Интегральная спектральная ``мощность'' в точке $x$ определяется как
\[
  I_{\text{tot}}(x,t)
  = \int_{\Omega} \rho_{\text{spec}}(\omega,x,t)\,d\omega,
\]
где $\Omega$ --- рабочий диапазон частот Среды. Эта величина сама
по себе ещё не разделяет вклад продольных и поперечных мод и не
подходит для непосредственного описания гравитации.

\subsection{Продольный и поперечный спектральные каналы}

Спектральная плотность удобно разлагается на два канала:
\begin{equation}
  \rho_{\text{spec}}(\omega,x,t)
  = \rho_L(\omega,x,t) + \rho_T(\omega,x,t),
\end{equation}
где
\begin{itemize}
  \item $\rho_L(\omega,x,t)$ --- вклад продольных (давленческих) мод
        Среды;
  \item $\rho_T(\omega,x,t)$ --- вклад поперечных (вихревых,
        электромагнитного типа) мод.
\end{itemize}

Физическая установка модели v0.1:

\begin{itemize}
  \item \textbf{Гравитационные} эффекты связываются прежде всего с
        продольным каналом $\rho_L$;
  \item \textbf{Электромагнитные и радиационные} эффекты описываются
        поперечным каналом $\rho_T$.
\end{itemize}

Поэтому далее мы будем строить гравитационный потенциал не из
полной $\rho_{\text{spec}}$, а именно из $\rho_L$.

\subsection{Гравитационно значимая продольная мощность}

Определим \textbf{гравитационно значимую продольную мощность} Среды
в точке $x$ как спектрально взвешенный интеграл по продольному каналу:
\begin{equation}
  I_{\text{grav}}(x,t)
  = \int_{\Omega} \alpha_L(\omega)\,\rho_L(\omega,x,t)\,d\omega,
  \label{eq:Igrav}
\end{equation}
где
\begin{itemize}
  \item $\alpha_L(\omega)$ --- весовая функция чувствительности
        продольных мод к гравитационным эффектам;
  \item в минимальной версии модели v0.1 можно полагать
        $\alpha_L(\omega)\equiv 1$, то есть все продольные частоты
        вносят одинаковый вклад.
\end{itemize}

Интуитивно $I_{\text{grav}}(x,t)$ играет роль ``жёсткости'' Среды
в продольном канале: чем больше значение $I_{\text{grav}}$, тем
труднее деформировать Среду продольной волной в данной области.

\subsection{Спектральный потенциал}

\textbf{Спектральный потенциал} определяется как логарифмический
функционал от $I_{\text{grav}}$:
\begin{equation}
  \phi(x,t)
  = -\ln I_{\text{grav}}(x,t) + \text{const},
  \label{eq:phi}
\end{equation}
где константа выбирается так, чтобы в выбранном фоновом состоянии
Среды (например, ``далеко от всех солитонов'') потенциал принимал
фиксированное опорное значение $\phi_\infty$.

Такое определение отражает две идеи:

\begin{itemize}
  \item логарифм переводит \emph{мультипликативные} изменения спектра
        (усиление/ослабление мод) в \emph{аддитивные} изменения
        потенциала;
  \item падение $I_{\text{grav}}$ (спектральная ``яма'' в продольном
        канале) приводит к росту $\phi(x)$ и, как будет показано
        в Части~IV, к появлению эффективного поля притяжения.
\end{itemize}

В дальнейшем гравитационное ускорение пробных солитонов будет
определяться через градиент спектрального потенциала $\phi(x)$,
а связь $\phi$ с ньютоновским потенциалом $\Phi_N$ и с частотами
локальных ``часов'' будет подробно разобрана в
разделе~\ref{sec:grav-effect}.
\section{Гравитация как эффект спектра}
\label{sec:grav-effect}

В Части~II был введён спектральный потенциал Среды
$\phi(x,t)$ через продольную спектральную мощность $I_{\text{grav}}(x,t)$
(см.~раздел~\ref{sec:spectral-state}). В данной секции мы опишем,
как именно конфигурация солитонов порождает поле $\phi(x)$, и как
через него появляются стандартные гравитационные эффекты: притяжение,
изменение частот ``часов'' и гравитационный красный сдвиг.

\subsection{Солитоны как источники продольной спектральной ямы}

Пусть в Среде локализовано несколько устойчивых солитонных объектов
(ядра, планеты и т.п.), задаваемых параметрами
$\theta_1,\dots,\theta_N$ и топологиями $G_1,\dots,G_N$.
Каждый такой объект деформирует продольный спектр Среды, создавая
локальную ``яму'' в $\rho_L(\omega,x)$:
\begin{equation}
  \rho_L(\omega,x)
  =
  \rho_L^{\text{vac}}(\omega)
  + \sum_{j=1}^N \delta\rho_L^{(j)}(\omega,x;\theta_j),
  \label{eq:rhoL-sources}
\end{equation}
где
\begin{itemize}
  \item $\rho_L^{\text{vac}}(\omega)$ --- спектральная плотность
        продольных мод в фоновой (квази\-однородной) Среде;
  \item $\delta\rho_L^{(j)}$ --- вклад $j$-го солитона, локализованный
        в окрестности $x_j$ и зависящий от его внутренней структуры.
\end{itemize}

Соответствующая гравитационно значимая мощность
$I_{\text{grav}}(x)$ из~\eqref{eq:Igrav} принимает вид
\begin{equation}
  I_{\text{grav}}(x)
  =
  I_{\text{vac}}
  + \sum_{j=1}^N \delta I_{\text{grav}}^{(j)}(x),
\end{equation}
где
\[
  I_{\text{vac}}
  = \int_{\Omega}\alpha_L(\omega)\,\rho_L^{\text{vac}}(\omega)\,d\omega
\]
и $\delta I_{\text{grav}}^{(j)}(x)$ локализованы около $x_j$.

В отсутствие солитонов $I_{\text{grav}}(x)\equiv I_{\text{vac}}$,
а спектральный потенциал $\phi(x)$ из~\eqref{eq:phi} равен
некоторой константе $\phi_\infty$. Наличие солитонов создаёт
пространственно неоднородное поле $\phi(x)$ и, как следствие,
эффективное притяжение.

\subsection{Эффективное уравнение для спектрального потенциала}

В полном виде уравнение, связывающее $\phi$ и деформации спектра,
должно выводиться из вариационного принципа для Среды. В версии v0.1
мы используем \emph{эффективный анзац}, вдохновлённый спектральными
уравнениями Монахова:
\begin{equation}
  \Delta \phi(x)
  \;\approx\;
  \kappa\,\Bigl[
      Q_{\text{matter}}(x) - \langle Q_{\text{vac}}\rangle
  \Bigr],
  \label{eq:phi-Poisson}
\end{equation}
где
\begin{itemize}
  \item $\Delta$ --- лапласиан по координатам $x$ в евклидовом
        пространстве $X$;
  \item $Q_{\text{matter}}(x)$ --- эффективная плотность
        ``спектрального источника'', описывающая совокупное влияние
        всех солитонов;
  \item $\langle Q_{\text{vac}}\rangle$ --- фоновый вклад вакуумного
        спектра;
  \item $\kappa$ --- коэффициент, определяемый калибровкой по
        макроскопическим данным.
\end{itemize}

В слабопольном режиме и для медленно движущихся массивных
солитонов (планет, звёзд) удобно параметризовать
$Q_{\text{matter}}(x)$ через эффективную массовую плотность
$\rho_{\text{mass}}(x)$:
\[
  Q_{\text{matter}}(x) - \langle Q_{\text{vac}}\rangle
  \;\approx\; 4\pi G_{\text{eff}}\,\rho_{\text{mass}}(x),
\]
и уравнение~\eqref{eq:phi-Poisson} переходит в ньютоновский вид:
\begin{equation}
  \Delta \phi(x) \approx 4\pi G_{\text{eff}}\,\rho_{\text{mass}}(x).
  \label{eq:phi-Poisson-Newton}
\end{equation}
Это соотношение следует понимать как \emph{эффективное приближение}
для больших масштабов и слабых полей. Параметр $G_{\text{eff}}$
калибруется так, чтобы воспроизводился стандартный ньютоновский
закон в солнечной системе.

\subsection{Связь спектрального потенциала с ньютоновским}
\label{subsec:phi-PhiN}

Для связи с привычной формой гравитационного потенциала введём
ньютоновский потенциал $\Phi_N(x)$ как линейную масштабировку
$\phi(x)$ относительно фонового значения $\phi_\infty$:
\begin{equation}
  \Phi_N(x) := c^2\bigl(\phi(x) - \phi_\infty\bigr),
  \label{eq:PhiN-from-phi}
\end{equation}
где $c$ --- скорость поперечных волн (света) в Среде.

Тогда в слабопольном режиме
\[
  |\phi(x) - \phi_\infty| \ll 1
\]
разность потенциалов между двумя точками $x_1$ и $x_2$ записывается как
\begin{equation}
  \frac{\Delta\Phi_N}{c^2}
  =
  \Phi_N(x_2) - \Phi_N(x_1)
  = \phi(x_2) - \phi(x_1)
  = \Delta\phi.
  \label{eq:PhiN-phi-diff}
\end{equation}
Подстановка~\eqref{eq:PhiN-from-phi} в~\eqref{eq:phi-Poisson-Newton}
даёт стандартное ньютоновское уравнение
\[
  \Delta \Phi_N(x) \approx 4\pi G_{\text{eff}}\,\rho_{\text{mass}}(x),
\]
так что классический потенциал $\Phi_N$ появляется как \emph{удобная
репараметризация} спектрального потенциала $\phi$.

\subsection{Частоты локальных процессов и гравитационный сдвиг}
\label{subsec:freq-shift}

Любой устойчивый локальный солитон (атом, ядро, макро\-осциллятор),
используемый как ``часы'', характеризуется набором собственных
частот $\{f_k\}$, которые зависят от спектрального потенциала Среды
в точке размещения солитона. В линейной аппроксимации можно записать:
\begin{equation}
  \frac{\Delta f_k}{f_k}
  \;\approx\;
  \alpha_k\,\Delta\phi,
  \label{eq:freq-shift-alpha}
\end{equation}
где $\Delta\phi$ --- разность потенциалов между двумя положениями
солитона, а коэффициент $\alpha_k$ зависит от типа перехода.

Экспериментальная калибровка (по солнечному красному сдвигу,
эксперименту Паунда--Ребки и точным атомным часам) показывает, что
для широкого класса переходов в слабопольном режиме можно положить
\[
  \alpha_k \approx 1,
\]
и формула~\eqref{eq:freq-shift-alpha} принимает универсальный вид:
\begin{equation}
  \frac{\Delta f}{f}
  \;\approx\;
  \Delta\phi
  \;=\;
  \frac{\Delta\Phi_N}{c^2}.
  \label{eq:freq-shift-final}
\end{equation}

Таким образом, \emph{гравитационный красный сдвиг и изменение хода
часов} в данной модели трактуются как прямое следствие изменения
спектрального потенциала Среды. Никакого геометрического ``замедления
времени'' в четырёхмерном пространстве-времени не требуется:``время''
здесь --- это просто частота внутренних солитонных процессов, а
она зависит от $\phi(x)$.

В следующем разделе будут рассмотрены конкретные экспериментальные
сценарии (солнечный красный сдвиг, эксперимент Паунда--Ребки,
GPS и Hafele--Keating), в которых формула \eqref{eq:freq-shift-final}
используется для численной оценки наблюдаемых эффектов.


\section{Экспериментальные проверки спектральной гравитации}
\label{sec:exp-tests}

В этом разделе показывается, что простая связь
\begin{equation}
  \frac{\Delta f}{f}
  \;\approx\;
  \Delta\phi
  \;=\;
  \frac{\Delta\Phi_N}{c^2}
  \label{eq:exp-main}
\end{equation}
между спектральным потенциалом $\phi(x)$, ньютоновским потенциалом
$\Phi_N(x)$ и относительным сдвигом частоты локальных ``часов''
достаточна для описания классических гравитационных эффектов,
обычно приводимых как подтверждение релятивистских теорий.

Здесь $\Delta\Phi_N = \Phi_N(x_2) - \Phi_N(x_1)$ --- разность
ньютоновского потенциала между двумя уровнями Среды, а $c$ --- скорость
поперечных волн (света). Никакого четырёхмерного пространства-времени
в этой формуле не требуется: она связывает \emph{частоты солитонных
процессов} непосредственно с \emph{спектральным состоянием Среды}.

Дополнительно, для движущихся систем в слабопольном режиме используется
универсальная спектрально-кинетическая поправка
\begin{equation}
  \left(\frac{\Delta f}{f}\right)_{\text{kin}}
  \approx
  -\frac{v^2}{2c^2},
  \label{eq:exp-kin}
\end{equation}
которая выражает тот факт, что часть энергии солитона переносится
в макроскопическое движение со скоростью $v$, и остаётся меньше
доступной для внутренних колебаний (см. обсуждение в Части~I).

В совокупности \eqref{eq:exp-main} и \eqref{eq:exp-kin} дают все
необходимые поправки для классических экспериментов.

\subsection{Солнечный гравитационный красный сдвиг}

Рассмотрим фотон (или любой солитонный ``часовой'' процесс),
перемещающийся из фотосферы Солнца в далёкую область, где
гравитационный потенциал можно считать нулевым. В ньютоновском
приближении гравитационный потенциал на поверхности Солнца
\[
  \Phi_N(R_\odot) \approx -\frac{G M_\odot}{R_\odot},
\]
где $M_\odot$ и $R_\odot$ --- масса и радиус Солнца.

Подставляя в \eqref{eq:exp-main} с $x_1$ на поверхности, $x_2$ в
удалённой области, получаем относительный сдвиг частоты:
\begin{equation}
  \left(\frac{\Delta f}{f}\right)_{\odot}
  \approx
  \frac{\Delta\Phi_N}{c^2}
  =
  \frac{0 - \Phi_N(R_\odot)}{c^2}
  =
  \frac{G M_\odot}{R_\odot c^2}.
  \label{eq:exp-sun}
\end{equation}

Численно это даёт величину порядка
\[
  \frac{G M_\odot}{R_\odot c^2} \sim 2 \cdot 10^{-6},
\]
то есть линия спектра, измеренная вдали от Солнца,
должна быть смещена к красному на $\sim 2$ части на миллион
от своей локальной частоты в фотосфере. Это совпадает с величиной
эффекта, наблюдаемого в солнечных спектральных линиях.

В нашей интерпретации это не ``растяжение времени'' вблизи Солнца,
а изменение спектрального потенциала Среды: продольная спектральная
яма вблизи массивного солитона (Солнца) смещает все локальные
частоты вниз.

\subsection{Эксперимент Паунда--Ребки}

Эксперимент Паунда--Ребки измеряет гравитационный красный сдвиг
гамма-квантов на высоте порядка $H \approx 22{,}5$~м в гравитационном
поле Земли. В нашем описании задача сводится к сравнению
ньютоновского потенциала на высотах $z$ и $z+H$ над поверхностью.

Для малых высот $H \ll R_\oplus$ (радиус Земли) можно использовать
линейную аппроксимацию:
\[
  \Phi_N(z+H) - \Phi_N(z)
  \approx g\,H,
\]
где $g$ --- ускорение свободного падения.

Тогда из \eqref{eq:exp-main}
\begin{equation}
  \left(\frac{\Delta f}{f}\right)_{\text{PR}}
  \approx
  \frac{g H}{c^2}.
  \label{eq:exp-PR}
\end{equation}
Подставляя $g \approx 9{,}8$~м/с$^2$, $H \approx 22{,}5$~м
и $c \approx 3\cdot 10^8$~м/с, получаем
\[
  \frac{\Delta f}{f}
  \sim
  \frac{9{,}8 \cdot 22{,}5}{(3\cdot 10^8)^2}
  \sim
  2{,}5 \cdot 10^{-15},
\]
что совпадает по порядку величины с реально измеренным эффектом.

С точки зрения спектральной модели, это означает, что продольный
спектральный потенциал Среды на высоте $H$ чуть слабее, чем у пола
лаборатории, и локальные частоты ``часов'' (ядра железа в источнике
гамма-квантов) немного отличаются. Лазер/резонанс здесь выступает
как чувствительный индикатор разности $\phi$ на двух высотах.

\subsection{Часы на орбитах: GPS и Hafele--Keating}

Для часов на спутниках (GPS) и в экспериментах Hafele--Keating
существенными становятся как \emph{гравитационные}, так и
\emph{кинетические} поправки.

Рассмотрим пример атомных часов на спутнике высотой $H$ над Землёй
с орбитальной скоростью $v_{\text{orb}}$. Относительно часов на
поверхности Земли (скорость $v_{\text{surf}}$ в простейшем приближении
можно принять как линейную скорость вращения Земли) суммарный
сдвиг частоты в модели v0.1 записывается как
\begin{equation}
  \left(\frac{\Delta f}{f}\right)_{\text{tot}}
  \approx
  \underbrace{\frac{\Delta\Phi_N}{c^2}}_{\text{гравитационный вклад}}
  +
  \underbrace{
    \left[
      -\frac{v_{\text{orb}}^2}{2c^2}
      + \frac{v_{\text{surf}}^2}{2c^2}
    \right]
  }_{\text{кинетический вклад}},
  \label{eq:exp-GPS}
\end{equation}
где
\[
  \Delta\Phi_N
  = \Phi_N(\text{орбита}) - \Phi_N(\text{поверхность})
  \approx
  G M_\oplus \left(
    \frac{1}{R_\oplus + H} - \frac{1}{R_\oplus}
  \right).
\]

Первый член соответствует тому, что на орбите потенциал менее
отрицательный (слабее спектральная ``яма''), и часы должны идти
быстрее (положительный вклад). Второй член отражает перераспределение
энергии солитона: часть энергии, приходящаяся на массовый центр
часов, уходит в макроскопическое движение со скоростью $v$,
и для внутренних колебаний остаётся чуть меньше --- это даёт
отрицательный вклад, пропорциональный $v^2$.

Аналогичные выражения применимы к часам в опытах Hafele--Keating,
где часы летели на самолётах на высоте нескольких километров
и с дозвуковой скоростью. Знак и величина эффекта определяются
балансом между повышением по потенциалу (гравитационный вклад)
и кинетическим замедлением.

Важно, что ни в формуле \eqref{eq:exp-GPS}, ни в интерпретации
эффектов не требуется вводить 4-мерные геометрические конструкции.
Все поправки выводятся из:
\begin{itemize}
  \item спектрального потенциала $\phi(x)$ (через $\Delta\Phi_N/c^2$);
  \item кинетической поправки $-v^2/(2c^2)$, трактуемой как изменение
        доступной энергии для внутренних мод солитона.
\end{itemize}

\subsection{Вывод: слабопольные тесты без релятивистской геометрии}

Перечисленные эффекты --- солнечный гравитационный сдвиг,
эксперимент Паунда--Ребки, коррекции для GPS и Hafele--Keating ---
традиционно интерпретируются как подтверждение релятивистских
теорий (ОТО/СТО). В рамках данной модели они полностью укладываются
в следующую минимальную схему:

\begin{itemize}
  \item продольный спектральный канал Среды задаёт скалярный
        спектральный потенциал $\phi(x)$;
  \item локальные частоты всех устойчивых солитонных процессов
        масштабируются с $\phi(x)$ по закону
        $\Delta f / f \approx \Delta\phi$;
  \item ньютоновский потенциал $\Phi_N$ появляется как удобная
        размерная репараметризация $\phi$ через
        $\Phi_N = c^2(\phi - \phi_\infty)$;
  \item кинетические эффекты движения с малой скоростью $v \ll c$
        дают поправку порядка $-v^2/(2c^2)$.
\end{itemize}

Таким образом, все классические слабопольные тесты гравитации можно
рассматривать как проверки \emph{спектральной чувствительности}
локальных часов к состоянию Среды, а не как подтверждение геометризации
пространства-времени.

\section{Плотность состояний и функция Грина}
\label{sec:DOS-Green}

В предыдущих разделах мы описали Среду через локальную спектральную
плотность $\rho_{\text{spec}}(\omega,x,t)$ и спектральный потенциал
$\phi(x,t)$. Теперь введём формализм, который позволяет вычислять
спектральные характеристики для конкретной конфигурации солитонов
и сразу переводится в численный код: оператор малых колебаний,
функцию Грина и плотность состояний (DOS/LDOS).

\subsection{Оператор малых колебаний}

Для фиксированной конфигурации $\theta$ (набор солитонов и их
положений) мы рассматриваем малые отклонения Среды от
стационарного состояния. В линейном приближении такие отклонения
описываются оператором
\begin{equation}
  \hat H[\theta]\,\psi
  =
  -\nabla \cdot
   \bigl( c^2(\theta,x)\,\nabla \psi(x) \bigr)
  + V_{\text{eff}}(\theta,x)\,\psi(x),
  \label{eq:H-theta}
\end{equation}
где
\begin{itemize}
  \item $c(\theta,x)$ --- эффективная ``жёсткость'' или скорость
        распространения волн в Среде (может отличаться вблизи
        солитонов и вдали от них);
  \item $V_{\text{eff}}(\theta,x)$ --- эффективный потенциал,
        описывающий локальные особенности структуры Среды.
\end{itemize}

В численной реализации $\hat H[\theta]$ задаётся как матрица,
полученная дискретизацией выражения~\eqref{eq:H-theta} на сетке
или в подходящем базисе.

Собственные функции и собственные значения оператора удовлетворяют
\begin{equation}
  \hat H[\theta]\,\psi_n(x) = \omega_n^2\,\psi_n(x),
  \label{eq:eig-problem}
\end{equation}
где $\omega_n$ --- собственные частоты колебаний Среды вокруг
заданной конфигурации $\theta$.

\subsection{Функция Грина}

Функция Грина $\hat G(z)$ для оператора $\hat H[\theta]$ определяется
как операторное решение
\begin{equation}
  \hat G(z)
  =
  \bigl(z - \hat H[\theta]\bigr)^{-1},
  \qquad
  z \in \mathbb{C}.
  \label{eq:G-def}
\end{equation}
В координатном представлении это даёт ядро $G(x,x';z)$, удовлетворяющее
\begin{equation}
  \bigl(z - \hat H[\theta]\bigr)\,G(x,x';z)
  = \delta(x-x').
  \label{eq:G-kernel}
\end{equation}

Спектральное разложение по собственным функциям~\eqref{eq:eig-problem}
имеет вид
\begin{equation}
  G(x,x';z)
  =
  \sum_n \frac{\psi_n(x)\,\psi_n^*(x')}{z - \omega_n^2},
  \label{eq:G-spectral}
\end{equation}
что явно связывает функцию Грина со спектром $\{\omega_n\}$.

В дискретном численном базисе (конечная сетка или конечные элементы)
$\hat H[\theta]$ заменяется матрицей $H$, а $\hat G(z)$ --- матрицей
\[
  G(z) = (z\mathbb{I} - H)^{-1}.
\]

\subsection{Глобальная плотность состояний (DOS)}

Глобальная плотность состояний $\rho(\omega;\theta)$ показывает,
сколько мод колебаний приходится на единичный интервал частот
в окрестности $\omega$ для данной конфигурации $\theta$.

Стандартное выражение через функцию Грина:
\begin{equation}
  \rho(\omega;\theta)
  =
  -\frac{1}{\pi}\,
  \Im\,\mathrm{Tr}\, G(\omega^2 + i0^+),
  \label{eq:DOS-def}
\end{equation}
где $G(\omega^2 + i0^+)$ --- оператор Грина, взятый на физическом
листе спектра, а $\mathrm{Tr}$ --- след по пространственным координатам
(или по дискретному базису).

Если спектр дискретен, это сводится к сумме по собственным значениям:
\begin{equation}
  \rho(\omega;\theta)
  =
  \sum_n \delta(\omega - \omega_n).
  \label{eq:DOS-discrete}
\end{equation}
В численных расчётах дельта-функции заменяются сглаженными
пиками (например, гауссианами или лоренцианами) с малой шириной.

Особое значение имеют \emph{сингулярности Ван Хова} --- точки
спектра, где $\rho(\omega)$ резко возрастает или формально
становится бесконечной. Вблизи таких частот групповая скорость
волновых пакетов стремится к нулю, и энергия Среды локализуется.
В модели спектральной физики именно такие частоты рассматриваются
как естественные кандидаты для устойчивых ``частицоподобных'' мод.

\subsection{Локальная плотность состояний (LDOS)}

Локальная плотность состояний $\rho(\omega,x;\theta)$ даёт вклад
в DOS в окрестности точки $x$:
\begin{equation}
  \rho(\omega,x;\theta)
  =
  -\frac{1}{\pi}\,
  \Im\, G(x,x;\omega^2 + i0^+).
  \label{eq:LDOS-def}
\end{equation}

Используя спектральное разложение~\eqref{eq:G-spectral}, можно
записать
\begin{equation}
  \rho(\omega,x;\theta)
  =
  \sum_n |\psi_n(x)|^2\,\delta(\omega - \omega_n),
  \label{eq:LDOS-spectral}
\end{equation}
то есть LDOS показывает, как собственные моды распределены
по пространству.

В интерпретации данной модели:

\begin{itemize}
  \item $\rho(\omega;\theta)$ описывает \emph{общую спектральную
        структуру} конфигурации Среды (какие частоты вообще доступны);
  \item $\rho(\omega,x;\theta)$ показывает \emph{геометрию и форму}
        конфигурации: изоповерхности постоянной LDOS при фиксированной
        $\omega$ визуализируют ``орбитали'' и узлы солитонной структуры.
\end{itemize}

Именно LDOS лежит в основе того, что в Главе~V мы называем
\emph{геометрическим атомом}: набор устойчивых пучностей LDOS
вокруг ядра задаёт ``форму атома'' и число возможных направлений
связей (валентность).

\subsection{Численное вычисление DOS/LDOS}

В численной реализации в рамках программного комплекса предполагается
следующее:

\begin{itemize}
  \item выбрать дискретизацию пространства (сетку) и задать матрицу
        оператора $H$ по формуле типа~\eqref{eq:H-theta};
  \item для набора частот $\omega$ вычислять матричную функцию
        Грина
        \[
          G(\omega^2 + i\eta)
          = \bigl(\omega^2 + i\eta - H\bigr)^{-1},
        \]
        где $\eta$ --- малая положительная ширина сглаживания;
  \item строить глобальную DOS по~\eqref{eq:DOS-def} и LDOS по
        диагональным элементам $G_{ii}$ согласно~\eqref{eq:LDOS-def};
  \item использовать полученные $\rho(\omega;\theta)$ и
        $\rho(\omega,x;\theta)$ в качестве входа для определения
        функционалов $F_{\text{levels}}$, $F_{\text{geom}}$ и
        эффективной массы (см. Части~IV и~V).
\end{itemize}

Таким образом, формализм функции Грина и плотности состояний
обеспечивает прямой мост от конфигурации Среды $\theta$ к наблюдаемым
спектральным характеристикам и служит математическим ``двигателем''
всей модели.


В предыдущем разделе речь шла о спектре Среды как целого. Теперь
переходим к описанию спектра \emph{локализованных конфигураций} ---
солитонов и атомов. Для этого используется стандартный аппарат
плотности состояний (DOS) и локальной плотности состояний (LDOS),
выражаемых через функцию Грина оператора малых колебаний.


\subsection{Глобальная и локальная DOS}

Пусть задана солитонная конфигурация $\theta$ (например, кандидат
на роль протона, ядра или атома). Ей сопоставлен линейный оператор
малых колебаний $\hat H[\theta]$, действующий на подходящем
функциональном пространстве (например, на пространстве скалярных
функций на $X$ или на конечномерной аппроксимации сетки).

\emph{Глобальная плотность состояний} (DOS) определяется как

\begin{equation}
  \rho(\omega;\theta)
  = -\frac{1}{\pi}\,
      \Im \operatorname{Tr}\big( \omega + i0^+ - \hat H[\theta] \big)^{-1},
  \label{eq:DOS-global}
\end{equation}

где $\Im$ обозначает мнимую часть, а $\operatorname{Tr}$ --- след
оператора.

Интуитивно $\rho(\omega;\theta)\,d\omega$ показывает, сколько мод
колебаний системы с конфигурацией $\theta$ приходится на малый
интервал частот $[\omega,\omega+d\omega]$.

\emph{Локальная плотность состояний} (LDOS) в точке $x$:

\begin{equation}
  \rho(\omega,x;\theta)
  = -\frac{1}{\pi}\,
      \Im\, G(x,x;\omega + i0^+;\theta),
  \label{eq:LDOS-local}
\end{equation}

где $G(x,x';z)$ --- кернел функции Грина оператора $\hat H[\theta]$
(см. ниже).

LDOS позволяет визуализировать форму мод: уровни и «орбитали»
в атомоподобных конфигурациях --- это, по сути, изоповерхности
$\rho(\omega,x;\theta)$ при фиксированных $\omega$.


\subsection{Представление через функцию Грина}

Функция Грина для оператора $\hat H[\theta]$ определяется как
операторное выражение

\begin{equation}
  G(z;\theta) = (z - \hat H[\theta])^{-1},
\end{equation}

где $z \in \mathbb{C}$ --- комплексный спектральный параметр.

В координатном представлении:

\begin{equation}
  \big(z - \hat H[\theta]\big)\, G(x,x';z;\theta)
  = \delta(x-x'),
\end{equation}

где $\delta(x-x')$ --- трёхмерная дельта-функция.

Тогда глобальная DOS~\eqref{eq:DOS-global} и локальная LDOS~\eqref{eq:LDOS-local}
записываются как:

\begin{align}
  \rho(\omega;\theta)
    &= -\frac{1}{\pi}\,
       \Im \int_X G(x,x;\omega + i0^+;\theta)\, d^3x,
       \\[4pt]
  \rho(\omega,x;\theta)
    &= -\frac{1}{\pi}\,
       \Im\, G(x,x;\omega + i0^+;\theta).
\end{align}

На практике в численном коде $\hat H[\theta]$ дискретизуется, и
оператор $(\omega + i\eta - \hat H[\theta])^{-1}$ реализуется в виде
обращения матрицы (или использования итеративных методов), а след
считается по конечномерному пространству.


\subsection{Сингулярности Ван Хова и устойчивые моды}

В твердотельной физике хорошо известно, что при определённых условиях
на графиках DOS появляются характерные пики и сингулярности (сингулярности
Ван Хова). Они связаны с тем, что групповая скорость волн вблизи
определённых частот обращается в нуль, и моды «застаиваются» в спектре.

В нашей модели важны следующие моменты:

\begin{itemize}
  \item Пики $\rho(\omega;\theta)$ указывают на частоты, где система
        имеет аномально много мод (плотная упаковка уровней).
  \item Если нелинейность Среды такова, что на этих частотах возможно
        образование устойчивых локализованных структур, то комбинация
        «пик DOS + нелинейный захват» даёт кандидата на устойчивый
        солитон (частицу).
  \item В этом смысле \emph{масса} и \emph{устойчивость} солитона
        зависят не только от общей энергии, но и от структуры DOS
        вокруг определённых частот.
\end{itemize}

Именно поэтому глобальная DOS и LDOS входят в функционалы типа
$M_{\text{spec}}[\rho(\omega;\theta)]$ и $F_{\text{levels}}[\theta]$,
которые далее используются при построении Геометрической Таблицы.


\subsection{Роль эффективной размерности}

Плотность состояний чувствительна к эффективной размерности системы:

\begin{itemize}
  \item в 3D DOS обычно растёт как $\sqrt{\omega}$ (для простых моделей);
  \item в 2D она может быть примерно постоянной по частоте;
  \item в 1D появляются выраженные сингулярности;
  \item в 0D (квантовая точка) спектр становится дискретным (дельта-пики).
\end{itemize}

Для нашей картины это важно по нескольким причинам:

\begin{itemize}
  \item атом как целое по отношению к внешнему полю можно рассматривать
        как 0D-объект --- его спектр выглядит линейчатым (дискретные
        уровни);
  \item внутренние «нити» и «кольца» внутри солитонных конфигураций
        (ядер, протонов) ближе к 1D-структурам, что делает их DOS
        богатыми на сингулярности;
  \item поверхностные слои и границы кристаллических структур ближе
        к 2D и дают свои особенности спектра.
\end{itemize}

При построении Геометрической Таблицы и моделировании материалов
важно учитывать, какая часть конфигурации ведёт себя эффективно как
0D, 1D, 2D или 3D объект --- это напрямую влияет на форму DOS и,
следовательно, на функционалы энергии, массы и устойчивости.

В дальнейшем, при задании конкретных операторов $\hat H[\theta]$
и геометрии конфигураций, эта связь между топологией, эффективной
размерностью и спектральными свойствами будет использоваться для
оценки стабильности и классификации атомоподобных структур.

% ==========================
% ЧАСТЬ III. СОЛИТОНЫ И ТОПОГРАФИЯ
% ==========================

% ==========================
% ЧАСТЬ III. СОЛИТОНЫ И ТОПОГРАФИЯ
% ==========================
\section{Солитоны среды как материальные объекты}
\label{sec:solitons}

В этой части мы уточняем, что именно в модели называется \emph{солитоном},
как вводятся энергетические и массовые характеристики таких объектов
и каким образом они взаимодействуют со Средой через спектральное
описание.


\subsection{Определение солитона}
\label{subsec:soliton-def}

Интуитивно солитон --- это «узел» или «структура» в Среде, которая:

\begin{itemize}
  \item локализована в пространстве (имеет конечный характерный размер);
  \item существует сколь угодно долго по параметру $t$ без распада
        (на естественных масштабах времени задачи);
  \item восстанавливает форму после малых возмущений.
\end{itemize}

Формально в рамках v0.1 мы будем использовать следующее рабочее
определение.

\begin{quote}
  \textbf{Определение.} Солитонная конфигурация $\theta$ --- это класс
  состояний Среды $\mathcal{S}(t)$, для которого:
  \begin{enumerate}
    \item существует область пространства $U \subset X$ с характерным
          размером $R_\theta$, вне которой спектральное состояние почти
          совпадает с фоновым:
          \[
            \rho_{\text{spec}}(\omega,x,t) \approx \rho_{\text{spec}}^{(0)}(\omega,x),
            \quad x \notin U;
          \]
    \item внутри $U$ спектральное состояние стационарно (или квазистационарно)
          при эволюции по $t$;
    \item малые возмущения состояния в $U$ не приводят к разрушению
          конфигурации, а либо затухают, либо переводят солитон в
          близкое состояние того же класса.
  \end{enumerate}
\end{quote}

Конфигурация описывается набором параметров $\theta$ (масштабы,
ориентации, внутренние деформации) и топологией $G_\theta$, которая
будет введена в разделе~\ref{sec:topology}.


\subsection{Энергия и эффективная масса}
\label{subsec:soliton-energy-mass}

Солитон --- это не «шарик», а особое спектральное состояние Среды.
Поэтому естественно определять его энергию и массу через спектральные
характеристики.

Пусть $\rho(\omega;\theta)$ --- глобальная плотность состояний (DOS)
для оператора малых колебаний $\hat H[\theta]$ вокруг конфигурации
(см. раздел~\ref{subsec:postulate-DOS}). Введём \emph{спектральный
энергетический функционал}:

\begin{equation}
  E_{\text{spec}}[\theta]
  = \int_{\Omega_E} w_E(\omega)\, \rho(\omega;\theta)\, d\omega,
  \label{eq:E-spec}
\end{equation}

где:

\begin{itemize}
  \item $\Omega_E$ --- рабочий диапазон частот для энергетического
        расчёта;
  \item $w_E(\omega)$ --- весовая функция (например, пропорциональная
        $\omega$, $\omega^2$ или более сложная), выбираемая так, чтобы
        воспроизводить известные энергетические шкалы.
\end{itemize}

\emph{Топологический вклад} в энергию/массу задаётся функционалом
$E_{\text{top}}[G_\theta]$, зависящим от топологической структуры
графа/узла (см. раздел~\ref{subsec:topology-invariants}). В простейшем
варианте можно рассматривать линейную комбинацию топологических
инвариантов:

\begin{equation}
  E_{\text{top}}[G_\theta]
  = \alpha_{\text{cross}}\, C_{\text{cross}}[G_\theta]
    + \alpha_{\text{link}}\, C_{\text{link}}[G_\theta]
    + \dots,
  \label{eq:E-top}
\end{equation}

где $C_{\text{cross}}$ --- число пересечений (или его обобщение),
$C_{\text{link}}$ --- характеристика сцеплений и т.п.

Полная энергия солитонной конфигурации:

\begin{equation}
  E_{\text{sol}}[\theta]
  = E_{\text{spec}}[\theta] + E_{\text{top}}[G_\theta] + E_{\text{bg}},
  \label{eq:E-sol}
\end{equation}

где $E_{\text{bg}}$ --- выбранный уровень фоновой энергии Среды,
который можно считать нулём отсчёта (или калибровать по эталонному
солитону).

\textbf{Эффективная масса} определяется как масштабная характеристика,
пропорциональная энергии:

\begin{equation}
  M_{\text{sol}}[\theta]
  = \kappa_E\, E_{\text{sol}}[\theta],
  \label{eq:M-sol}
\end{equation}

где $\kappa_E$ --- калибровочный коэффициент, фиксируемый по одному
или нескольким эталонным объектам (например, по протону). В разделе
\ref{subsec:postulate-mass} эта схема была сформулирована в более
общей форме; здесь мы даём конкретный энергетический анзац для v0.1.


\subsection{Взаимодействие солитонов со Средой}
\label{subsec:soliton-medium-interaction}

Солитон не «плавает в пустоте» --- он изменяет местное состояние
Среды, а именно её спектральную плотность. Пусть фон задаётся
$\rho_{\text{spec}}^{(0)}(\omega,x)$, а присутствие солитона описывается
добавкой $\delta\rho_{\text{spec}}(\omega,x;\theta)$:

\begin{equation}
  \rho_{\text{spec}}(\omega,x;\theta)
  = \rho_{\text{spec}}^{(0)}(\omega,x) + \delta\rho_{\text{spec}}(\omega,x;\theta).
\end{equation}

Соответствующее изменение гравитационно значимой мощности:

\begin{equation}
  I_{\text{grav}}(x;\theta)
  = I_{\text{grav}}^{(0)}(x)
    + \delta I_{\text{grav}}(x;\theta),
\end{equation}

где $I_{\text{grav}}$ определяется формулой~\eqref{eq:Igrav}. Это
вносит вклад в спектральный потенциал:

\begin{equation}
  \phi(x;\theta)
  = \phi^{(0)}(x) + \delta\phi(x;\theta),
\end{equation}

и, соответственно, в поле ускорений $\bm g(x;\theta)$.

Интерпретация:

\begin{itemize}
  \item солитон создаёт \emph{спектральную тень} --- область, где
        $I_{\text{grav}}$ отклоняется от фонового значения;
  \item другие солитоны чувствуют градиент $\phi$ и испытывают
        «приталкивающее» действие поля $\bm g = -\nabla\phi$;
  \item таким образом реализуется эффективное притяжение или отталкивание
        без введения отдельного «гравитационного поля» как сущности.
\end{itemize}

С точки зрения вычислений, взаимодействие солитонов сводится к:

\begin{enumerate}
  \item заданию фона $\rho_{\text{spec}}^{(0)}(\omega,x)$;
  \item суммированию вкладов $\delta\rho_{\text{spec}}$ от всех
        присутствующих конфигураций $\theta_i$;
  \item вычислению $\phi(x)$ и $\bm g(x)$ по формулам
        \eqref{eq:phi}, \eqref{eq:g};
  \item интегрированию траекторий пробных тел в поле $\bm g(x)$.
\end{enumerate}

При необходимости более детального описания можно также учитывать
обратное влияние спектрального поля на параметры самих солитонов
(перестройка внутреннего спектра в сильных полях), но в v0.1 это
можно считать задачей жёлтой/красной зоны.


\section{Топологическое описание (узлы и графы)}
\label{sec:topology}

Для того чтобы различать и классифицировать солитонные конфигурации,
недостаточно только спектральных характеристик. Важную роль играет
их \emph{топологическая структура}: как «переплетены» линии тока,
вихревые кольца, «нитки» Среды. В этом разделе мы вводим графовое
и узловое описание конфигураций.


\subsection{Графовое представление конфигураций}
\label{subsec:graph-representation}

Солитонную конфигурацию $\theta$ будем сопоставлять конечному графу
$G_\theta$, вложенному в пространство $X$:

\begin{equation}
  G_\theta = (V_\theta, E_\theta, \iota_\theta),
\end{equation}

где:

\begin{itemize}
  \item $V_\theta$ --- множество вершин (узлов) конфигурации;
  \item $E_\theta$ --- множество рёбер (связей) между вершинами;
  \item $\iota_\theta : G_\theta \to X$ --- вложение графа в пространство
        (каждой вершине и ребру сопоставляется положение в $\mathbb{R}^3$).
\end{itemize}

Интерпретация:

\begin{itemize}
  \item вершины могут соответствовать «узлам концентрации» энергии,
        точкам пересечения или разветвления вихревых линий;
  \item рёбра --- участкам «нитей» или «трубок» Среды, по которым
        протекает поток импульса/фазы;
  \item замкнутые циклы в графе в трёхмерном пространстве могут
        представлять вихревые кольца или замкнутые линии тока.
\end{itemize}

Физически разные конфигурации могут иметь одинаковый спектр
$\rho(\omega;\theta)$, но разные графы $G_\theta$ и, как следствие,
разные топологические инварианты. Поэтому $G_\theta$ является
необходимой частью описания «типа» солитона.


\subsection{Узлы, ссылки, деревья}
\label{subsec:knots-links-trees}

Особый интерес представляют следующие типы топологических структур:

\begin{itemize}
  \item \textbf{узлы} --- замкнутые кривые в $X$, которые можно
        рассматривать как образы вложений окружности $S^1 \hookrightarrow X$;
  \item \textbf{ссылки} --- конечные объединения замкнутых кривых
        (несколько узлов, которые могут быть взаимно сцеплены);
  \item \textbf{деревья} --- ациклические графы (без замкнутых циклов),
        описывающие ветвящуюся структуру (например, рост кристалла
        или молекулярного скелета).
\end{itemize}

В различных физически значимых конфигурациях могут сочетаться узлы
и деревья: замкнутые вихревые кольца (узлы) соединены «ветками»
(деревьям подобными структурами), формируя сложные каркасы.

Для целей Геометрической Таблицы атомов особенно важны:

\begin{itemize}
  \item простые узлы (трилистник, тороидальные узлы малой сложности) ---
        кандидаты на роль базовых «кирпичиков» (протоно- и нейтроно-
        подобные структуры);
  \item деревья конечной глубины --- модели роста молекул и кристаллов;
  \item комбинации нескольких узлов, сцепленных определённым образом
        (ссылки) --- модели сложных ядер.
\end{itemize}


\subsection{Число пересечений и другие инварианты}
\label{subsec:topology-invariants}

Для классификации узлов и графов существует множество топологических
инвариантов. В контексте спектральной физики нас интересуют прежде
всего те, которые:

\begin{itemize}
  \item допускают более или менее эффективное вычисление
        (алгоритмически реализуемы);
  \item естественно входят в энергетические и массовые функционалы;
  \item хорошо коррелируют с физической «сложностью» конфигурации.
\end{itemize}

Минимальный набор инвариантов, который используется в v0.1:

\begin{enumerate}
  \item \textbf{Число пересечений} $C_{\text{cross}}[G_\theta]$.

    Для плоской диаграммы узла это минимальное число пересечений
    при всех возможных проекциях и деформациях диаграммы. В общем
    трёхмерном случае можно работать либо с конкретной диаграммой,
    либо использовать обобщённые определения (см. специализированные
    источники). В модели достаточно иметь алгоритм, который для
    заданного вложения $G_\theta \hookrightarrow X$ возвращает оценку
    $C_{\text{cross}}$.

  \item \textbf{Число компонентов} $C_{\text{comp}}[G_\theta]$.

    Количество связных компонент (сколько «кусков» содержит конфигурация).

  \item \textbf{Степенная характеристика дерева} $C_{\text{tree}}[G_\theta]$.

    Для деревьев и деревообразных частей графа --- распределение степеней
    вершин, глубина дерева, параметры ветвления.

  \item \textbf{Сцепление и linking number} для ссылок.

    Для конфигураций с несколькими замкнутыми контурами --- меры
    сцепления (linking number, возможно обобщённые).
\end{enumerate}

Эти инварианты могут комбинироваться в одном функционале, например
как в~\eqref{eq:E-top}. В более продвинутых версиях модели сюда могут
входить и более сложные объекты (аналоги инвариантов типа Громова–Виттена
для графов), но в v0.1 достаточно ограничиться вычислимыми
комбинаторными характеристиками.

Важно, что:

\begin{itemize}
  \item топологические инварианты \emph{не зависят} от гладких
        деформаций конфигурации и поэтому отражают «структурную»
        сложность;
  \item они позволяют естественно penalизировать избыточно сложные
        конфигурации при поиске минимумов функционалов (чем сложнее узел,
        тем выше $E_{\text{top}}$ и $M_{\text{top}}$);
  \item симметричные конфигурации (похожие на тетраэдр, куб и т.п.)
        часто оказываются локальными минимумами при заданном числе
        компонент и пересечений, что хорошо согласуется с идеей
        Геометрической Таблицы.
\end{itemize}


% ==========================
% ЧАСТЬ IV. ФУНКЦИОНАЛЫ САМООРГАНИЗАЦИИ
% ==========================

% ==========================
% ЧАСТЬ IV. ФУНКЦИОНАЛЫ САМООРГАНИЗАЦИИ
% ==========================
\section{Общая структура функционала состояния}
\label{sec:F-general}

В предыдущих разделах мы ввели три ключевых объекта:

\begin{itemize}
  \item конфигурацию Среды и солитонов, задаваемую набором параметров
        $\theta$ (положения узлов, масштабы, форма графа $G_\theta$ и т.п.);
  \item спектральные характеристики этой конфигурации:
        глобальную DOS $\rho(\omega;\theta)$ и локальную LDOS
        $\rho(\omega,x;\theta)$, вычисляемые через оператор $\hat H[\theta]$
        и функцию Грина;
  \item спектральный гравитационный потенциал $\phi(x)$, связанный с
        интегральной мощностью спектра.
\end{itemize}

Теперь формализуем главный объект модели --- \emph{функционал состояния},
который определяет, какие конфигурации считаются устойчивыми и
физически реализуемыми.

\subsection{Конфигурация и функционал}

Под конфигурацией будем понимать пару
\[
  \Theta = (\theta, G_\theta),
\]
где $\theta$ --- непрерывные параметры (координаты, размеры, углы),
а $G_\theta$ --- дискретная топологическая структура (граф/узел),
описывающая связность солитона.

Для каждой конфигурации $\Theta$ определяется численное значение
функционала
\begin{equation}
  F[\Theta]
  =
  F_{\text{levels}}[\Theta]
  +
  F_{\text{geom}}[\Theta]
  +
  F_{\text{add}}[\Theta],
  \label{eq:F-total}
\end{equation}
где:

\begin{itemize}
  \item $F_{\text{levels}}$ --- \textbf{спектральный функционал}, измеряющий,
        насколько спектр $\rho(\omega;\Theta)$ и набор характерных частот
        $\{\omega_i(\Theta)\}$ соответствует желаемому ``атомному'' шаблону;
  \item $F_{\text{geom}}$ --- \textbf{геометрический/топологический функционал},
        учитывающий сложность, симметрию и комбинаторику графа $G_\Theta$;
  \item $F_{\text{add}}$ --- возможные дополнительные вклады (например,
        регуляризация, мягкие ограничения на параметры, связь с массой
        и гравитацией); в базовой версии модели этот вклад можно считать
        нулевым или включать его в отдельный энергетический функционал
        (см. соответствующий раздел).
\end{itemize}

Физически реализуемые конфигурации --- это локальные минимумы $F[\Theta]$
на пространстве допустимых $\Theta$. В частности:

\begin{itemize}
  \item конфигурация, претендующая на роль \emph{отдельной частицы}
        (например, протона), должна быть минимумом $F$ среди всех
        конфигураций с заданными квантами ``заряда'' и другими
        глобальными ограничениями;
  \item конфигурация, претендующая на роль \emph{ядра атома} или
        \emph{геометрического атома} (см. Часть~V), должна минимизировать
        $F$ в классе конфигураций с фиксированным ``номером элемента''
        $Z$ (количеством элементарных узлов/вихрей).
\end{itemize}

\subsection{Роль спектральной и геометрической частей}

Интуитивно:

\begin{itemize}
  \item $F_{\text{levels}}$ отвечает за \emph{динамику}:
        правильный набор частот, отсутствие разрушительных
        низкопорядковых резонансов, соответствие экспериментальным
        спектрам (там, где они известны).
  \item $F_{\text{geom}}$ отвечает за \emph{форму}:
        излишняя топологическая запутанность и нарушение симметрии
        увеличивают $F_{\text{geom}}$, а простые и высокосимметричные
        конфигурации (тетраэдр, куб и т.п.) его минимизируют.
\end{itemize}

Такая разбиение важно и концептуально, и вычислительно:

\begin{itemize}
  \item спектральная часть $F_{\text{levels}}$ опирается на расчёт DOS/LDOS
        и может быть реализована поверх любого достаточно общего численного
        решателя для $\hat H[\theta]$;
  \item геометрическая часть $F_{\text{geom}}$ зависит только от графа
        и относительного расположения узлов (без обращения к полному спектру),
        поэтому её можно считать быстрее и использовать, например, на ранних
        этапах грубой оптимизации.
\end{itemize}

В дальнейшем, в Части~IV, мы уточняем вид $F_{\text{levels}}$ и
$F_{\text{geom}}$, а в разделе о массе и энергетике связываем минимумы
$F$ с эффективной массой и гравитационным вкладом солитонной конфигурации.

\section{Спектральный функционал \texorpdfstring{$F_{\text{levels}}$}{F\_levels}}
\label{sec:F-levels}

Введём явный вид спектральной части функционала
$F_{\text{levels}}[\Theta]$, используя формализм DOS/LDOS из
раздела~\ref{sec:DOS-Green}.

Пусть для конфигурации $\Theta$ мы можем численно вычислить:

\begin{itemize}
  \item глобальную плотность состояний $\rho(\omega;\Theta)$;
  \item набор выделенных собственных частот
        $\{\omega_i(\Theta)\}$ (например, пиков DOS);
  \item локальную плотность состояний $\rho(\omega,x;\Theta)$
        в окрестности ядра и вдоль возможных направлений связей.
\end{itemize}

Кроме того, для многих систем (водород, гелий, некоторые переходы
лёгких элементов) известен \emph{экспериментальный} или \emph{целевой}
набор частот $\{\omega_i^{\text{exp}}\}$ и/или форма спектра
$\rho_{\text{target}}(\omega)$.

\subsection{Составляющие \texorpdfstring{$F_{\text{levels}}$}{F\_levels}}

Спектральный функционал будем строить как сумму трёх вкладов:
\begin{equation}
  F_{\text{levels}}[\Theta]
  =
  F_{\text{match}}[\Theta]
  +
  F_{\text{res}}[\Theta]
  +
  F_{\text{band}}[\Theta].
  \label{eq:F-levels-sum}
\end{equation}

Интерпретация:

\begin{itemize}
  \item $F_{\text{match}}$ --- штраф за несовпадение ключевых частот
        с целевыми (экспериментальными или теоретическими);
  \item $F_{\text{res}}$ --- штраф за ``опасные'' низкопорядковые
        резонансы между модами;
  \item $F_{\text{band}}$ --- штраф/поощрение за общий вид DOS
        (наличие или отсутствие зазоров, ширина полос и т.п.).
\end{itemize}

\subsection{Совпадение с целевыми частотами}

Если для данного класса объектов (например, атом водорода) известен
набор частот $\{\omega_i^{\text{exp}}\}$, то естественный вклад:
\begin{equation}
  F_{\text{match}}[\Theta]
  =
  \sum_i \alpha_i
  \bigl(
    \omega_i(\Theta) - \omega_i^{\text{exp}}
  \bigr)^2,
  \label{eq:F-match}
\end{equation}
где $\alpha_i$ --- веса, отражающие важность соответствующего перехода.

В ситуациях, когда известен не набор линий, а только ``грубая''
форма спектра (например, наличие полосы или зазора в кристалле),
можно использовать интегральное сравнение:
\begin{equation}
  F_{\text{match}}[\Theta]
  =
  \int W_{\text{match}}(\omega)
  \bigl(
    \rho(\omega;\Theta)
    -
    \rho_{\text{target}}(\omega)
  \bigr)^2\,d\omega,
  \label{eq:F-match-rho}
\end{equation}
где $W_{\text{match}}(\omega)$ выделяет важные интервалы частот.

\subsection{Подавление низкопорядочных резонансов}

Нелинейная Среда склонна переходить в режим катастрофических
биений, если для пары мод $\omega_i,\omega_j$ выполняются
низкопорядочные соотношения вида $m\omega_i \approx n\omega_j$
с малыми целыми $m,n$. Такие резонансы снижают устойчивость
конфигурации.

Эмпирический штраф можно задать в виде
\begin{equation}
  F_{\text{res}}[\Theta]
  =
  \sum_{i<j}
  \sum_{m,n \in \mathcal{R}}
  \beta_{ij}^{(m,n)}
  \exp\!\left(
    -\frac{
      (m\,\omega_i(\Theta)-n\,\omega_j(\Theta))^2
    }{\Delta_{mn}^2}
  \right),
  \label{eq:F-res}
\end{equation}
где:

\begin{itemize}
  \item $\mathcal{R}$ --- набор низкопорядковых пар $(m,n)$,
        например $\{(1,1),(1,2),(2,3),\dots\}$;
  \item $\beta_{ij}^{(m,n)}$ --- веса (чем более опасен резонанс,
        тем больше вес);
  \item $\Delta_{mn}$ --- допустимая ``зона неопределённости'' вокруг
        точного резонанса.
\end{itemize}

При таком определении $F_{\text{res}}$ минимизируется, когда все
низкопорядковые комбинации частот оказываются \emph{достаточно далеко}
от точных резонансов, что соответствует устойчивому спектру
без сильных биений.

\subsection{Грубая форма спектра и полосы}

Для некоторых классов конфигураций важно наличие \emph{зазоров}
(частотных областей с малой DOS) или, наоборот, непрерывных полос.
Это можно учитывать через дополнительный функционал $F_{\text{band}}$.

Простейший вариант: поощрять заданную форму DOS в выбранных
диапазонах. Например, для ``атомоподобного'' объекта мы можем
требовать, чтобы глобальная DOS имела отчётливый набор узких пиков
и малую фоновой плотность между ними:
\begin{equation}
  F_{\text{band}}[\Theta]
  =
  \int W_{\text{gap}}(\omega)\,
       \rho(\omega;\Theta)\,d\omega,
  \label{eq:F-band}
\end{equation}
где $W_{\text{gap}}(\omega)$ ненулевая в диапазонах, где желателен
минимальный фон (``зазоры''). Тогда уменьшение фоновой DOS в этих
областях уменьшает $F_{\text{band}}$ и повышает устойчивость.

Аналогично, для кристаллических структур можно строить $F_{\text{band}}$
так, чтобы поощрять наличие непрерывных полос в заданных диапазонах.

\subsection{Использование \texorpdfstring{$F_{\text{levels}}$}{F\_levels} в оптимизации}

При численной оптимизации конфигурации $\Theta$ (например, при поиске
геометрии прототипа атома) спектральный функционал $F_{\text{levels}}$
\begin{itemize}
  \item вычисляется на каждом шаге по текущему спектру
        $\{\omega_i(\Theta)\}$ и DOS $\rho(\omega;\Theta)$;
  \item даёт градиент (или псевдоградент), который можно использовать
        в алгоритмах типа Symmetric Newton для корректировки параметров
        $\theta$;
  \item служит универсальной мерой ``насколько данная конфигурация
        похожа на правильный атом/солитон'' с точки зрения спектра.
\end{itemize}

В совокупности с геометрическим функционалом $F_{\text{geom}}$
(см. следующий раздел) это позволяет сформулировать чисто
вычислимую задачу: найти такие $\Theta$, для которых $F[\Theta]$
минимален, и тем самым задать геометрические прототипы атомов
и других устойчивых объектов спектральной Среды.
\section{Геометрический функционал \texorpdfstring{$F_{\text{geom}}$}{F\_geom}}
\label{sec:F-geom}

Геометрический функционал $F_{\text{geom}}$ описывает ``цену'' той или
иной топологии и формы солитонной конфигурации. В отличие от
спектральной части $F_{\text{levels}}$, здесь мы работаем только с:

\begin{itemize}
  \item графом/узлом $G_\Theta$ (связность, число петель, ветвистость);
  \item относительными положениями ключевых вершин (узлов солитона);
  \item выбранной группой симметрии (тетраэдрическая, кубическая и т.п.).
\end{itemize}

Цель $F_{\text{geom}}$ --- формализовать интуицию:

\begin{itemize}
  \item чем сложнее и хаотичнее топология, тем выше энергетическая
        ``стоимость'' конфигурации;
  \item конфигурации, близкие к правильным многогранникам (тетраэдр,
        куб, икосаэдр), автоматически предпочтительнее тех, где форма
        произвольно искажена;
  \item рост молекул и кристаллов подчиняется вероятностным законам
        самоорганизации (``модель ёлки'').
\end{itemize}

Ниже задаём явный анзац для всех этих эффектов.

\subsection{Комбинаторная сложность (crossing number)}

Пусть $G_\Theta$ --- граф или узел, задающий ``каркас'' солитона.
Обозначим через $C_{\text{cross}}[G_\Theta]$ его эффективное
\emph{число пересечений} (crossing number) или более общий
топологический инвариант, полученный по схеме Мендозы
(см. Приложение~\ref{app:math2025}).

Тогда естественный вклад сложности:
\begin{equation}
  F_{\text{complex}}[G_\Theta]
  =
  \alpha_{\text{cross}}\,
  C_{\text{cross}}[G_\Theta],
  \label{eq:F-complex}
\end{equation}
где $\alpha_{\text{cross}}>0$ --- коэффициент масштаба.

Интерпретация: лишние закрутки, узлы и хаотичные петли увеличивают
$C_{\text{cross}}$ и, следовательно, повышают $F_{\text{complex}}$.
Это соответствует идее, что солитоны минимальной энергии должны
иметь минимально необходимую топологическую сложность.

\subsection{Симметрия и платоновы тела}

Для геометрии ядра важно не только количество связей, но и их
расположение в пространстве. Мы вводим \emph{целевую} группу симметрии
$H$ (например, тетраэдрическая $T_d$ для углерода, кубическая $O_h$
для кислорода/неона) и определяем меру отклонения от идеальной формы.

Пусть $\{ \bm{v}_k \}$ --- набор направлений ``портов'' (связей) в
конфигурации $\Theta$, а $\{ \bm{u}_k \}$ --- соответствующие идеальные
направления в выбранном платоновом теле. Тогда можно ввести
\begin{equation}
  F_{\text{sym}}[\Theta]
  =
  \alpha_{\text{sym}}
  \sum_k
  \bigl(
    1 - \bm{v}_k \cdot \bm{u}_k
  \bigr),
  \label{eq:F-sym}
\end{equation}
где произведение $\bm{v}_k \cdot \bm{u}_k$ --- косинус угла между
реальным и идеальным направлением, а $\alpha_{\text{sym}}>0$ --- вес.

При точном совпадении с идеальной формой все скалярные произведения
стремятся к 1 и $F_{\text{sym}}$ минимален. Произвольные искажения
формы увеличивают $F_{\text{sym}}$.

В более общем варианте можно использовать инварианты вида
\[
  F_{\text{sym}}[\Theta]
  =
  \alpha_{\text{sym}}\,
  \bigl\|
    T(\Theta) - T_{\text{ideal}}
  \bigr\|^2,
\]
где $T$ --- тензор квадрупольного или более высокого порядка момента
для распределения ``портов'', а $T_{\text{ideal}}$ --- соответствующий
тензор для идеального многогранника.

\subsection{Рост деревьев и ``ёлка''}

Когда речь идёт не об отдельном ядре, а о росте молекул и кристаллов,
базовый объект --- не один граф $G_\Theta$, а \emph{растущее дерево}
$T$ с декорациями (типами атомов и связей).

По теореме ``Рождественской ёлки'' Мендозы (см. Приложение) распределение
расстояний и ветвистости в большом дереве стремится к универсальной
форме. Мы используем это в виде штрафа за отклонение от ``естественного''
режима роста.

Обозначим через $p_{\text{emp}}(d)$ эмпирическое распределение
расстояний/уровней в текущем дереве $T$, а через $F_{\text{tree}}(d)$
--- предсказанную предельную функцию вида
\[
  F_{\text{tree}}(d)
  =
  1 - \exp\!\Bigl(
    -2 \sum_{k\ge 0} \gamma_k(d)
  \Bigr).
\]

Тогда естественный функционал:
\begin{equation}
  F_{\text{tree}}[T]
  =
  \alpha_{\text{tree}}
  \int
  W_{\text{tree}}(d)\,
  \bigl(
    p_{\text{emp}}(d) - F_{\text{tree}}'(d)
  \bigr)^2\,dd,
  \label{eq:F-tree}
\end{equation}
где:

\begin{itemize}
  \item $F_{\text{tree}}'(d)$ --- плотность, полученная из
        $F_{\text{tree}}(d)$ дифференцированием по $d$;
  \item $W_{\text{tree}}(d)$ --- весовая функция, выделяющая диапазоны
        расстояний/уровней, важные для данной структуры.
\end{itemize}

Интуитивно: геометрическая самосборка, соответствующая ``естественным''
правилам ветвления Среды, даёт малое $F_{\text{tree}}$, а искусственные
или сильно искажённые структуры --- большое.

\subsection{Итоговый анзац для \texorpdfstring{$F_{\text{geom}}$}{F\_geom}}

Собирая все вкладки вместе, получаем рабочий анзац:
\begin{equation}
  F_{\text{geom}}[\Theta]
  =
  F_{\text{complex}}[G_\Theta]
  +
  F_{\text{sym}}[\Theta]
  +
  F_{\text{tree}}[T_\Theta],
  \label{eq:F-geom-total}
\end{equation}
где:

\begin{itemize}
  \item $F_{\text{complex}}$ задаётся формулой~\eqref{eq:F-complex} и
        отвечает за топологическую сложность;
  \item $F_{\text{sym}}$ задаётся формулой~\eqref{eq:F-sym} (или её
        тензорным вариантом) и отвечает за близость к платоновым телам;
  \item $F_{\text{tree}}$ задаётся формулой~\eqref{eq:F-tree} и описывает
        статистику роста деревьев в молекулах/кристаллах (если это
        вообще актуально для рассматриваемой задачи; в атомном пределе
        его можно опускать).
\end{itemize}

В первом приближении для одиночных атомов и простых ядер достаточно
первых двух членов ($F_{\text{complex}} + F_{\text{sym}}$). Третий член
актуален для моделирования сборки молекул и материалов, но его можно
включать по мере развития кода и появления соответствующих задач.

\section{Масса и энергетический функционал}
\label{sec:F-mass}

Теперь свяжем функционалы состояния с эффективной массой и энергией
солитонных конфигураций.

Для заданной конфигурации $\theta$ спектр оператора $\hat H[\theta]$
определяет глобальную плотность состояний $\rho(\omega;\theta)$.
Интегральный спектральный вклад в энергию можно задать в виде
\begin{equation}
  E_{\mathrm{spec}}[\theta]
  =
  \int_{0}^{\infty}
    w(\omega)\,\rho(\omega;\theta)\,d\omega,
  \label{eq:E-spec-alt}
\end{equation}
где $w(\omega)$ --- весовая функция (аналог «энергии на одно состояние»
для данной частоты).

Топологический вклад в энергию/массу зададим через функционал
$\Psi(G_\theta)$, зависящий от инвариантов узла/графа (числа пересечений,
индексов зацепления и т.п.):
\begin{equation}
  E_{\mathrm{top}}[G_\theta]
  = \mu_{\mathrm{top}}\,\Psi(G_\theta).
  \label{eq:E-top-alt}
\end{equation}

Эффективная масса солитона:
\begin{equation}
  M_{\mathrm{sol}}[\theta]
  =
  \frac{1}{c_0^2}
  \Big(
    E_{\mathrm{spec}}[\theta]
    + E_{\mathrm{top}}[G_\theta]
  \Big),
  \label{eq:M-sol-alt}
\end{equation}
где $c_0$ --- фиксированная масштабная скорость (характерная скорость
распространения волн Среды в базовом состоянии).

В численной реализации можно:
\begin{itemize}
  \item вычислять $\rho(\omega;\theta)$ через DOS (по функциям Грина
        или по собственным значениям дискретизированного $\hat H$);
  \item выбирать простые формы $w(\omega)$ (например, $w(\omega)\propto\omega$);
  \item подбирать $\mu_{\mathrm{top}}$ и параметры $\Psi(G_\theta)$ так,
        чтобы для протона, нейтрона и лёгких ядер получались реалистичные
        относительные массы.
\end{itemize}

Таким образом, $F_{\mathrm{levels}}$ и $F_{\mathrm{geom}}$ определяют
устойчивость и «форму» конфигурации, а $M_{\mathrm{sol}}$ --- её
инерционные свойства в динамике.


% ==========================
% ЧАСТЬ V. ГЕОМЕТРИЧЕСКАЯ ТАБЛИЦА АТОМОВ
% ==========================
\section{Определение геометрического атома}
\label{sec:geom-atom-def}

В рамках данной модели \textbf{атом} элемента с атомным номером $Z$ —
это устойчивый солитонный объект Среды, описываемый набором параметров
$\theta_Z$ и топологией $G_{\theta_Z}$, такой что:

\begin{enumerate}
  \item он является локальным минимумом атомного функционала
  \begin{equation}
    F_{\mathrm{atom}}[\theta_Z]
    =
    \lambda_{\mathrm{lev}}^{(Z)} F_{\mathrm{levels}}[\theta_Z]
    +
    \lambda_{\mathrm{geom}}^{(Z)} F_{\mathrm{geom}}[G_{\theta_Z}],
    \label{eq:F-atom-Z}
  \end{equation}
  среди конфигураций с данным $Z$;
  \item его спектральные характеристики (набор устойчивых частот,
        структура LDOS) согласуются с наблюдаемыми энергетическими
        уровнями и типичной химической валентностью элемента;
  \item его геометрическая форма (расположение «портов»,
        симметрия ядра и оболочки) допускает наблюдаемые типы связей
        и кристаллических структур.
\end{enumerate}

Под \textbf{портами} будем понимать направления в пространстве, в которых:

\begin{itemize}
  \item локальная плотность состояний $\rho(\omega,x;\theta_Z)$ имеет
        выраженные максимумы на частотах, соответствующих связям;
  \item геометрически возможна стыковка с другой конфигурацией без
        сильного роста $F_{\mathrm{geom}}$;
  \item при «стыковке» двух атомов суммарный функционал
        $F_{\mathrm{atom}}^{(1+2)}$ уменьшается или остаётся малым.
\end{itemize}

Тогда \textbf{валентность} элемента в данной среде определяется как
количество независимых портов (с учётом симметрии), через которые
атом может образовывать устойчивые связи при приемлемом росте
$F_{\mathrm{atom}}$.

Отдельно важно отметить, что в данной постановке:

\begin{itemize}
  \item \emph{нет понятия «электронных орбиталей» как отдельных частиц;}
        вместо этого есть геометрия LDOS вокруг солитона ядра;
  \item \emph{ядро и «оболочка» рассматриваются как единый солитонный
        объект}, у которого просто есть разные пространственные зоны
        концентрации спектра;
  \item \emph{химические свойства} (валентность, инертность, склонность
        к образованию цепей и плоскостей) трактуются как следствие
        формы $G_{\theta_Z}$ и спектра $\hat H[\theta_Z]$.
\end{itemize}


\section{Мини-таблица H--Ne}
\label{sec:minitable-H-Ne}

В этом разделе фиксируется рабочая гипотеза о геометрических прототипах
для первых десяти элементов (H, He, Li, Be, B, C, N, O, F, Ne). Эти
прототипы служат начальными приближениями для численной оптимизации
$\theta_Z$ по функционалу \eqref{eq:F-atom-Z}.

\subsection{Водород (H)}

\begin{itemize}
  \item \textbf{Топология ядра:} один базовый тороидальный узел
        (простое кольцо или трилистник минимальной сложности).
  \item \textbf{Геометрия:} осесимметричная конфигурация с одним
        выраженным портом вдоль оси.
  \item \textbf{Валентность:} $1$ — один порт, допускающий стыковку
        с другими узлами.
  \item \textbf{Спектральные требования:}
        \begin{itemize}
          \item наличие одного основного связанного уровня;
          \item простая линейчатая структура при возбуждении.
        \end{itemize}
\end{itemize}

В численных экспериментах v0.1 водород можно моделировать как
минимальный солитон с одним портом, проверяя, что при стыковке двух
таких узлов (молекула H\textsubscript{2}) функционал для пары ниже,
чем для двух несвязанных атомов.


\subsection{Гелий (He)}

\begin{itemize}
  \item \textbf{Топология ядра:} два тесно сцепленных тора, образующих
        максимально замкнутую и симметричную конфигурацию
        (аналог «двойного тора» или сферы).
  \item \textbf{Геометрия:} практически сферически симметричная
        конфигурация без выраженных портов.
  \item \textbf{Валентность:} $0$ — отсутствие портов, стыковка с
        другими узлами резко увеличивает $F_{\mathrm{geom}}$.
  \item \textbf{Спектральные требования:}
        \begin{itemize}
          \item высокий энергетический разрыв до первых
                возбуждённых состояний;
          \item отсутствие удобных резонансов для формирования
                устойчивых связей.
        \end{itemize}
\end{itemize}

Гелий служит эталоном \emph{замкнутой} геометрической конфигурации:
минимум $F_{\mathrm{geom}}$ при данном числе базовых узлов и
соответствующая минимальная химическая активность.


\subsection{Литий (Li), бериллий (Be), бор (B)}

Эти элементы можно рассматривать как «надстройку» над замкнутой
гелиевой конфигурацией.

\paragraph{Литий (Li).}

\begin{itemize}
  \item \textbf{Геометрия:} конфигурация He плюс один дополнительный
        узел/лопасть, выступающая наружу.
  \item \textbf{Валентность:} $1$ — один относительно слабосвязанный
        внешний порт.
  \item \textbf{Спектрально:} один внешний уровень, легко отдающий
        энергию (что согласуется с поведением щелочных металлов).
\end{itemize}

\paragraph{Бериллий (Be).}

\begin{itemize}
  \item \textbf{Геометрия:} два более симметрично расположенных
        внешних узла на базе He.
  \item \textbf{Валентность:} в простейшей модели $2$.
  \item \textbf{Особенность:} тенденция к образованию линейных и
        плоских структур при минимальном росте $F_{\mathrm{geom}}$.
\end{itemize}

\paragraph{Бор (B).}

\begin{itemize}
  \item \textbf{Геометрия:} три внешних узла в конфигурации, близкой
        к плоскому тригональному расположению.
  \item \textbf{Валентность:} формально $3$, но с выраженной
        анизотропией портов.
  \item \textbf{Спектрально:} допускает как плоские, так и объёмные
        структуры с относительно небольшим ростом
        $F_{\mathrm{levels}}$.
\end{itemize}

В рамках v0.1 эти элементы важны как тесты того, что
$F_{\mathrm{geom}}$ корректно отражает переход от «почти замкнутой»
структуры (He) к появлению всё большего числа портов.


\subsection{Углерод (C), азот (N), кислород (O)}

\paragraph{Углерод (C).}

\begin{itemize}
  \item \textbf{Топология ядра:} конфигурация, допускающая расположение
        четырёх портов, направленных к вершинам тетраэдра.
  \item \textbf{Геометрия:} максимально близкая к тетраэдрической
        симметрии; ядро и оболочка совместно образуют четырёхпортовый
        «стыковочный узел».
  \item \textbf{Валентность:} $4$ — четыре почти эквивалентных порта.
  \item \textbf{Физический смысл:} углерод является базовым
        строительным блоком для трёхмерных сетей (органика,
        кристаллы типа алмаза, графитовые слои).
\end{itemize}

\paragraph{Азот (N).}

\begin{itemize}
  \item \textbf{Геометрия:} конфигурация, получающаяся из
        тетраэдрической структуры при перераспределении плотности
        в пользу трёх портов и возникновении «парного» режима на
        одном из направлений.
  \item \textbf{Валентность:} эффективно $3$ с возможностью
        образования одной «свободной пары».
  \item \textbf{Спектрально:} спектр и LDOS должны отражать склонность
        к образованию трёх прочных связей и одной менее связанной
        зоны.
\end{itemize}

\paragraph{Кислород (O).}

\begin{itemize}
  \item \textbf{Геометрия:} конфигурация с двумя активными портами и
        двумя «парами», ориентированными под углом $\sim 90^\circ$.
  \item \textbf{Валентность:} $2$ с двумя выраженными неспаренными
        парами (модель «куба без двух вершин»).
  \item \textbf{Физический смысл:} высокая реакционная способность при
        стыковке, стремление «закрыть» геометрические дыры.
\end{itemize}

Углерод, азот и кислород образуют триаду, на которой можно проверять,
насколько правильно $F_{\mathrm{levels}}$ и $F_{\mathrm{geom}}$ описывают
переход от четырёхпортовой к трёх- и двумпортовой конфигурации при
минимальных изменениях ядра.


\subsection{Фтор (F) и неон (Ne)}

\paragraph{Фтор (F).}

\begin{itemize}
  \item \textbf{Геометрия:} конфигурация, близкая к почти замкнутой
        (почти куб/двойной тетраэдр), но с одной ярко выраженной
        «ямой»/портом.
  \item \textbf{Валентность:} $1$ — один мощный порт, чрезвычайно
        «жадный» до стыковки.
  \item \textbf{Физический смысл:} сильный окислитель, стремящийся
        добрать недостающий «кусок» до полной геометрической замкнутости.
\end{itemize}

\paragraph{Неон (Ne).}

\begin{itemize}
  \item \textbf{Геометрия:} полностью замкнутая конфигурация с
        симметрией, близкой к кубической или двойному тетраэдру.
  \item \textbf{Валентность:} $0$ — отсутствие портов;
        любые попытки стыковки приводят к резкому росту
        $F_{\mathrm{geom}}$.
  \item \textbf{Спектральные требования:} большой энергетический разрыв
        до первых возбуждённых уровней, спектр инертного газа.
\end{itemize}

\subsection{Роль мини-таблицы H--Ne в ТЗ}

Мини-таблица H--Ne в данной книге выполняет несколько функций:

\begin{itemize}
  \item задаёт \emph{набор прототипов} $G_{\theta_Z}$, который можно
        использовать как начальное приближение для численной оптимизации;
  \item служит \emph{тестовым полигоном} для функционалов
        $F_{\mathrm{levels}}$ и $F_{\mathrm{geom}}$: если даже для
        первых десяти элементов не удаётся воспроизвести базовые
        спектральные и химические свойства, функционалы требуют
        доработки;
  \item образует \emph{концептуальный каркас} Геометрической Таблицы,
        который затем можно расширять на более тяжёлые элементы,
        изотопы и кристаллические структуры.
\end{itemize}

\section{Черновики: геометрические тезисы для H--Ne}
\label{sec:drafts-H-Ne}

Этот раздел носит черновой характер и фиксирует несколько
геометрических тезисов, которые появляются уже на уровне
самой простой графовой игрушечной модели для элементов H--Ne.
Формально речь идёт о минималистском функционале
\begin{equation}
  F_{\mathrm{geom}}(Z)
  = a\,\mu(G_Z) + b\,\operatorname{sym}(G_Z) + c\,p_Z,
\end{equation}
где
\begin{itemize}
  \item $G_Z$ --- граф/узел, сопоставленный элементу с атомным номером $Z$;
  \item $\mu(G_Z)$ --- цикломатическое число (эффективная ``узловатость'':
        число независимых циклов);
  \item $\operatorname{sym}(G_Z)$ --- мера нарушения симметрии
        (чем меньше, тем более симметрична конфигурация);
  \item $p_Z$ --- число геометрических портов (направлений возможных связей);
  \item $a,b,c>0$ --- численные коэффициенты, калибруемые в игрушечной модели.
\end{itemize}

Отдельно удобно ввести ``геометрическую энергию порта''
\begin{equation}
  E_{\mathrm{port}}(Z)
  =
  \begin{cases}
    \dfrac{F_{\mathrm{geom}}(Z)}{p_Z}, & p_Z>0,\\[6pt]
    \text{не определено}, & p_Z = 0,
  \end{cases}
\end{equation}
которая показывает, сколько геометрической ``цены'' приходится
на один активный порт.

\subsection*{Тезис 1: геометрическая инертность He и Ne}

В рассматриваемой схеме элементам He и Ne сопоставляются
конфигурации с нулём портов:
\[
  p_{\mathrm{He}} = p_{\mathrm{Ne}} = 0,
\]
и очень малой величиной $\operatorname{sym}(G_Z)$ (высокая симметрия).
При разумном выборе параметров $(a,b,c)$ такие конфигурации
реализуют локальные минимумы $F_{\mathrm{geom}}$ в своих периодах по $Z$:
\begin{itemize}
  \item He --- минимум среди $Z=1,2$;
  \item Ne --- минимум среди $Z=3,\dots,10$.
\end{itemize}

Интерпретация:
\begin{quote}
  нулевые порты при высокой симметрии делают геометрическую
  конфигурацию ``замкнутой'': любое появление порта ($p_Z>0$) или
  сильная деформация симметрии автоматически повышают
  $F_{\mathrm{geom}}$. В этом смысле He и Ne являются
  геометрическими аналогами инертных газов.
\end{quote}

\subsection*{Тезис 2: фтор как атом с максимально дорогим портом}

Для элементов первого и второго периодов $Z=1,\dots,9$ с $p_Z>0$
простая калибровка (например, $a=0.5$, $b=1.0$, $c=1.5$) даёт
кластер значений $E_{\mathrm{port}}(Z)$ в узком интервале
порядка $1.7$--$2.0$ \mbox{(в условных единицах)} и одновременно
аномально высокое значение для фтора:
\[
  E_{\mathrm{port}}(\mathrm{F})
  \gg E_{\mathrm{port}}(Z), \qquad Z\neq \mathrm{F}.
\]

Это позволяет трактовать порт фтора как геометрически
наиболее ``напряжённый'': включение такого порта в связь даёт
максимальное относительное снижение $F_{\mathrm{geom}}$, и потому
фтор естественно выступает кандидатом на роль наиболее
``жадного'' атома периода в смысле тяги к захвату спектральной
плотности Среды и образованию связей.

\subsection*{Тезис 3: углерод как многопортовый строитель сетей}

В той же игрушечной модели углерод обладает максимальным числом
портов в рассматриваемом наборе элементов:
\[
  p_{\mathrm{C}} = 4,
\]
и при этом минимальной геометрической энергией порта
среди всех конфигураций с $p_Z>0$:
\[
  E_{\mathrm{port}}(\mathrm{C})
  = \min_{Z:\,p_Z>0} E_{\mathrm{port}}(Z).
\]

То есть каждый отдельный порт углерода геометрически ``дешёв''
(его включение слабо повышает $F_{\mathrm{geom}}$), но суммарная
портовая структура богата: четыре направления позволяют строить
разветвлённые объёмные и плоские сети. Такая комбинация ---
малый $E_{\mathrm{port}}$ при большом $p_{\mathrm{C}}$ ---
естественно выделяет углерод как оптимальный элемент для
самоорганизации сложных солитонных каркасов в Среде
(органических молекул, кристаллических и аморфных сетей).

Эти тезисы пока остаются черновыми: они основаны на одной
конкретной игрушечной калибровке и должны рассматриваться как
гипотезы, подлежащие проверке более точными спектральными
вычислениями и сопоставлением с экспериментальной химией.

\section{Черновики: геометрия портов и углы связей}
\label{sec:drafts-port-geometry}

В дополнение к числу портов, общей геометрической ``цене''
$F_{\mathrm{geom}}$ и энергии одного порта $E_{\mathrm{port}}$
удобно ввести ещё один слой описания --- \emph{геометрию
расположения портов}. Речь идёт о том, как Среда выбрасывает
направления возможных связей в трёхмерное пространство.

\subsection*{Геометрический паспорт атома}

Для каждого элемента $Z$ в игрушечной модели мы фиксируем
следующий набор характеристик:

\begin{itemize}
  \item $p_Z$ --- число портов (направлений, в которых атом может
        образовывать устойчивые связи);
  \item $F_{\mathrm{geom}}(Z)$ --- геометрический функционал
        (сложность $+$ асимметрия $+$ вклад портов);
  \item $E_{\mathrm{port}}(Z) = F_{\mathrm{geom}}(Z)/p_Z$ при $p_Z>0$
        --- геометрическая ``энергия одного порта'';
  \item $\operatorname{port\_geometry}(Z)$ --- тип фигуры портов,
        один из \verb|linear|, \verb|trigonal|, \verb|tetra|,
        \verb|pyramidal|, \verb|bent|, \verb|single|, \verb|none|;
  \item $\operatorname{preferred\_angle}(Z)$ --- характерный угол
        между портами в минимальной конфигурации (в градусах),
        если он имеет смысл.
\end{itemize}

В этом языке атом --- не точка с квантовыми числами, а узел Среды
с конкретной портовой геометрией, уже несущий в себе ``любимые''
углы связей.

\subsection*{Геометрическая таблица H--Ne}

Для элементов H--Ne портовая геометрия и характерные углы в базовом
состоянии задаются в виде

\begin{center}
\begin{tabular}{c c c c c}
\hline
El & $Z$ & $p_Z$ & геометрия портов & угол, $^\circ$ \\
\hline
H  & 1  & 1 & single   & ---   \\
He & 2  & 0 & none     & ---   \\
Li & 3  & 1 & single   & ---   \\
Be & 4  & 2 & linear   & 180.0 \\
B  & 5  & 3 & trigonal & 120.0 \\
C  & 6  & 4 & tetra    & 109.5 \\
N  & 7  & 3 & pyramidal& 107.0 \\
O  & 8  & 2 & bent     & 104.0 \\
F  & 9  & 1 & single   & ---   \\
Ne & 10 & 0 & none     & ---   \\
\hline
\end{tabular}
\end{center}

Интерпретация по группам:

\begin{itemize}
  \item He, Ne --- тип \verb|none|: замкнутые геометрические
        конфигурации без портов.
  \item H, Li, F --- тип \verb|single|: по одному терминальному
        порту, естественные ``висячие'' фрагменты.
  \item Be --- два порта в геометрии \verb|linear|, естественная
        линейная структура.
  \item B --- три порта в плоской \verb|trigonal|-геометрии
        (равносторонний треугольник).
  \item C --- четыре порта в \verb|tetra|-геометрии (тетраэдр).
  \item N --- три порта в \verb|pyramidal|-геометрии ---
        ``тетраэдр минус один порт''.
  \item O --- два порта в \verb|bent|-геометрии ---
        ``тетраэдр минус два порта''.
\end{itemize}

В последней интерпретации $N$ и $O$ удобно рассматривать как
остатки полной тетраэдрической конфигурации ядра: некоторые
направления заняты внутренней структурой (виртуальными портами),
а видимые химические порты занимают оставшиеся позиции.

\subsection*{Любимые фигуры портов и углы связей}

Стандартный язык квантовой химии описывает углы связей через
гибридизацию (sp, sp$^2$, sp$^3$ и т.п.). В данной модели тот же
факт переформулируется чисто геометрически:
\begin{quote}
  углы связей возникают как компромисс между любимой портовой
  фигурой каждого атома и минимизацией геометрического функционала
  $F_{\mathrm{geom}}$.
\end{quote}

Примеры:

\begin{itemize}
  \item Be (\verb|linear|, $180^\circ$) --- два порта на одной
        прямой минимизируют их взаимное влияние; естественна
        линейная геометрия.
  \item B (\verb|trigonal|, $120^\circ$) --- три порта в плоскости
        образуют равносторонний треугольник; отсюда типичная
        тригонально-плоская геометрия центров бора.
  \item C (\verb|tetra|, $109{,}5^\circ$) --- четыре порта в вершинах
        тетраэдра задают максимально однородное распределение
        направлений в 3D; это геометрическая основа тетраэдрических
        молекул (CH$_4$ и трёхмерных углеродных сетей).
  \item N (\verb|pyramidal|, $\sim 107^\circ$) --- ``тетраэдр минус
        один порт'': три химических направления и один виртуальный;
        угол слегка меньше тетраэдрического, как в NH$_3$.
  \item O (\verb|bent|, $\sim 104^\circ$) --- ``тетраэдр минус два
        порта'': два активных направления ещё сильнее сближаются;
        характерный угол близок к наблюдаемому в воде.
\end{itemize}

\subsection*{Углы и валентность как следствие портовой геометрии}

Даже на уровне H--Ne можно сформулировать минимальное геометрическое
правило:

\begin{enumerate}
  \item число портов $p_Z$ определяет валентность элемента в данной
        Среде;
  \item тип портовой геометрии $\operatorname{port\_geometry}(Z)$
        задаёт ``любимую'' пространственную фигуру связей;
  \item характерный угол $\operatorname{preferred\_angle}(Z)$
        задаёт естественный диапазон углов, к которому стремятся
        реальные связи при отсутствии сильных внешних ограничений,
        поскольку он соответствует минимуму $F_{\mathrm{geom}}$.
\end{enumerate}

Нетипичные химические ситуации (напряжённые циклы, гипервалентные
центры и др.) можно рассматривать как случаи, когда портовые фигуры
одного или нескольких атомов вынуждены отклоняться от своих
любимых углов, и рост $F_{\mathrm{geom}}$ при этом трактовать как
геометрический вклад в энергию и нестабильность конфигурации.

\subsection*{Черновики: геометрическое напряжение углов}

В предыдущем разделе портовая геометрия каждого атома была описана через
число портов $p_Z$, тип фигуры портов $\operatorname{geom}(Z)$ и
характерный ``любимый'' угол $\theta_0(Z)$ между портами
(линейная, тригональная, тетраэдрическая и т.\,д.).
Это описание относится к изолированному атомному солитону в Среде:
его порты занимают те направления, которые минимизируют
геометрический функционал $F_{\text{geom}}(Z)$.

Когда атомы объединяются в молекулу, внешняя геометрия (кольца, цепочки,
кластеры) заставляет порты отклоняться от их предпочтительных
ориентаций. В спектрально--геометрическом языке это естественно
трактуется как \emph{геометрическое напряжение углов}.

\subsubsection*{Модельный угловой вклад в функционал}

На уровне простейшей феноменологической модели можно выделить отдельный
угловой функционал, зависящий от отклонения фактических углов связей
от любимых углов для данного вида атома:
\[
F_{\text{angle}}(Z;\{\theta_i\}) =
\sum_{i} k_Z \bigl(\theta_i - \theta_0(Z)\bigr)^2,
\]
где
\begin{itemize}
  \item $\theta_i$~--- фактические углы между портами данного атома
        в конкретной молекулярной конфигурации;
  \item $\theta_0(Z)$~--- любимый угол для элемента $Z$, определяемый
        его портовой геометрией (например,
        $\theta_0(\mathrm{C})\approx 109.5^\circ$
        для тетраэдра,
        $\theta_0(\mathrm{B})\approx 120^\circ$
        для тригонально--плоской фигуры и т.\,д.);
  \item $k_Z$~--- эффективный угловой коэффициент жёсткости для данного
        элемента, зависящий от внутренней структуры его солитона в Среде.
\end{itemize}

Тогда полный геометрический функционал молекулы можно схематично записать как
\[
F_{\text{mol}} \;=\;
\sum_{\text{атомы }Z} F_{\text{geom}}(Z)
\;+\;
\sum_{\text{углы }(Z,i)} F_{\text{angle}}(Z;\theta_i)
\;+\;\dots,
\]
где многоточие обозначает другие вклады (растяжение связей, торсионные
деформации, спектральные эффекты и т.\,п.).

Сама по себе портовая геометрия задаёт предпочтительную фигуру
(линейную, тетраэдрическую, пирамидальную и т.\,д.), а
$F_{\text{angle}}$ измеряет, насколько сильно конкретная молекула
вынуждена эту фигуру деформировать. Рост $F_{\text{angle}}$ можно
интерпретировать как рост внутреннего напряжения и потенциальной
энергии, связанной именно с углами.

\subsubsection*{Пример: циклопропан как предельный случай
углового напряжения}

Хорошей тестовой площадкой для углового функционала служат маленькие
циклы. Рассмотрим, например, циклопропан: кольцо из трёх углеродных
атомов $\mathrm{C}_3$. В первом приближении геометрия кольца близка
к правильному треугольнику: все углы C--C--C близки к $60^\circ$.

С точки зрения портовой геометрии углерода, изолированный атом C имеет
четыре порта в тетраэдрической конфигурации, и его любимый угол
между связями $\theta_0(\mathrm{C})\approx 109.5^\circ$.
В линейных и разветвлённых структурах Среда может разместить эти порты
почти тетраэдрически, сохраняя малое $F_{\text{angle}}$.

Однако в циклопропане каждый углеродный центр в кольце должен
участвовать в образовании двух C--C--связей, образующих угол порядка
$60^\circ$. С точки зрения описанного выше углового функционала
\[
\Delta \theta_{\mathrm{C}_3} \;\approx\;
60^\circ - 109.5^\circ \;\approx\; -49.5^\circ,
\]
и вклад в угловую энергию для \emph{каждого} центра C оценивается как
\[
F_{\text{angle}}(\mathrm{C}_3) \;\sim\;
k_{\mathrm{C}} \bigl(\Delta\theta_{\mathrm{C}_3}\bigr)^2,
\]
то есть все три углеродных узла испытывают крупное отклонение от
своей тетраэдрической фигуры портов.

В терминах Среды это означает, что конфигурация солитонов, реализующая
циклопропановое кольцо, несёт значительное геометрическое напряжение:
порты углерода вынуждены группироваться существенно плотнее, чем это
оптимально для минимизации $F_{\text{geom}}$.
Рост $F_{\text{angle}}$ даёт естественную геометрическую интерпретацию
химического ``напряжения цикла'' и повышенной реакционной способности
таких маленьких колец.

\subsubsection*{Сравнение с большими циклами}

Для сравнения, в четырёх- и шестичленных циклах типичные углы
ближе к тетраэдрической конфигурации атома углерода:
\begin{itemize}
  \item в идеализированном $\mathrm{C}_4$-цикле (квадрат)
        углы $\approx 90^\circ$, что уже значительно ближе к
        $109.5^\circ$, чем $60^\circ$;
  \item в шестичленном кольце (плоский гексагон) углы $\approx 120^\circ$,
        ещё ближе к тетраэдрическому значению, особенно с учётом возможных
        трёхмерных деформаций (скамья, кресло).
\end{itemize}
В модели это соответствует убыванию углового вклада
$F_{\text{angle}}$ при росте размера кольца:
чем ближе фактические углы к любимому $\theta_0(Z)$, тем меньше
геометрическое напряжение и тем дешевле по $F_{\text{geom}}$ реализовать
данную молекулярную конфигурацию.

Таким образом, угловой функционал $F_{\text{angle}}$ служит мостом между
портовой геометрией изолированных солитонов и привычными химическими
понятиями \emph{напряжённых циклов}, \emph{энергии деформации} и
\emph{углового напряжения}. Вся геометрическая ``химия напряжения''
в этой картине сводится к систематическому учёту того, насколько
далеко конкретная молекула заставляет свои атомы уйти от их любимых
фигур портов и углов.

\section{Черновики: геометрические роли элементов и периодичность}
\label{sec:drafts-roles-periodicity}

В предыдущих разделах были введены геометрический функционал атома
$F_{\text{geom}}(Z)$, число портов $p_Z$, энергия порта
$E_{\text{port}}(Z)$, а также портовая геометрия
$\operatorname{geom}(Z)$ и характерный угол $\theta_0(Z)$.
Эти величины задают локальную структуру солитона Среды,
соответствующего атому $Z$.

На следующем шаге удобно ввести более грубую категориальную
классификацию элементов --- \emph{геометрические роли} атомов
в сетях Среды. Эта классификация позволяет читать периодическую
структуру не только как спектральную (по $Z$), но и как
сетевую (по типам узлов в возникающих конфигурациях).

\subsection*{Геометрические роли: inert, terminator, bridge, hub}

Будем выделять четыре базовые геометрические роли атомов на основе
числа портов $p_Z$, их геометрии и энергии порта $E_{\text{port}}(Z)$:
\begin{itemize}
  \item \textbf{inert} --- атомы без портов ($p_Z = 0$).
    В спектрально--геометрическом описании это замкнутые, геометрически
    минимальные конфигурации: любые связи требуют открытия портов
    и роста $F_{\text{geom}}$. Примеры: He, Ne, Ar.
  \item \textbf{terminator} --- атомы с одним портом ($p_Z = 1$).
    Они естественным образом занимают концевые позиции в цепях и кластерах.
    При крупном $E_{\text{port}}$ такой порт ведёт себя как ``жёсткий
    акцептор'' (например, F, Cl), при меньшем $E_{\text{port}}$ ---
    как мягкий донор/терминатор (H, Li, Na).
  \item \textbf{bridge} --- атомы с двумя портами ($p_Z = 2$)
    и линейной или изгибной портовой геометрией (linear, bent).
    Они реализуют отрезки цепей и ``перемычки'' между узлами сети,
    допуская либо почти линейную ($\theta_0 \approx 180^\circ$),
    либо сильно изогнутую ($\theta_0 \approx 104^\circ$) конфигурацию.
    Примеры: Be, Mg (linear); O, S (bent).
  \item \textbf{hub} --- атомы с тремя и более портами ($p_Z \ge 3$).
    Это центры ветвления и узлы сетей. Их портовая геометрия может быть
    плоской (trigonal) или объёмной (tetra, pyramidal), задавая
    характерные мотивы связей. Примеры: B, C, N, Al, Si, P.
\end{itemize}

Такая классификация является грубой, но в контексте Среды она естественно
отражает сетевую функцию солитона: инертные элементы экранируют
и замыкают конфигурации, терминаторы задают концы ветвей, мостики
сшивают участки, а хабы формируют ветвления и ядра кластеров.

\subsection*{Второй и третий период как повторяющийся геометрический мотив}

Для элементов второго периода Li--Ne геометрический паспорт можно
схематично записать в виде:
\begin{center}
\begin{tabular}{c c c c c}
\hline
Эл. & $Z$ & $p_Z$ & $\operatorname{geom}(Z)$ & роль \\
\hline
Li & 3  & 1 & single   & terminator \\
Be & 4  & 2 & linear   & bridge \\
B  & 5  & 3 & trigonal & hub \\
C  & 6  & 4 & tetra    & hub \\
N  & 7  & 3 & pyramidal& hub \\
O  & 8  & 2 & bent     & bridge \\
F  & 9  & 1 & single   & terminator \\
Ne & 10 & 0 & none     & inert \\
\hline
\end{tabular}
\end{center}

Третий период Na--Ar в геометрической таблице естественно читается как
повторение того же мотива на следующей радиальной оболочке Среды:
\begin{center}
\begin{tabular}{c c c c c}
\hline
Эл. & $Z$ & $p_Z$ & $\operatorname{geom}(Z)$ & роль \\
\hline
Na & 11 & 1 & single   & terminator \\
Mg & 12 & 2 & linear   & bridge \\
Al & 13 & 3 & trigonal & hub \\
Si & 14 & 4 & tetra    & hub \\
P  & 15 & 3 & pyramidal& hub \\
S  & 16 & 2 & bent     & bridge \\
Cl & 17 & 1 & single   & terminator \\
Ar & 18 & 0 & none     & inert \\
\hline
\end{tabular}
\end{center}

Число портов, тип портовой геометрии и геометрическая роль для Na--Ar
повторяют структуру Li--Ne:
\[
\begin{aligned}
\text{Li} &\leftrightarrow \text{Na} & (1~\text{порт},~\text{terminator}),\\
\text{Be} &\leftrightarrow \text{Mg} & (2~\text{порта},~\text{bridge, linear}),\\
\text{B}  &\leftrightarrow \text{Al} & (3~\text{порта},~\text{hub, trigonal}),\\
\text{C}  &\leftrightarrow \text{Si} & (4~\text{порта},~\text{hub, tetra}),\\
\text{N}  &\leftrightarrow \text{P}  & (3~\text{порта},~\text{hub, pyramidal}),\\
\text{O}  &\leftrightarrow \text{S}  & (2~\text{порта},~\text{bridge, bent}),\\
\text{F}  &\leftrightarrow \text{Cl} & (1~\text{порт},~\text{terminator}),\\
\text{Ne} &\leftrightarrow \text{Ar} & (0~\text{портов},~\text{inert}).\\
\end{aligned}
\]

В таком виде периодический закон в Среде формулируется
не только как повторяемость спектров, но и как повторяемость
сетевых ролей и портовой геометрии: каждый новый период воспроизводит
тот же набор ролей (terminator $\to$ bridge $\to$ hub $\to$ hub
$\to$ hub $\to$ bridge $\to$ terminator $\to$ inert), но на новой
пространственной и спектральной шкале солитонного ядра.

\subsection*{Сетевой взгляд: строение структур Среды из геометрических ролей}

В терминах введённых ролей строение сложных конфигураций Среды можно
описывать как композицию типовых мотивов:
\begin{itemize}
  \item цепочки вида hub--bridge--hub реализуют базовые фрагменты
        сетей (например, C--C--C, Si--O--Si);
  \item hub--bridge--terminator задают ветви, заканчивающиеся
        ``висящими'' группами (CH$_3$, OH, Cl и т.\,п.);
  \item блоки вида hub--bridge--hub--bridge--hub позволяют строить
        двумерные и трёхмерные каркасы (углеродные и кремниевые сети);
  \item inert-атомы (Ne, Ar) выступают в роли естественных ``пробок''
        и экранирующих центров, внося локальные геометрические минимумы
        $F_{\text{geom}}$ без портов.
\end{itemize}

Такая картина подчёркивает, что геометрическая таблица элементов
описывает не только набор возможных локальных солитонов Среды, но и
набор сетевых ``кирпичей'', из которых складываются устойчивые
структуры. Периодичность по $Z$ в этом смысле есть проявление
повторяющейся фрактальной архитектуры Среды: на каждой новой шкале
(новый период) воспроизводится тот же ``алфавит ролей'', но с
дополнительными внутренними степенями свободы ядра.

\section{Черновики: геометрическая электроотрицательность}
\label{sec:drafts-geom-electronegativity}

Классическое понятие электроотрицательности (в частности, шкала Полинга)
описывает ``жадность'' атома к электронной плотности: насколько сильно
он притягивает к себе электронную долю связи. В стандартной
квантово--химической формулировке электроотрицательность выражается через
энергии связей и ионизации; в спектрально--геометрической модели
Среды естественно построить аналогичный объект на уровне портовой
геометрии.

\subsection*{Геометрическая электроотрицательность как функция порта}

Введём \emph{геометрическую электроотрицательность} $\chi_{\text{geom}}(Z)$
как эффективную меру ``напряжения'' портовой структуры атома $Z$,
которая стремится быть снята за счёт захвата или отдачи электронной
плотности. На уровне первых приближений можно считать, что вклад
каждого порта задаётся геометрической энергией порта $E_{\text{port}}(Z)$,
а знак (донор/акцептор) определяется ролью элемента в сетях.

Схематически:
\[
\chi_{\text{geom}}(Z) \sim
s(Z)\,\cdot E_{\text{port}}(Z),
\]
где $E_{\text{port}}(Z) = F_{\text{geom}}(Z)/p_Z$ при $p_Z>0$, а
$s(Z)$ --- знаковый фактор, зависящий от роли:
\begin{itemize}
  \item для \textbf{акцепторных terminator}--элементов (F, Cl и им подобных) $s(Z)>0$;
  \item для \textbf{донорных terminator}--элементов (Li, Na и т.\,п.) $s(Z)<0$;
  \item для \textbf{hub} и \textbf{bridge} элементы разбивают вклад на
        эффективную величину по портам, где знак и величина $s(Z)$
        дополнительно зависят от спектрального окружения (относительного
        положения локальных уровней солитона и фонового спектра Среды).
\end{itemize}

В таком чтении $E_{\text{port}}(Z)$ даёт модуль геометрического
``голода'' порта, а роль и спектральная конфигурация определяют, будет ли
этот голод реализован как притягивание электронов (акцептор) или как
их отдача (донор).

\subsection*{Качественное сопоставление с классической шкалой для H--Cl}

Если рассмотреть элементы H--Cl в геометрической таблице, то
получается следующая картина:
\begin{itemize}
  \item элементы He, Ne, Ar имеют $p_Z=0$ и роль \texttt{inert}:
        для них $\chi_{\text{geom}}$ естественно считать нулевой или
        не определённой --- они реализуют локальные геометрические минимумы
        без портов;
  \item F и Cl --- однопортовые \texttt{terminator} с максимальными
        $E_{\text{port}}$ в своих периодах и асимметричной внутренней
        структурой: их единственный порт геометрически самый дорогой;
        это согласуется с тем, что именно F и Cl в стандартной химии
        имеют наибольшую электроотрицательность в своих периодах;
  \item O и N --- многопортовые \texttt{hub}/\texttt{bridge} с умеренно
        высокими $E_{\text{port}}$ и сильно направленной портовой
        геометрией (bent и pyramidal), что соответствует большой, но
        меньшей, чем у F/Cl, электроотрицательности;
  \item C и Si --- \texttt{hub} с четырьмя портами в тетраэдрической
        конфигурации, для которых $E_{\text{port}}$ минимально среди
        элементов с портами: они выступают как структурные центры
        сетей с умеренной $\chi_{\text{geom}}$;
  \item Li и Na --- однопортовые \texttt{terminator}, для которых
        геометрический порт достаточно дорог (большое $E_{\text{port}}$),
        но спектральная конфигурация смещена так, что выгоднее
        отдавать электронную плотность в Среду, чем забирать её.
        В этом смысле $\chi_{\text{geom}}$ для них имеет тот же модуль,
        что и у акцепторных terminator, но противоположный знак.
\end{itemize}

Таким образом, геометрическая модель естественно воспроизводит
качественное разделение элементов на:
\begin{itemize}
  \item сильные акцепторы (F, Cl) с высокими $E_{\text{port}}$ и
        положительной $\chi_{\text{geom}}$;
  \item активные, но менее ``жадные'' акцепторы (O, N, S и т.\,п.) с
        промежуточными значениями $\chi_{\text{geom}}$;
  \item умеренные центры сетей (C, Si, P), для которых порты
        геометрически ``дешёвы'';
  \item доноры--terminator (Li, Na), у которых ``голод порта'' реализуется
        в сторону отдачи электронной плотности.
\end{itemize}

Численные значения классической электроотрицательности (например,
шкала Полинга) в этой картине соответствуют уже конкретной выборке
функции $\chi_{\text{geom}}(Z)$ с учётом деталей спектральной части
модели. На уровне текущих черновиков достаточно, что:
\begin{enumerate}
  \item геометрический функционал $F_{\text{geom}}$ и энергия порта
        $E_{\text{port}}$ выделяют F и Cl как элементы с аномально
        напряжёнными портами;
  \item порты C и Si получаются геометрически самыми ``дешёвыми'' среди
        многопортовых элементов, что согласуется с их ролью универсальных
        строителей сетей;
  \item инертные газы реализуют геометрические минимумы без портов.
\end{enumerate}

Дальнейшая работа с геометрической электроотрицательностью заключается
в конкретном выборе нормировки и знаковой функции $s(Z)$ так, чтобы
$\chi_{\text{geom}}(Z)$ количественно согласовывалась с экспериментальными
данными для выбранных классов элементов, оставаясь при этом разложённой
на прозрачные геометрические и спектральные вклады.

\section{Черновики: знаковая геометрическая электроотрицательность}
\label{sec:drafts-geom-electronegativity-signed}

В геометрической версии электроотрицательности $\chi_{\text{geom}}(Z)$
модуль ``жадности'' порта задаётся геометрической энергией порта
$E_{\text{port}}(Z)$, тогда как направление потока (донор/акцептор)
должно определяться спектральным положением уровней атома относительно
Среды.

В рамках простейшей игрушечной модели каждому солитону $Z$ сопоставляется
один эффективный параметр $\varepsilon_Z$, описывающий положение
его характерного уровня относительно некоторого химического потенциала
Среды $\mu_{\text{env}}$:
\[
  \varepsilon_Z \gg \mu_{\text{env}}
  \;\Rightarrow\;
  Z \text{ ведёт себя как донор (уровень легко отдаёт электрон)},
\]
\[
  \varepsilon_Z \ll \mu_{\text{env}}
  \;\Rightarrow\;
  Z \text{ ведёт себя как акцептор (уровень охотно забирает электрон)}.
\]

Тогда естественно ввести два варианта геометрической электроотрицательности:
\begin{itemize}
  \item модульную величину
  \[
    |\chi_{\text{geom}}(Z)| \propto E_{\text{port}}(Z),
  \]
  характеризующую силу локального ``голода'' порта независимо от его знака;
  \item знаковую величину
  \[
    \chi_{\text{geom}}^{\text{sgn}}(Z)
    \;=\;
    s(Z)\,|\chi_{\text{geom}}(Z)|,
  \]
  где знак $s(Z)$ определяется положением $\varepsilon_Z$ по отношению к
  $\mu_{\text{env}}$:
  \[
    s(Z) =
    \begin{cases}
      +1, & \varepsilon_Z \ll \mu_{\text{env}} \quad\text{(акцептор)},\\[3pt]
      -1, & \varepsilon_Z \gg \mu_{\text{env}} \quad\text{(донор)},\\[3pt]
      0,  & |\varepsilon_Z - \mu_{\text{env}}| \lesssim \delta
             \quad\text{(структурный центр)}.
    \end{cases}
  \]
\end{itemize}

В численной игрушечной реализации для элементов H--Ar параметр
$\varepsilon_Z$ задаётся феноменологически: Li, Na, Mg, Al получают
$\varepsilon_Z > 0$ и интерпретируются как доноры, F, Cl, O, S, N
получают $\varepsilon_Z < 0$ и ведут себя как акцепторы, а C, Si, B
располагаются вблизи $\varepsilon_Z \approx \mu_{\text{env}}$ и играют
роль в первую очередь структурных центров сетей.

При этом модульная величина $|\chi_{\text{geom}}(Z)|$ сохраняет
свою связь с геометрией портов: элементы с максимально напряжёнными
портами (F, Cl) имеют наибольшие значения $E_{\text{port}}$ и, следовательно,
максимальный модуль геометрической электроотрицательности, тогда как
многопортовые структурные центры (C, Si) характеризуются относительно
дешёвыми портами и меньшим модулем $|\chi_{\text{geom}}|$.

Таким образом, в сочетании с спектральным параметром $\varepsilon_Z$
геометрический функционал $F_{\text{geom}}$ задаёт не только силу, но и
направление эффективной электроотрицательности: один и тот же высокий
модуль $|\chi_{\text{geom}}|$ для Li и F соответствует в одном случае
донорному, а в другом акцепторному поведению, что согласуется с
классической картиной химии, но при этом остаётся разложённым на
прозрачные геометрические и спектральные вклады.

\section{Черновики: тестовые молекулы CH$_4$, NH$_3$, H$_2$O}
\label{sec:drafts-test-molecules}

В предыдущих черновых разделах портовая геометрия атомов C, N и O
была зафиксирована как тетраэдрическая (\texttt{tetra}),
пирамидальная (\texttt{pyramidal}) и изогнутая (\texttt{bent})
соответственно, с характерными ``любимыми'' углами
\[
  \theta_0(\mathrm{C}) \approx 109.5^\circ,\quad
  \theta_0(\mathrm{N}) \approx 107^\circ,\quad
  \theta_0(\mathrm{O}) \approx 104^\circ.
\]
Теперь рассмотрим, как эти портовые фигуры проявляются в простейших
молекулах CH$_4$, NH$_3$ и H$_2$O, и как в их геометрии отражаются
угловой функционал и геометрическая электроотрицательность.

\subsection*{CH$_4$: тетраэдрический хаб без углового напряжения}

В модели атом углерода описывается четырёхпортовым хабом
с геометрией \texttt{tetra} и любимым углом $\theta_0(\mathrm{C})$.
В молекуле CH$_4$ все четыре порта C используются для связей C--H, и
Среда может сформировать конфигурацию, практически совпадающую
с изолированным тетраэдром:

\begin{itemize}
  \item углы H--C--H близки к $109.5^\circ$;
  \item для каждого угла $\theta_i$ выполняется
        $\theta_i \approx \theta_0(\mathrm{C})$, так что вклад
        $F_{\text{angle}}(\mathrm{C};\{\theta_i\})$ минимален;
  \item геометрический функционал молекулы
        $F_{\text{mol}}$ почти целиком определяется
        локальными $F_{\text{geom}}(\mathrm{C})$ и $F_{\text{geom}}(\mathrm{H})$,
        без существенного углового напряжения.
\end{itemize}

В этом смысле CH$_4$ реализует почти идеальный тетраэдрический хаб:
портовая геометрия C используется в ``любимом'' режиме, а H выступают
как мягкие терминаторы, не накладывающие дополнительных геометрических
ограничений.

\subsection*{NH$_3$: пирамидальный хаб с мягким угловым напряжением}

Для азота в геометрической таблице зафиксирована портовая
геометрия \texttt{pyramidal}: три химических порта и один
виртуальный (направление, занятое внутренней структурой), что
соответствует ``тетраэдру минус один порт'' и углу
$\theta_0(\mathrm{N}) \approx 107^\circ$.

В молекуле NH$_3$ три порта N используются для связей N--H, а
виртуальное направление реализуется как lone pair. В результате:

\begin{itemize}
  \item фактические углы H--N--H близки к $107^\circ$, то есть
        чуть меньше тетраэдрического значения;
  \item угловой функционал для азота мал, но уже отличен от нуля:
        \[
          F_{\text{angle}}(\mathrm{N};\{\theta_i\})
          \sim k_{\mathrm{N}}\sum_i (\theta_i - \theta_0(\mathrm{N}))^2;
        \]
  \item по сравнению с CH$_4$ портовая конфигурация N менее
        равномерна: наличие lone pair усиливает локальную асимметрию
        спектрального поля, что согласуется с повышенной
        полярностью и реакционной способностью NH$_3$.
\end{itemize}

Таким образом, NH$_3$ можно рассматривать как реализацию
пирамидального хаба: Среда использует три порта N вблизи
любимых углов, но уже с заметной асимметрией и небольшим
угловым напряжением.

\subsection*{H$_2$O: изогнутый мост с выраженным угловым напряжением}

В геометрической таблице кислород описывается как двухпортовый
\texttt{bridge} с геометрией \texttt{bent} и любимым углом
$\theta_0(\mathrm{O}) \approx 104^\circ$, возникающим как ``тетраэдр
минус два порта''. Два активных направления сопровождаются двумя
виртуальными (lone pairs).

В молекуле воды H$_2$O оба порта O используются для связей O--H.
С точки зрения углового функционала:

\begin{itemize}
  \item угол H--O--H близок к $104^\circ$, то есть ещё дальше
        от идеального тетраэдра, чем в случае NH$_3$;
  \item внутреннее угловое напряжение в подпространстве порта
        кислорода больше, чем у азота: тетраэдрическая фигура
        сильнее ``урезана'' (две пары виртуальных направлений);
  \item геометрическая электроотрицательность
        $\chi_{\text{geom}}(\mathrm{O})$ относительно высока,
        а оба порта направлены в одну сторону, что делает
        молекулу воды сильно полярной: захват электронной
        плотности по обоим направлениям совпадает по ориентации
        портов и даёт выраженный диполь.
\end{itemize}

Сочетание (i) заметного углового напряжения в тетраэдрической
портовой фигуре O и (ii) высокой $\chi_{\text{geom}}$ по модулю
объясняет, почему вода одновременно имеет большой диполь и
значительные угловые барьеры при деформации связей H--O--H.

\subsection*{Сводка: от атомной портовой геометрии к молекулярной форме}

На уровне этих трёх тестовых молекул можно проследить простую
цепочку:

\begin{itemize}
  \item C: полный тетраэдр портов $\Rightarrow$ CH$_4$ с практически
        нулевым угловым напряжением и симметричной формой;
  \item N: тетраэдр минус один порт $\Rightarrow$ NH$_3$ с мягким
        угловым напряжением и пирамидальной геометрией;
  \item O: тетраэдр минус два порта $\Rightarrow$ H$_2$O с более
        сильным угловым напряжением и изогнутой геометрией.
\end{itemize}

В каждом случае молекулярная форма не постулируется отдельно, а
следует из портовой геометрии атома (тип фигуры, число виртуальных
портов) и минимизации суммарного функционала
$F_{\text{mol}} = \sum F_{\text{geom}} + \sum F_{\text{angle}}$.
Тот же аппарат, будучи развит количественно, должен позволять
описывать и более сложные молекулы и сети как конфигурации,
наиболее экономно реализующие набор любимых фигур портов и углов
для входящих в них элементов.

\section{Черновики: спектральный вклад \texorpdfstring{$F_{\text{spec}}$}{F\_spec}}
\label{sec:drafts-Fspec}

До сих пор основное внимание уделялось чисто геометрическому слою
модели: портовой структуре атомов, геометрическому функционалу
$F_{\mathrm{geom}}$, энергии порта $E_{\mathrm{port}}$ и угловому
вкладу $F_{\mathrm{angle}}$. В спектральной онтологии Среды этого
недостаточно: геометрия задаёт ``каркас'' конфигурации, но
направление и величина потоков (донорство/акцепторство, устойчивость
уровней) определяются спектральной частью --- положением и формой
спектра солитона относительно фонового спектра Среды.

В общем случае спектральный вклад для данного атома $Z$ можно
представить в виде функционала от его локальной DOS
$\rho_Z(\omega)$:
\[
  F_{\mathrm{spec}}(Z)
  = \int W_Z(\omega)\,\rho_Z(\omega)\,d\omega,
\]
где $W_Z(\omega)$ --- весовая функция, выделяющая спектральные
области, отвечающие за химически активные уровни (валентные и
ближние к ним состояния). В более развитой версии модели сюда
входит также химический потенциал Среды $\mu_{\mathrm{env}}$ и
штраф за смещение эффективных уровней солитона относительно
$\mu_{\mathrm{env}}$ при образовании связей.

В минималистской игрушечной постановке вместо полного спектра
можно использовать один эффективный параметр $\varepsilon_Z$ ---
``предпочтительное положение'' валентного уровня солитона $Z$.
Тогда спектральный вклад для изолированного атома можно записать как
\[
  F_{\mathrm{spec}}^{\mathrm{toy}}(Z)
  = \lambda_{\mathrm{spec}}\,
    \bigl(\varepsilon_Z - \mu_{\mathrm{env}}\bigr)^2,
\]
где $\lambda_{\mathrm{spec}}$ --- калибровочный коэффициент,
а $\mu_{\mathrm{env}}$ --- параметр, характеризующий фоновое
спектральное состояние Среды. В таком описании донорный характер
элемента (Li, Na и т.п.) соответствует высоким $\varepsilon_Z$
(уровень ``подвешен'' и его выгодно отдать), а акцепторный характер
(F, Cl и др.) --- низким $\varepsilon_Z$ (уровень ``провален'' и
выгодно захватывать электронную плотность).

Геометрическая электроотрицательность $\chi_{\mathrm{geom}}(Z)$
в этом контексте может быть разложена на модуль и знак:
модуль задаётся геометрическим голодом порта
(через $E_{\mathrm{port}}(Z)$), а знак и тонкая структура ---
положением $\varepsilon_Z$ относительно $\mu_{\mathrm{env}}$ и
спектральным окружением. В полном функционале для атома или
молекулы
\[
  F_{\mathrm{tot}}
  = F_{\mathrm{geom}} + F_{\mathrm{angle}} + F_{\mathrm{spec}} + \dots
\]
геометрический и спектральный вклады должны рассматриваться совместно:
геометрия задаёт допустимые каркасы и портовые фигуры, спектр ---
их заполнение и эффективное направление потоков (донорство/акцепторство,
устойчивость уровней, наличие резонансов).

На уровне v0.1 параметр $\varepsilon_Z$ и явный вид
$F_{\mathrm{spec}}$ остаются в статусе черновой гипотезы. Их задача ---
служить мостом между уже реализованным геометрическим слоем и
будущей спектральной надстройкой, в которой DOS/LDOS и функции Грина
будут использоваться напрямую для количественного описания
электроотрицательности, донорства и других химических характеристик.

\section{Черновики: численная оценка углового напряжения для CH$_4$, NH$_3$, H$_2$O}

В качественном разборе молекул CH$_4$, NH$_3$ и H$_2$O портовая
геометрия C, N и O трактовалась как ``полный тетраэдр'' (четыре порта),
``тетраэдр минус один порт'' (три порта + lone pair) и ``тетраэдр
минус два порта'' (два порта + две пары) соответственно. Для
количественной игрушечной оценки внутреннего углового напряжения
удобно ввести sp$^3$-функционал для атома $Z$:
\begin{equation}
  F_{\text{angle,sp3}}(Z)
  \;\approx\;
  k_{\text{angle}} \cdot n_{\text{virt}}(Z)\,
  \bigl(\theta_{\text{base}} - \theta_0(Z)\bigr)^2,
\end{equation}
где
\begin{itemize}
  \item $\theta_{\text{base}} = 109{,}5^\circ$ --- базовый тетраэдрический угол;
  \item $\theta_0(Z)$ --- любимый угол порта для данного элемента
        (для C, N, O в версии v0.1:
        $\theta_0 \approx 109{,}5^\circ, 107^\circ, 104^\circ$);
  \item $n_{\text{virt}}(Z) = \max(0, 4 - p_Z)$ --- число виртуальных
        портов (насколько ``урезан'' полный тетраэдр по числу активных
        портов);
  \item $k_{\text{angle}}$ --- небольшой коэффициент нормировки.
\end{itemize}

В коде \texttt{geom\_atoms.py} этот функционал реализован методом
\texttt{angular\_tension\_sp3()} класса \texttt{Molecule}. Для молекул
CH$_4$, NH$_3$ и H$_2$O строятся простые графы:
\begin{itemize}
  \item CH$_4$: один C-хаб и четыре H-терминатора (связи C--H);
  \item NH$_3$: один N-хаб и три H-терминатора (связи N--H);
  \item H$_2$O: один O-bridge и два H-терминатора (связи O--H).
\end{itemize}
Угловое напряжение берётся только на тех атомах, у которых число связей
больше единицы и определён любимый угол (в этом приближении --- только
на C, N и O).

При типичных параметрах (например, $\theta_{\text{base}}=109{,}5^\circ$,
$k_{\text{angle}}=0{,}01$) и текущем наборе прототипов модель даёт
характерную картину:
\begin{equation}
  F_{\text{angle,sp3}}(\text{CH}_4) \approx 0,\qquad
  F_{\text{angle,sp3}}(\text{NH}_3) \ll
  F_{\text{angle,sp3}}(\text{H}_2\text{O}).
\end{equation}
Более подробно,
\begin{equation}
  F_{\text{angle,sp3}}(\text{CH}_4) \approx 0,
  \quad
  F_{\text{angle,sp3}}(\text{NH}_3) \propto
    1 \cdot (109{,}5^\circ - 107^\circ)^2,
  \quad
  F_{\text{angle,sp3}}(\text{H}_2\text{O}) \propto
    2 \cdot (109{,}5^\circ - 104^\circ)^2.
\end{equation}

То есть:
\begin{itemize}
  \item у CH$_4$ полная тетраэдрическая фигура C используется в
        ``любимом'' режиме, и угловое напряжение практически нулевое;
  \item у NH$_3$ один порт заменён виртуальным направлением (lone pair),
        и тетраэдрическая фигура N слегка деформирована: один
        виртуальный порт и небольшой сдвиг угла с 109{,}5$^\circ$ до
        $\sim 107^\circ$;
  \item у H$_2$O два порта заменены виртуальными направлениями, и
        деформация относительно базового тетраэдра значительно больше:
        два виртуальных порта и заметный сдвиг угла до $\sim 104^\circ$.
\end{itemize}

Такая численная игрушка поддерживает качественный тезис: вода в
портово--геометрической модели несёт в себе существенно больше
внутреннего углового напряжения, чем аммиак, а метан практически
реализует свободный от напряжения тетраэдрический центр. При этом всё
напряжение выражено через локальные параметры атомов (число портов
$p_Z$ и любимые углы $\theta_0(Z)$), без прямого обращения к
стандартным квантово--химическим моделям гибридизации.

 % ==========================
 % ЧАСТЬ VI. ПРОГРАММНЫЙ КОМПЛЕКС
% ==========================
\section{Общая структура программного комплекса}
\label{sec:software-arch}

Программный комплекс служит \emph{исполнителем} всех определений,
введённых в предыдущих частях. Его задача --- по заданному набору
параметров конфигурации $\theta$ и фоновой Среде:

\begin{itemize}
  \item построить дискретизацию пространства $X$ и, при необходимости,
        частотной оси $\omega$;
  \item задать фоновую спектральную плотность
        $\rho_{\mathrm{spec}}^{(0)}(\omega,x)$ и локальные
        возмущения $\delta\rho_{\mathrm{spec}}(\omega,x;\theta)$;
  \item построить оператор малых колебаний $\hat H[\theta]$;
  \item вычислить DOS и LDOS, а затем функционалы
        $F_{\mathrm{levels}}[\theta]$ и $F_{\mathrm{geom}}[G_\theta]$;
  \item при необходимости --- оценить эффективную массу
        $M_{\mathrm{sol}}[\theta]$ и гравитационное поле
        $\mathbf g(x;\theta)$;
  \item выполнить оптимизацию по $\theta$ (поиск минимумов
        функционалов) и выдать результаты в пригодном для анализа
        и визуализации формате.
\end{itemize}

На уровне архитектуры комплекс логически делится на следующие подсистемы:

\begin{enumerate}
  \item \textbf{Ядро данных и конфигураций.}
        \begin{itemize}
          \item Представление геометрии графа/узла $G_\theta$
                (вершины, рёбра, топологические метки).
          \item Параметры конфигурации $\theta$ (масштабы, углы,
                деформации, типы связей).
          \item Описание фоновой Среды и граничных условий.
        \end{itemize}

  \item \textbf{Модуль спектральной среды и гравитации}
        (см. раздел~\ref{sec:module-env}).
        Отвечает за работу с $\rho_{\mathrm{spec}}$, $I_{\mathrm{grav}}$,
        спектральным потенциалом $\phi$ и гравитационным полем
        $\mathbf g$.

  \item \textbf{Модуль оператора H и DOS/LDOS}
        (см. раздел~\ref{sec:module-H}).
        Строит дискретизированный оператор $\hat H[\theta]$, вычисляет
        DOS и LDOS, предоставляет интерфейсы для обращения оператора
        (функции Грина).

  \item \textbf{Модуль функционалов.}
        Содержит реализации $F_{\mathrm{levels}}$, $F_{\mathrm{geom}}$,
        $F_{\mathrm{atom}}$, а также энергетического и массового
        функционалов.

  \item \textbf{Модуль оптимизации и интегралов}
        (см. раздел~\ref{sec:module-opt}).
        Реализует Symmetric Newton и другие методы, а также численное
        интегрирование по спектру и пространству.

  \item \textbf{Модуль ввода/вывода и визуализации.}
        Генерация отчётных файлов, экспорт сеток, графов и полей для
        внешних визуализаторов (3D-вид, карты LDOS, профили
        $\phi(x)$ и т.п.).
\end{enumerate}

В простейшем сценарии использования:

\begin{enumerate}
  \item Пользователь задаёт:
        \begin{itemize}
          \item тип конфигурации (например, прототип углерода),
          \item параметры сетки,
          \item настройки фоновой Среды,
          \item целевые спектральные уровни для $F_{\mathrm{levels}}$.
        \end{itemize}
  \item Ядро строит начальную конфигурацию $\theta^{(0)}$ и сетку.
  \item Модуль $\hat H$ строит оператор, вычисляет DOS/LDOS.
  \item Модуль функционалов возвращает значения
        $F_{\mathrm{levels}}[\theta^{(0)}]$,
        $F_{\mathrm{geom}}[G_{\theta^{(0)}}]$ и производные.
  \item Модуль оптимизации запускает итерационный процесс по $\theta$.
  \item По завершении оптимизации сохраняются:
        \begin{itemize}
          \item оптимальные параметры $\theta^\ast$,
          \item спектр, DOS/LDOS,
          \item поля $\phi(x)$ и $\mathbf g(x)$,
          \item геометрия графа $G_{\theta^\ast}$.
        \end{itemize}
\end{enumerate}


\section{Модуль спектральной среды и гравитации}
\label{sec:module-env}

Этот модуль реализует все операции с локальной спектральной плотностью
Среды и вытекающим из неё гравитационным полем.

\subsection*{Основные объекты данных}

\begin{itemize}
  \item \textbf{Сетка пространства} $X$:
        \begin{itemize}
          \item регулярная трёхмерная сетка (кубическая или прямоугольная),
                либо набор точек интереса;
          \item индексация ячеек и возможность быстрой адресации соседей.
        \end{itemize}

  \item \textbf{Сетка частот}:
        \begin{itemize}
          \item набор узлов $\{\omega_k\}$ в интересующем диапазоне,
                от низких (гравитационно-давленческих) до более высоких;
          \item возможны логарифмические или адаптивные шкалы.
        \end{itemize}

  \item \textbf{Фоновая спектральная плотность}
        $\rho_{\mathrm{spec}}^{(0)}(\omega_k, x_i)$.

  \item \textbf{Возмущения спектра} $\delta\rho_{\mathrm{spec}}$,
        индуцируемые солитонной конфигурацией $\theta$:
        \[
          \rho_{\mathrm{spec}}(\omega_k, x_i;\theta)
          =
          \rho_{\mathrm{spec}}^{(0)}(\omega_k, x_i)
          + \delta\rho_{\mathrm{spec}}(\omega_k, x_i;\theta).
        \]

  \item \textbf{Весовая функция} $\alpha_{\mathrm{grav}}(\omega_k)$
        для расчёта гравитационного вклада.
\end{itemize}

\subsection*{Базовые операции}

Модуль предоставляет функции:

\begin{enumerate}
  \item \texttt{compute\_I\_grav}:
        \[
          I_{\mathrm{grav}}(x_i;\theta)
          = \sum_k \alpha_{\mathrm{grav}}(\omega_k)\,
                  \rho_{\mathrm{spec}}(\omega_k,x_i;\theta)\,\Delta\omega_k.
        \]

  \item \texttt{compute\_phi}:
        \[
          \phi(x_i;\theta) = -\ln I_{\mathrm{grav}}(x_i;\theta) + C,
        \]
        где $C$ выбирается так, чтобы в среднем по объёму
        $\langle\phi\rangle = 0$ или соответствовал заданной нормировке.

  \item \texttt{compute\_g}:
        \[
          \mathbf g(x_i;\theta) = -\nabla\phi(x_i;\theta),
        \]
        используя конечные разности на сетке.

  \item \texttt{compute\_Poisson\_residual}:
        оценка остатка в эффективном уравнении Пуассона
        \[
          R_{\mathrm{P}}(x_i)
          =
          \Delta\phi(x_i;\theta) - 4\pi G_{\mathrm{eff}}\sigma(x_i;\theta),
        \]
        где $\sigma$ берётся из выбранной модели источников.
\end{enumerate}

\subsection*{Использование в версии v0.1}

На первом этапе достаточно:

\begin{itemize}
  \item задать простую фоновую конфигурацию
        $\rho_{\mathrm{spec}}^{(0)} = \text{const}$;
  \item моделировать $\delta\rho_{\mathrm{spec}}$ как
        локальные «ямы» и «бугры» вокруг солитона;
  \item проверять, что движение пробного тела в поле $\mathbf g$ даёт
        реалистичные ньютоновские орбиты и падение тел.
\end{itemize}


\section{Модуль оператора H и DOS/LDOS}
\label{sec:module-H}

Этот модуль отвечает за построение оператора малых колебаний
$\hat H[\theta]$ и вычисление спектральных характеристик.

\subsection*{Построение оператора}

В минимальной реализации:

\begin{itemize}
  \item $\hat H[\theta]$ дискретизуется на той же сетке, что и
        Среда;
  \item используется скалярный оператор вида
        \[
          \hat H[\theta] = -\nabla\cdot\!\big(c^2(\theta,x)\,\nabla\big),
        \]
        где $c(\theta,x)$ кодируется как поле на узлах/ячейках;
  \item в коде это разреженная матрица $H(\theta)$ с локальными связями
        (шаблон типа «5-точечный» или «7-точечный» оператор).
\end{itemize}

Модуль должен поддерживать:

\begin{itemize}
  \item разные граничные условия (периодические, поглощающие, жёсткие);
  \item удобное изменение $c(\theta,x)$ при изменении конфигурации
        $\theta$;
  \item быструю пересборку матрицы $H(\theta)$ или её части.
\end{itemize}

\subsection*{Спектральный анализ}

Для заданного $H(\theta)$ модуль реализует:

\begin{enumerate}
  \item \textbf{Явный спектр для малых задач.}
        \begin{itemize}
          \item Вычисление нескольких десятков/сотен собственных
                значений и собственных векторов (методы типа Lanczos).
          \item Использование этих данных для построения DOS как
                сглаженной суммы дельт-функций.
        \end{itemize}

  \item \textbf{DOS по функции Грина.}
        \begin{itemize}
          \item Для заданной частоты $\omega$ строится матрица
                $(\omega + \mathrm{i}\eta - H)^{-1}$ с малым
                затуханием $\eta$.
          \item DOS:
                \[
                  \rho(\omega;\theta)
                  \approx -\frac{1}{\pi}\Im\operatorname{Tr}
                  (\omega + \mathrm{i}\eta - H(\theta))^{-1}.
                \]
          \item Практически, след оценивается стохастически (random
                vectors) или через частичный спектральный разложение.
        \end{itemize}

  \item \textbf{LDOS.}
        \begin{itemize}
          \item Для выбранных точек $x_i$ требуется
                \[
                  \rho(\omega,x_i;\theta)
                  \approx -\frac{1}{\pi}\Im G(x_i,x_i;\omega+\mathrm{i}\eta),
                \]
                где $G$ — матричный элемент обратной матрицы.
          \item Реализуется через решение систем вида
                $(\omega + \mathrm{i}\eta - H)\mathbf u = \mathbf e_i$
                для нескольких $\omega$ и индексов $i$.
        \end{itemize}
\end{enumerate}

\subsection*{Интерфейс для функционалов}

Модуль $\hat H$ предоставляет функциональному модулю:

\begin{itemize}
  \item массивы частот $\omega_i(\theta)$ (явные уровни, если они
        вычислены);
  \item функции-обёртки:
        \texttt{DOS(omega, theta)},
        \texttt{LDOS(omega, x, theta)};
  \item при необходимости --- производные по параметрам $\theta$
        (для градиентных методов оптимизации).
\end{itemize}


\section{Оптимизация и интегралы}
\label{sec:module-opt}

Этот модуль реализует численные методы, необходимые для минимизации
функционалов и вычисления интегралов, входящих в определения энергий
и масс.

\subsection*{Постановка задачи оптимизации}

В общем виде требуется найти
\[
  \theta^\ast = \arg\min_{\theta\in\Theta} F_{\mathrm{target}}[\theta],
\]
где $F_{\mathrm{target}}$ может быть:

\begin{itemize}
  \item $F_{\mathrm{atom}}[\theta_Z]$ — при поиске геометрии атома;
  \item комбинация $F_{\mathrm{levels}}$ и $F_{\mathrm{geom}}$ для
        тестовых конфигураций;
  \item функционал энергии $E_{\mathrm{spec}}[\theta]$ и массы
        $M_{\mathrm{sol}}[\theta]$ при заданных ограничениях.
\end{itemize}

Модуль должен поддерживать:

\begin{itemize}
  \item задание начального приближения $\theta^{(0)}$;
  \item ограничение области допустимых параметров;
  \item остановку по критериям изменения $F$ и/или нормы шага.
\end{itemize}


\subsection*{Метод Symmetric Newton}

Основной рабочий метод --- дискретный вариант симметричного Ньютона
для задач, где аналитические производные недоступны.

Для одномерной иллюстрации:
\[
  F'(\theta) \approx \frac{F(\theta+\Delta) - F(\theta-\Delta)}{2\Delta},
\]
\[
  F''(\theta) \approx \frac{F(\theta+\Delta) - 2F(\theta)
                          + F(\theta-\Delta)}{\Delta^2},
\]
и шаг Ньютона
\[
  \theta_{\mathrm{new}}
  = \theta - \frac{F'(\theta)}{F''(\theta) + \varepsilon},
\]
где $\varepsilon$ защищает от деления на слишком малые значения.

Для многомерного случая:

\begin{itemize}
  \item градиент оценивается через симметричные конечные разности
        по каждой компоненте $\theta_k$;
  \item вместо полного гессиана может использоваться диагональное
        или квазиньютоновское приближение (BFGS, L-BFGS) на основе
        скалярных произведений;
  \item шаг ограничивается по норме (line search или trust region).
\end{itemize}

Практические рекомендации для v0.1:

\begin{itemize}
  \item начинать с малого числа параметров $\theta$ (масштаб, пара углов);
  \item использовать относительные приращения
        $\Delta_k = \epsilon\,|\theta_k| + \Delta_{\min}$;
  \item логировать последовательность $(\theta^{(n)},F^{(n)})$ для
        последующего анализа.
\end{itemize}


\subsection*{Интегралы по спектру и пространству}

Функционалы энергии и массы содержат интегралы по частоте и/или
пространству. В v0.1 достаточно стандартных схем:

\begin{itemize}
  \item по $\omega$ --- трапецоидное правило или гауссовы формулы
        на заранее выбранной сетке $\{\omega_k\}$;
  \item по $x$ --- суммы по узлам сетки или простые кубатурные формулы.
\end{itemize}

Фрактальный метод разложения (FDM) рассматривается как перспективное
расширение:

\begin{itemize}
  \item FDM особенно полезен для высокоразмерных интегралов по
        параметрам $\theta$ и по многомерным спектрам с фрактальной
        структурой;
  \item для включения FDM требуется отдельный модуль генерации
        фрактальных выборок и адаптивного уточнения;
  \item в текущей версии v0.1 FDM может быть реализован как
        экспериментальный блок для отдельных задач.
\end{itemize}

Модуль интегралов должен предоставлять единый интерфейс:

\begin{itemize}
  \item \texttt{integrate\_omega(f, grid\_omega, method)};
  \item \texttt{integrate\_space(f, grid\_x, method)};
  \item \texttt{integrate\_theta(f, domain\_theta, method)} --- на будущее.
\end{itemize}

Такая организация позволит постепенно переключаться с простых методов
на более продвинутые (FDM, адаптивные схемы), не меняя остальной код
программного комплекса.


% ==========================
% ЧАСТЬ VII. ДОРОЖНАЯ КАРТА И СТАТУС МОДЕЛИ
% ==========================

\section{Текущий охват модели (``зелёная зона'')}
\label{sec:status-green}

Под ``зелёной зоной'' будем понимать те элементы модели, которые уже
доведены до уровня рабочей численной реализации (пусть и в виде
упрощённых прототипов).

На момент версии v0.1 в зелёную зону входят:

\begin{itemize}
  \item \textbf{Статическая спектральная Среда.}
        \begin{itemize}
          \item Задание фоновой спектральной плотности
                $\rho_{\mathrm{spec}}^{(0)}(\omega,x)$ на сетке.
          \item Введение локальных возмущений
                $\delta\rho_{\mathrm{spec}}(\omega,x;\theta)$.
        \end{itemize}

  \item \textbf{Спектральный потенциал и гравитация.}
        \begin{itemize}
          \item Расчёт
                $I_{\mathrm{grav}}(x)$,
                $\phi(x) = -\ln I_{\mathrm{grav}}(x)$
                и поля $\mathbf g(x)=-\nabla\phi(x)$.
          \item Моделирование движения пробных тел в поле $\mathbf g$
                в ньютоновском приближении.
        \end{itemize}

  \item \textbf{Простые дискретные операторы $\hat H$.}
        \begin{itemize}
          \item 1D и 2D решётки осцилляторов,
                дискретизация оператора вида
                $-\nabla\cdot(c^2\nabla)$.
          \item Вычисление нескольких низших собственных частот и
                мод, построение игрушечной DOS.
        \end{itemize}

  \item \textbf{Symmetric Newton как рабочий оптимизатор.}
        \begin{itemize}
          \item Реализован и протестирован на задачах поиска
                экстремумов одномерных и маломерных функционалов.
          \item Используется для подгонки параметров простых
                спектральных моделей.
        \end{itemize}

  \item \textbf{Материаловедческий стенд.}
        \begin{itemize}
          \item Игрушечные модели ``насосов'', дефектов, локальных
                мод, карт LDOS на 2D-решётках.
          \item Возможность визуализации распределения амплитуд и
                локализации мод.
        \end{itemize}

  \item \textbf{Мини-таблица H--Ne как набор прототипов.}
        \begin{itemize}
          \item Зафиксированы геометрические прототипы для
                H, He, Li, Be, B, C, N, O, F, Ne.
          \item Описана связь этих прототипов с валентностью и
                инертностью на качественном уровне.
        \end{itemize}
\end{itemize}

Эта область уже пригодна для численных экспериментов, отладки кода и
первых сопоставлений с наблюдаемыми эффектами на качественном уровне.


\section{Незавершённые блоки (``жёлтая зона'')}
\label{sec:status-yellow}

Под ``жёлтой зоной'' понимаются элементы модели, для которых:

\begin{itemize}
  \item концептуальная схема и формулы уже заданы в этом документе;
  \item но реализация либо отсутствует, либо выполнена частично и
        требует доработок, тестирования и калибровки.
\end{itemize}

К жёлтой зоне относятся:

\begin{itemize}
  \item \textbf{Модельный оператор $\hat H[\theta]$ для солитонов.}
        \begin{itemize}
          \item Необходимо согласованно определить поле
                $c(\theta,x)$ для конфигураций, описываемых
                графами/узлами $G_\theta$.
          \item Нужны тесты на устойчивость спектра при деформациях
                $\theta$ и смене топологии.
        \end{itemize}

  \item \textbf{Функционал массы $M_{\mathrm{sol}}[\theta]$.}
        \begin{itemize}
          \item Схема ``спектр + топология'' уже сформулирована,
                но конкретный вид весов $w(\omega)$ и
                нормировочных коэффициентов требует калибровки по
                реальным массам (протон, нейтрон, лёгкие ядра).
        \end{itemize}

  \item \textbf{Функционал уровней $F_{\mathrm{levels}}$.}
        \begin{itemize}
          \item Необходимо реализовать:
                \begin{enumerate}
                  \item штраф за отклонение вычисленных уровней
                        от экспериментальных;
                  \item штраф за низкопорядковые резонансы
                        (устойчивость);
                  \item интерфейс к модулю DOS/LDOS.
                \end{enumerate}
          \item Требуются модели для водорода и гелия как базовые
                тесты.
        \end{itemize}

  \item \textbf{Геометрический функционал $F_{\mathrm{geom}}$.}
        \begin{itemize}
          \item Нужно зафиксировать конкретный набор геометрических
                характеристик (число пересечений, меры симметрии,
                ветвистости и т.п.).
          \item Ввести нормировку и весовые коэффициенты так, чтобы
                минимума достигали ожидаемые конфигурации
                (He, C, Ne и др.).
        \end{itemize}

  \item \textbf{Систематические расчёты для H--Ne.}
        \begin{itemize}
          \item Для каждого $Z\le 10$ необходимо:
                \begin{enumerate}
                  \item задать семейство прототипов $G_{\theta_Z}$;
                  \item провести оптимизацию по $\theta_Z$;
                  \item сравнить спектральные и геометрические
                        свойства с экспериментом/химией.
                \end{enumerate}
        \end{itemize}

  \item \textbf{Интеграционные схемы повышенной точности.}
        \begin{itemize}
          \item Базовые интегралы по $\omega$ и $x$ уже определены,
                но не реализованы адаптивные и многомасштабные схемы.
          \item Фрактальный метод разложения (FDM) пока существует
                только на уровне постановки.
        \end{itemize}
\end{itemize}

По мере закрытия этих задач элементы будут переноситься в зелёную зону.


\section{Дальняя программа (``красная зона'')}
\label{sec:status-red}

``Красная зона'' --- это программа исследований на годы вперёд.
Здесь находятся задачи, для которых:

\begin{itemize}
  \item пока нет общепринятой физической картины;
  \item внутри данной модели сформулированы только общие направления;
  \item требуется серьёзная теоретическая и численная работа, а также
        независимая экспериментальная проверка.
\end{itemize}

К красной зоне относятся:

\begin{itemize}
  \item \textbf{Микрофизика Среды.}
        \begin{itemize}
          \item В этом документе Среда рассматривается как эффективный
                континуум. Вопрос о её ``микроскопической'' структуре
                (дискретность, субволновые степени свободы и т.п.)
                отложен.
        \end{itemize}

  \item \textbf{Полная карта узлов/частиц.}
        \begin{itemize}
          \item Требуется построить сопоставление между классами узлов
                и наблюдаемыми типами частиц (лептоны, барионы,
                мезоны и др.).
          \item Нужен систематический расчёт масс и уровней для
                большого числа топологий.
        \end{itemize}

  \item \textbf{Химия и материалы за пределами лёгких элементов.}
        \begin{itemize}
          \item Расширение Геометрической Таблицы на тяжёлые элементы,
                изотопы, сложные молекулы.
          \item Применение теоремы ``ёлки'' и деревьев роста для
                реальных кристаллов и аморфных структур.
        \end{itemize}

  \item \textbf{Динамика и нестационарные процессы.}
        \begin{itemize}
          \item Проскальзывание солитонов, столкновения, распады.
          \item ``Зажигание'' и ``затухание'' узлов в Среде.
        \end{itemize}

  \item \textbf{Космологические и астрофизические явления.}
        \begin{itemize}
          \item Описание вращения галактик, кластеров и космических
                структур через спектральный потенциал.
          \item Переформулировка тёмной материи и тёмной энергии
                как спектральных эффектов.
        \end{itemize}

  \item \textbf{Экспериментальные тесты нового типа.}
        \begin{itemize}
          \item Поиск специфических спектральных и геометрических
                сигнатур (в лаборатории и астрофизике), которые не
                объясняются стандартной моделью.
        \end{itemize}
\end{itemize}


\section{Связь с существующей литературой}
\label{sec:literature-link}

В этой работе сознательно используется минимальный набор внешних
понятий, однако модель не возникает в пустоте. Ниже схематично
обозначены направления, с которыми она концептуально перекликается.

\begin{itemize}
  \item \textbf{Спектральные подходы к геометрии и гравитации.}
        \begin{itemize}
          \item Операторное описание пространства и поля через
                спектр $\hat H$ и плотность состояний.
          \item Идея логарифмического потенциала
                $\phi \sim -\ln\rho_{\mathrm{spec}}$ и спектральной
                кривизны.
        \end{itemize}

  \item \textbf{Твёрдотельная физика и DOS.}
        \begin{itemize}
          \item Понятия DOS и LDOS, сингулярности Ван Хова.
          \item Методы функций Грина и KKR-подобные схемы для расчёта
                спектров.
        \end{itemize}

  \item \textbf{Топологические солитоны и узлы.}
        \begin{itemize}
          \item Представление частиц как вихревых/узловых структур.
          \item Использование топологических инвариантов (число
                пересечений и др.) как мер сложности.
        \end{itemize}

  \item \textbf{Фрактальные и деревообразные структуры.}
        \begin{itemize}
          \item Математика ветвящихся деревьев, распределений
                расстояний и предельного поведения (``ёлки'').
          \item Применение к росту молекул, кристаллов и сетей связей.
        \end{itemize}
\end{itemize}

Данный документ принимает эти направления как вдохновляющий фон, но
формулирует \emph{самодостаточную} модель в собственных терминах
(Среда, спектр, солитоны, функционалы).


\section{Организация кода и репозиториев}
\label{sec:code-organization}

Для практической работы с моделью и совместной разработки кода
целесообразно придерживаться следующей структуры.

\subsection*{Структура репозитория}

\begin{itemize}
  \item \texttt{/docs/}
        \begin{itemize}
          \item LaTeX-исходники этого документа (текущая книга).
          \item Отдельные заметки по численным экспериментам.
        \end{itemize}

  \item \texttt{/core/}
        \begin{itemize}
          \item Базовые структуры данных (сетki, графы, параметры
                $\theta$).
          \item Общие утилиты (линейная алгебра, логирование).
        \end{itemize}

  \item \texttt{/env/}
        \begin{itemize}
          \item Реализация спектральной Среды и модуля гравитации
                (раздел~\ref{sec:module-env}).
        \end{itemize}

  \item \texttt{/operatorH/}
        \begin{itemize}
          \item Построение $H(\theta)$,
                расчёт DOS/LDOS
                (раздел~\ref{sec:module-H}).
        \end{itemize}

  \item \texttt{/functionals/}
        \begin{itemize}
          \item Реализации $F_{\mathrm{levels}}$,
                $F_{\mathrm{geom}}$,
                $F_{\mathrm{atom}}$,
                $M_{\mathrm{sol}}$ и др.
        \end{itemize}

  \item \texttt{/optimize/}
        \begin{itemize}
          \item Symmetric Newton и вспомогательные методы.
          \item Модуль интегралов по $\omega$, $x$ и $\theta$.
        \end{itemize}

  \item \texttt{/examples/}
        \begin{itemize}
          \item Набор сценариев:
                \begin{enumerate}
                  \item гравитация простых спектральных ям;
                  \item игрушечные решётки и LDOS-карты;
                  \item прототипы атомов H, He, C, O, Ne.
                \end{enumerate}
        \end{itemize}

  \item \texttt{/tests/}
        \begin{itemize}
          \item Набор регрессионных тестов и проверок корректности
                (сходимость, симметрии, сохранение норм).
        \end{itemize}
\end{itemize}

\subsection*{Практические рекомендации}

\begin{itemize}
  \item Каждая новая физическая идея должна сопровождаться:
        \begin{enumerate}
          \item формулировкой в терминах $\rho_{\mathrm{spec}}$,
                $\hat H[\theta]$, функционалов;
          \item минимальным численным примером в \texttt{/examples/};
          \item тестом в \texttt{/tests/}, который фиксирует ожидаемое
                поведение.
        \end{enumerate}
  \item Любые изменения в фундаментальных определениях (способ
        построения $H$, вид $F_{\mathrm{atom}}$ и т.п.) должны сначала
        обсуждаться и фиксироваться в \texttt{/docs/} с указанием
        мотивировки.
  \item Репозиторий должен быть пригоден как для теоретической работы
        (анализ функционалов), так и для инженерных задач
        (материаловедение, моделирование сред).
\end{itemize}

Эта организация кода и документации должна обеспечить воспроизводимость
результатов и постепенное наращивание возможностей модели без потери
целостности.

\section{Игрушечные модели и проверочные эксперименты}
\label{sec:toy-models}

Вся онтология Среды, спектров и солитонов построена так, чтобы в
принципе описывать реальный мир. Но на нулевой стадии гораздо проще и
надёжнее работать с \emph{игрушечными моделями}: сильно упрощёнными
версиями Среды, где всё можно посчитать, визуализировать и руками
проверить формулы из предыдущих разделов.

В этой секции мы фиксируем несколько базовых игрушечных моделей, которые
должны сопровождать развитие кода и служить постоянными тестами
адекватности онтологии.

\subsection{1D-модель Среды на отрезке}
\label{subsec:toy-1d}

Начнём с максимально простого случая: одномерная Среда на отрезке
$[0,L]$. Координату обозначим $x\in[0,L]$, а поле малых колебаний —
$\psi(x,t)$.

\subsubsection*{Линейный оператор малых колебаний}

Игрушечный оператор малых колебаний $ \hat H $ возьмём в виде
\begin{equation}
  \hat H \psi(x)
  =
  -\frac{d}{dx}
    \Bigl(
      c^2(x)\frac{d\psi}{dx}
    \Bigr)
  + V_{\text{eff}}(x)\,\psi(x),
  \label{eq:toy-1d-H}
\end{equation}
с граничными условиями, например, Дирихле
\[
  \psi(0) = \psi(L) = 0.
\]

Здесь:
\begin{itemize}
  \item $c(x)$ — локальная «скорость волн» в Среде,
  \item $V_{\text{eff}}(x)$ — эффективный потенциал, отвечающий за
        локальные спектральные особенности (ямы, барьеры и т.п.).
\end{itemize}

Спектр $ \hat H $ задаётся задачей на собственные значения
\begin{equation}
  \hat H \psi_n(x) = \omega_n^2 \psi_n(x),
  \qquad
  n=1,2,\dots
  \label{eq:toy-1d-eigen}
\end{equation}
с ортонормированием
\[
  \int_0^L \psi_n(x)\psi_m(x)\,dx = \delta_{nm}.
\]

\subsubsection*{Дискретизация и матрица $H$}

Для численной реализации вводим сетку
\[
  x_j = j\,\Delta x,
  \qquad
  j = 0,1,\dots,N,
  \quad
  \Delta x = \frac{L}{N}.
\]

Пусть значения поля на внутренних узлах $j=1,\dots,N-1$ собраны в
вектор
\[
  \Psi = (\psi_1,\dots,\psi_{N-1})^\top.
\]

Тогда оператор $\hat H$ заменяется разреженной матрицей $H$ размера
$(N-1)\times(N-1)$, которая реализует дискретный аналог
формулы~\eqref{eq:toy-1d-H}. В простейшем симметричном варианте:
\begin{align}
  (H\Psi)_j
  &=
  -\frac{1}{\Delta x}
    \Bigl[
      c^2_{j+\frac12}
      \frac{\psi_{j+1}-\psi_j}{\Delta x}
      -
      c^2_{j-\frac12}
      \frac{\psi_j-\psi_{j-1}}{\Delta x}
    \Bigr]
  + V_j \psi_j,
  \label{eq:toy-1d-discrete}
\end{align}
где:
\[
  c^2_{j\pm\frac12}
  = c^2\bigl(x_j \pm \tfrac12\Delta x\bigr),
  \qquad
  V_j = V_{\text{eff}}(x_j).
\]

Этот рецепт дискретизации — первый тест для модуля
\texttt{/operatorH/}: на нём удобно проверять корректность построения
разреженной матрицы и численных методов поиска собственных значений.

\subsubsection*{Игрушечный солитон как одна спектральная яма}

В одномерной игрушечной модели «солитон» можно смоделировать как
локальную спектральную яму — область, где $V_{\text{eff}}(x)$ понижен
относительно фона, а $c(x)$ слегка модифицирован:
\begin{align}
  V_{\text{eff}}(x)
  &=
  V_0
  - \Delta V\,
    \exp\!\left[
      -\frac{(x-x_0)^2}{2\sigma^2}
    \right],
  \label{eq:toy-1d-well-V}
  \\
  c(x)
  &=
  c_0
  \Bigl(1 - \varepsilon_c\, f_c(x)\Bigr),
  \qquad
  f_c(x) \text{ тоже локализована около } x_0.
  \label{eq:toy-1d-well-c}
\end{align}

Интуитивно:
\begin{itemize}
  \item «частица» — это локальная мода (или набор мод) в яме
        \eqref{eq:toy-1d-well-V};
  \item «масса» этой частицы связана с тем, как сильно изменён спектр
        $ \hat H $ по сравнению с пустым фоном.
\end{itemize}

Здесь можно явно увидеть связь онтологии с численным экспериментом:
\begin{enumerate}
  \item Сначала считаем собственные значения для пустого фона
        ($\Delta V=0$, $\varepsilon_c=0$).
  \item Потом вводим яму \eqref{eq:toy-1d-well-V},
        \eqref{eq:toy-1d-well-c} и пересчитываем спектр.
  \item Разность в DOS/LDOS интерпретируем как вклад солитона
        в энергетический функционал $F$ и эффективную массу.
\end{enumerate}

\subsection{Две ямы и аналог гравитационного притяжения}
\label{subsec:toy-1d-two-wells}

Следующий шаг — модель с двумя спектральными ямами на отрезке:
\[
  V_{\text{eff}}(x)
  =
  V_0
  - \Delta V\,
    \Bigl[
      \exp\!\bigl(-\tfrac{(x-x_1)^2}{2\sigma^2}\bigr)
      +
      \exp\!\bigl(-\tfrac{(x-x_2)^2}{2\sigma^2}\bigr)
    \Bigr].
\]

Идея такая:
\begin{itemize}
  \item при большом расстоянии $|x_1-x_2|$ каждая яма ведёт себя почти
        независимо, спектр — грубая сумма двух одиночных;
  \item при сближении ям появляются расщепления уровней, изменяется
        DOS/LDOS между ними;
  \item этот сдвиг спектрального функционала $F$ можно интерпретировать
        как эффективный «потенциал взаимодействия» двух солитонов.
\end{itemize}

В рамках онтологии Среды «гравитация» между солитонами должна
проявляться как стремление конфигурации минимизировать общий
функционал $F$, который чувствителен к спектру \emph{Системы в целом},
а не к каждой яме отдельно.

Игрушечный численный эксперимент:
\begin{enumerate}
  \item Фиксируем параметры одной ямы (масштаб, глубину, форму).
  \item Вводим вторую яму с теми же параметрами и начинаем двигать
        расстояние $d = |x_1-x_2|$.
  \item Для каждого $d$ пересчитываем спектр, DOS/LDOS и
        функционал $F(d)$.
  \item Строим график $F(d)$ и смотрим, есть ли минимум при конечном
        $d$ и какая асимптотика при больших $d$.
\end{enumerate}

Если минимальная модель Среды жизнеспособна, то на таком уровне
должен проявиться хотя бы грубый аналог притяжения: при небольших
деформациях $c(x)$ и $V_{\text{eff}}(x)$ общий функционал выгоднее
делать ямы ближе, чем бесконечно далеко друг от друга.

\subsection{Проверка принципа эквивалентности (игрушечная версия)}
\label{subsec:toy-equivalence}

В обычной физике принцип эквивалентности формулируется как равенство
инертной и гравитационной масс. В спектральной онтологии можно
предложить следующий игрушечный тест.

\subsubsection*{Инертная масса в 1D-модели}

Рассмотрим в 1D-модели солитонную конфигурацию (одну яму) и сдвинем её
как целое:
\[
  x_0 \longrightarrow x_0 + \delta x.
\]

Инертную массу можно связать с «ценой» ускоренного движения этой
конфигурации. На уровне игрушечной модели это сводится к оценке
эффективного кинетического термина в пространстве параметров
$\theta = x_0$:
\begin{equation}
  M_{\text{inert}}^{\text{(toy)}}
  \propto
  \Bigl\langle
    \frac{\partial \psi_\theta}{\partial \theta},
    \frac{\partial \psi_\theta}{\partial \theta}
  \Bigr\rangle,
  \label{eq:toy-M-inert}
\end{equation}
где $\psi_\theta$ — набор собственных мод или эффективное поле,
описывающее конфигурацию.

\subsubsection*{Гравитационная масса в 1D-модели}

Гравитационная масса в онтологии Среды связана с тем, насколько
конфигурация деформирует спектральную Среду и тем самым меняет
гравитационный функционал Среды. В 1D-модели можно определить
игрушечную гравитационную массу как:
\begin{equation}
  M_{\text{grav}}^{\text{(toy)}}
  \propto
  \int_0^L
    \bigl[
      \rho_{\text{spec}}(x;\theta)
      -
      \rho_{\text{spec}}^{(0)}(x)
    \bigr]
  \,dx,
  \label{eq:toy-M-grav}
\end{equation}
где $\rho_{\text{spec}}^{(0)}$ — спектр пустой Среды, а
$\rho_{\text{spec}}(x;\theta)$ —
спектр с солитоном.

Задача для игрушечного кода: показать, что
\[
  M_{\text{inert}}^{\text{(toy)}}
  \approx
  M_{\text{grav}}^{\text{(toy)}}
\]
для широкого класса ям \eqref{eq:toy-1d-well-V}, \eqref{eq:toy-1d-well-c}.
Если это выполняется хотя бы качественно, то есть смысл надеяться, что
в более реалистичных моделях Среды сохранится аналог принципа
эквивалентности.

\subsection{3D-игрушка: минимальный объёмный прототип атома}
\label{subsec:toy-3d}

Двумерная решётка полезна для визуализации, но реальная геометрическая
таблица атомов живёт в трёх измерениях. Поэтому нам нужна минимальная
3D-игрушка: достаточно простая для численного эксперимента, но уже
содержащая характерные объёмные эффекты.

\subsubsection*{Область, сетка и оператор}

Рассматриваем трёхмерную область
\[
  (x,y,z)\in[0,L_x]\times[0,L_y]\times[0,L_z]
\]
с равномерной сеткой
\[
  x_i = i\,\Delta x,\quad i=0,\dots,N_x,
  \qquad
  y_j = j\,\Delta y,\quad j=0,\dots,N_y,
  \qquad
  z_k = k\,\Delta z,\quad k=0,\dots,N_z.
\]

Внутренние узлы $(i,j,k)$ с
\[
  i=1,\dots,N_x-1,\quad
  j=1,\dots,N_y-1,\quad
  k=1,\dots,N_z-1
\]
собираем в вектор значений поля
\[
  \Psi = \{\psi_{i,j,k}\}.
\]

Игрушечный оператор малых колебаний в 3D записываем в том же духе:
\begin{equation}
  \hat H \psi(x,y,z)
  =
  -\nabla\cdot\bigl(c^2(x,y,z)\nabla\psi(x,y,z)\bigr)
  + V_{\text{eff}}(x,y,z)\,\psi(x,y,z),
  \label{eq:toy-3d-H}
\end{equation}
с граничными условиями Дирихле
\[
  \psi|_{\partial\Omega} = 0,
  \qquad
  \Omega = [0,L_x]\times[0,L_y]\times[0,L_z].
\]

На сетке это даёт разреженную матрицу $H$ размера
\[
  N_\text{dof} = (N_x-1)(N_y-1)(N_z-1),
\]
с классическим шеститочечным (или двадцатишеститочечным, если хотим)
шаблоном, модифицированным анизотропными коэффициентами $c^2$ и
локальным потенциалом $V_{\text{eff}}$.

В простейшем случае, если ограничиться шеститочечным шаблоном и
равномерной сеткой, дискретный оператор можно описать как
\begin{align}
  (H\Psi)_{i,j,k}
  &=
  -\frac{1}{\Delta x}
    \Bigl[
      c^2_{i+\frac12,j,k}
      \frac{\psi_{i+1,j,k}-\psi_{i,j,k}}{\Delta x}
      -
      c^2_{i-\frac12,j,k}
      \frac{\psi_{i,j,k}-\psi_{i-1,j,k}}{\Delta x}
    \Bigr]
  \nonumber\\
  &\quad
  -\frac{1}{\Delta y}
    \Bigl[
      c^2_{i,j+\frac12,k}
      \frac{\psi_{i,j+1,k}-\psi_{i,j,k}}{\Delta y}
      -
      c^2_{i,j-\frac12,k}
      \frac{\psi_{i,j,k}-\psi_{i,j-1,k}}{\Delta y}
    \Bigr]
  \nonumber\\
  &\quad
  -\frac{1}{\Delta z}
    \Bigl[
      c^2_{i,j,k+\frac12}
      \frac{\psi_{i,j,k+1}-\psi_{i,j,k}}{\Delta z}
      -
      c^2_{i,j,k-\frac12}
      \frac{\psi_{i,j,k}-\psi_{i,j,k-1}}{\Delta z}
    \Bigr]
  + V_{i,j,k}\,\psi_{i,j,k},
  \label{eq:toy-3d-discrete}
\end{align}
где $c^2_{i\pm\frac12,j,k}$ и т.п. — значения $c^2$ между узлами, а
$V_{i,j,k}$ — значения эффективного потенциала.

\subsubsection*{Сферически-симметричное включение}

Минимальный объёмный «игрушечный атом» делаем сферически-симметричным.
Пусть центр включения находится в точке $(x_0,y_0,z_0)$, а радиус
характерного ядра равен $R$. Тогда можно взять, например,
\begin{align}
  r(x,y,z) &= \sqrt{(x-x_0)^2 + (y-y_0)^2 + (z-z_0)^2},
  \\
  V_{\text{eff}}(x,y,z)
  &=
  V_0
  - \Delta V\, f_V\!\bigl(r(x,y,z)\bigr),
  \label{eq:toy-3d-well-V}
\end{align}
где $f_V(r)$ — сглаженная яма, например:
\[
  f_V(r) = \exp\!\left(-\frac{r^2}{2\sigma^2}\right)
  \quad\text{или}\quad
  f_V(r) =
  \begin{cases}
    1, & r<R,\\
    \text{плавный спад}, & r\in[R,R+\delta],\\
    0, & r>R+\delta.
  \end{cases}
\]

Аналогично можно модифицировать $c(x,y,z)$:
\begin{equation}
  c(x,y,z)
  =
  c_0\Bigl(1 - \varepsilon_c\, f_c(r)\Bigr),
  \label{eq:toy-3d-well-c}
\end{equation}
где $f_c(r)$ локализована в той же области.

С точки зрения онтологии Среды:

\begin{itemize}
  \item такое включение — минимальная трёхмерная «солитонная» ячейка;
  \item локализованные собственные моды $\psi_n(x,y,z)$ над ней —
        прототип «орбиталей»;
  \item мультиплеты по угловому моменту (в пределе хорошей
        сферической симметрии) — прямой аналог $s$-, $p$-, $d$- и т.д.
        «оболочек» в языке геометрической таблицы.
\end{itemize}

Численно это выглядит так:

\begin{enumerate}
  \item Строим $H$ для однородной Среды, убеждаемся, что низ спектра
        соответствует объёмным стоячим волнам.
  \item Вводим сферическое включение
        \eqref{eq:toy-3d-well-V}, \eqref{eq:toy-3d-well-c}.
  \item Находим несколько десятков нижних собственных значений и мод.
  \item Классифицируем моды по «похожести» на $s$-, $p$-, $d$-типы:
        численно это делается через:
        \begin{itemize}
          \item число узловых поверхностей;
          \item симметрии относительно поворотов и отражений;
          \item простые угловые моменты на грубой сферической сетке
                вокруг центра.
        \end{itemize}
\end{enumerate}

\subsubsection*{Кластер включений и прототип молекулы}

Далее вводим несколько включений
\[
  \{(x_a,y_a,z_a), \Delta V_a, R_a\},\quad a=1,\dots,M,
\]
с перекрывающимися или почти соприкасающимися областями. Это даёт
игрушечный кластер — минимальный прототип молекулы.

На уровне оператора:
\begin{equation}
  V_{\text{eff}}(x,y,z)
  =
  V_0
  - \sum_{a=1}^M
    \Delta V_a\, f^{(a)}_V\!\bigl(r_a(x,y,z)\bigr),
  \label{eq:toy-3d-cluster-V}
\end{equation}
где $r_a$ — расстояние до $a$-го центра.

Спектр такого кластера содержит:

\begin{itemize}
  \item локализованные моды, связанные с каждым включением по отдельности;
  \item «коллективные» моды кластера, отражающие взаимодействие;
  \item расщепления уровней при изменении взаимных расстояний и ориентаций.
\end{itemize}

Это даёт чисто спектральное определение «связи» в объёме:

\begin{itemize}
  \item энергия связи — это вклад в спектральный функционал $F$,
        возникающий при переходе от отдельных включений к кластеру;
  \item геометрия связи — это форма и топология тех мод, которые
        существенно меняются при образовании кластера;
  \item углы и длины «связей» — это уже не вводимые вручную параметры,
        а численно измеряемые характеристики максимума LDOS между
        включениями.
\end{itemize}

\subsubsection*{Минимальный численный план для 3D}

Даже при грубой сетке (например, $N_x=N_y=N_z\sim 30$) 3D-игрушка
остаётся тяжёлой задачей для лобового решения. Поэтому планируем:

\begin{enumerate}
  \item Использовать методы типа \emph{Lanczos} / \emph{Arnoldi}
        для поиска только нижней части спектра.
  \item Активно эксплуатировать разреженность $H$ и возможность
        распараллеливания умножения матрицы на вектор.
  \item Сначала отладить всё на очень маленьких решётках
        ($N_x=N_y=N_z\sim 10\text{--}16$), лишь бы восстановить
        структуру мультиплетов.
  \item Затем постепенно увеличивать размер сетки до тех пор,
        пока не начнут появляться устойчивые шаблоны, похожие
        на «атомные оболочки» из геометрической таблицы.
\end{enumerate}

Важный философский момент: в 3D-игрушке мы \emph{не} пытаемся
воспроизвести конкретный химический элемент. Задача существенно
скромнее:

\begin{itemize}
  \item убедиться, что онтология Среды в принципе порождает
        объёмные локализованные структуры с чёткой спектральной
        и геометрической иерархией;
  \item убедиться, что параметры включений
        (глубины $\Delta V_a$, радиусы $R_a$, относительные
        положения) \emph{управляемо} меняют эту иерархию;
  \item подготовить площадку для сопоставления с реальной
        геометрической таблицей атомов в следующих версиях модели.
\end{itemize}

\subsection{План по численным экспериментам v0.1}
\label{subsec:toy-plan}

С точки зрения кода минимальный набор игрушечных экспериментов,
которые должны быть реализованы параллельно с развитием онтологии:

\begin{enumerate}
  \item \textbf{Пустой 1D-резонатор.}
        \begin{itemize}
          \item Построить $H$ для $c(x)\equiv c_0$, $V_{\text{eff}}\equiv 0$.
          \item Сравнить спектр $\omega_n^2$ с аналитическим решением.
        \end{itemize}

  \item \textbf{Одна яма.}
        \begin{itemize}
          \item Ввести профиль
                $V_{\text{eff}}(x)$ и $c(x)$ по
                \eqref{eq:toy-1d-well-V},
                \eqref{eq:toy-1d-well-c}.
          \item Вычислить несколько нижних собственных значений и
                LDOS, визуализировать локализованные моды.
        \end{itemize}

  \item \textbf{Две ямы и взаимодействие.}
        \begin{itemize}
          \item Реализовать зависимость спектра и функционала $F(d)$
                от расстояния между ямами $d$.
          \item Построить графики $F(d)$, $\Delta\rho(\omega,x;d)$.
        \end{itemize}

  \item \textbf{Игрушечный принцип эквивалентности.}
        \begin{itemize}
          \item Оценить
                $M_{\text{inert}}^{\text{(toy)}}$ по
                \eqref{eq:toy-M-inert}
                и
                $M_{\text{grav}}^{\text{(toy)}}$ по
                \eqref{eq:toy-M-grav}
                для семейства ям.
          \item Проверить, в какой мере они пропорциональны и от чего
                зависит коэффициент пропорциональности.
        \end{itemize}
\end{enumerate}

Эти эксперименты не «доказывают» модель Среды, но служат важным
фильтром: если даже на таком уровне не проявляются ожидаемые свойства
(локализация мод, взаимодействие «солитонов», аналог принципа
эквивалентности), то онтологию нужно корректировать до выхода на
реалистические масштабы.

\appendix

\section*{Приложения}
\addcontentsline{toc}{section}{Приложения}

\section{Компактный список постулатов v0.1}
\label{app:postulates}

Этот раздел даёт сжатую версию постулатов из
раздела~\ref{sec:postulates}. Он полезен как «шпаргалка» при чтении
остальных частей книги и при работе с кодом.

\subsection*{Постулат 1. Антирелятивистский}

Фундаментальное описание мира не использует искривлённое
пространство-время, динамическую метрику и тензор кривизны. Все
гравитационные эффекты должны быть сведены к свойствам физической
Среды и её спектра.

\subsection*{Постулат 2. Пространство и время}

Пространство $X \simeq \mathbb{R}^3$ евклидово, с фиксированной
метрикой $\bar g_{ij} = \delta_{ij}$. Время $t\in\mathbb{R}$ — параметр
эволюции состояний Среды, а не координата геометрического
многообразия.

\subsection*{Постулат 3. Единая физическая Среда}

Всё пространство заполнено непрерывной Средой, способной поддерживать
волны и нелинейные локализованные структуры. Покой Среды задаёт
предпочтительную систему отсчёта.

\subsection*{Постулат 4. Спектральное описание}

Состояние Среды описывается локальной спектральной плотностью
$\rho_{\text{spec}}(\omega,x,t)\ge 0$ по частотам и координатам. Все
физические эффекты должны быть, в конечном счёте, выражены через
спектральные характеристики.

\subsection*{Постулат 5. Спектральная гравитация}

Гравитация — это эффект спектрального состояния Среды. Через
гравитационно значимую мощность $I_{\text{grav}}(x,t)$ определяется
спектральный потенциал
\[
  \phi(x,t) = -\ln I_{\text{grav}}(x,t) + \text{const},
\]
а эффективное поле ускорений задаётся градиентом
$\bm g(x,t) = -\nabla\phi(x,t)$.

\subsection*{Постулат 6. Материя как солитоны}

Материальные объекты — устойчивые локализованные процессы (солитоны,
вихри, узлы) в Среде. Тип «частицы» соответствует классу эквивалентных
солитонных конфигураций с минимальным функционалом состояния.

\subsection*{Постулат 7. Линейный оператор малых колебаний}

Для каждой конфигурации Среды существует линейный оператор малых
колебаний $\hat H[\theta]$, спектр которого описывает локальные моды
вокруг этой конфигурации. Он служит мостом между геометрией
конфигурации и её спектром.

\subsection*{Постулат 8. DOS/LDOS и функция Грина}

Спектральные свойства конфигурации задаются её плотностью состояний
(DOS/LDOS), выражаемой через функцию Грина
$G(z;\theta) = (z - \hat H[\theta])^{-1}$. Глобальная DOS
$\rho(\omega;\theta)$ и локальная LDOS $\rho(\omega,x;\theta)$ — базовые
величины для всех функционалов.

\subsection*{Постулат 9. Масса и топология}

Эффективная масса солитона задаётся функционалом от спектра и
топологической структуры:
\[
  M_{\text{sol}}[\theta]
  = M_{\text{spec}}\big[\rho(\omega;\theta)\big]
  + M_{\text{top}}[G_\theta].
\]
Топологическая сложность (узлы, сцепления, деревья) вносит вклад в
энергию и массу.

\subsection*{Постулат 10. Геометрическая таблица атомов}

Атом элемента с номером $Z$ — солитонная конфигурация, минимизирующая
функционал
\[
  F_{\text{atom}} = F_{\text{levels}} + F_{\text{geom}},
\]
где $F_{\text{levels}}$ сравнивает спектр с целевыми уровнями, а
$F_{\text{geom}}$ описывает геометрическую и топологическую структуру.
Валентность задаётся числом и ориентацией «портов» в LDOS.

\subsection*{Постулат 11. Вычислимость}

Любое высказывание, относящееся к физике модели, должно быть
в принципе вычислимо через $\hat H[\theta]$, DOS/LDOS,
спектральный потенциал $\phi$ и заданные функционалы. Остальное
относится к гипотезам и дорожной карте.

\bigskip
Компактно: мир = евклидово пространство + непрерывная Среда;
материя = солитоны; гравитация = спектральный потенциал; атомы =
минимумы функционалов по спектру и геометрии; всё должно быть
вычислимым.

%-------------------------------------------
\section{Минимальные математические определения и обозначения}
\label{app:math}
\label{app:math2025}

Этот раздел фиксирует набор обозначений, которые используются по
умолчанию во всей книге.

\subsection{Пространство, время и дифференциальные операторы}

\begin{itemize}
  \item $X \simeq \mathbb{R}^3$ — фоновое евклидово пространство.
  \item $x = (x^1,x^2,x^3)$ — декартовы координаты.
  \item Метрика: $\bar g_{ij} = \delta_{ij}$.
  \item Расстояние: $|x-y| = \sqrt{\sum_i (x^i - y^i)^2}$.
  \item Элемент объёма: $d^3x = dx^1 dx^2 dx^3$.
  \item Градиент скалярной функции $f$:
        \[
          \nabla f
          =
          \left(
            \frac{\partial f}{\partial x^1},
            \frac{\partial f}{\partial x^2},
            \frac{\partial f}{\partial x^3}
          \right).
        \]
  \item Дивергенция векторного поля $\bm v$:
        \[
          \operatorname{div}\bm v
          =
          \sum_{i=1}^3 \frac{\partial v^i}{\partial x^i}.
        \]
  \item Лапласиан:
        \[
          \Delta f = \operatorname{div}(\nabla f)
          = \sum_{i=1}^3 \frac{\partial^2 f}{\partial (x^i)^2}.
        \]
  \item Время $t\in\mathbb{R}$ — параметр эволюции состояний Среды.
\end{itemize}

\subsection{Спектральные величины}

\begin{itemize}
  \item $\omega$ — частота (угловая частота); диапазон интереса
        обозначаем через $\Omega$.
  \item $\rho_{\text{spec}}(\omega,x,t)\ge 0$ — локальная спектральная
        плотность Среды (вся совокупность мод).
  \item Разложение на продольный и поперечный каналы:
        \[
          \rho_{\text{spec}} = \rho_L + \rho_T.
        \]
  \item Гравитационно значимая продольная мощность:
        \[
          I_{\text{grav}}(x,t)
          = \int_\Omega \alpha_L(\omega)\,\rho_L(\omega,x,t)\,d\omega,
        \]
        где в минимальной версии $\alpha_L(\omega)\equiv 1$.
  \item Спектральный потенциал:
        \[
          \phi(x,t) = -\ln I_{\text{grav}}(x,t) + \text{const}.
        \]
  \item Поле ускорений:
        \[
          \bm g(x,t) = -\nabla \phi(x,t).
        \]
  \item Эффективный ньютоновский потенциал:
        \[
          \Phi_N(x) = c^2\bigl(\phi(x) - \phi_\infty\bigr),
        \]
        где $c$ — скорость поперечных волн (света) в Среде.
\end{itemize}

\subsection{Оператор малых колебаний и спектр}

\begin{itemize}
  \item $\theta$ — набор параметров солитонной конфигурации
        (положения, масштабы, деформации и т.п.).
  \item $\hat H[\theta]$ — линейный оператор малых колебаний Среды
        вокруг конфигурации $\theta$. В простейшем варианте:
        \[
          \hat H[\theta]\psi
          =
          -\nabla\cdot\bigl(c^2(\theta,x)\nabla\psi(x)\bigr)
          + V_{\text{eff}}(\theta,x)\psi(x).
        \]
  \item Собственные значения и функции:
        \[
          \hat H[\theta]\psi_n = \omega_n^2\psi_n.
        \]
  \item Функция Грина:
        \[
          G(z;\theta) = (z - \hat H[\theta])^{-1}.
        \]
  \item Глобальная DOS:
        \[
          \rho(\omega;\theta)
          = -\frac{1}{\pi}\Im\operatorname{Tr}
              G(\omega^2 + i0^+;\theta).
        \]
  \item Локальная LDOS:
        \[
          \rho(\omega,x;\theta)
          = -\frac{1}{\pi}\Im\,G(x,x;\omega^2 + i0^+;\theta).
        \]
\end{itemize}

\subsection{Топология, графы и функционалы}

\begin{itemize}
  \item $G_\theta$ — граф/узел, описывающий топологическую структуру
        конфигурации $\theta$ (вершины $V_\theta$, рёбра $E_\theta$,
        вложение в $X$).
  \item $C_{\text{cross}}[G_\theta]$ — эффективное число пересечений
        (мерa топологической сложности).
  \item $F_{\text{levels}}[\Theta]$ — спектральный функционал
        (совпадение уровней, отсутствие опасных резонансов,
        форма DOS).
  \item $F_{\text{geom}}[\Theta]$ — геометрический функционал
        (сложность графа, симметрия, статистика деревьев).
  \item Полный функционал состояния:
        \[
          F[\Theta]
          = F_{\text{levels}}[\Theta]
            + F_{\text{geom}}[\Theta]
            + F_{\text{add}}[\Theta].
        \]
  \item Атомный функционал для элемента $Z$:
        \[
          F_{\text{atom}}[\theta_Z]
          =
          \lambda_{\text{lev}}^{(Z)} F_{\text{levels}}[\theta_Z]
          +
          \lambda_{\text{geom}}^{(Z)} F_{\text{geom}}[G_{\theta_Z}].
        \]
\end{itemize}

Для быстрого чтения документа достаточно держать в голове:
$\rho_{\text{spec}}$, $I_{\text{grav}}$, $\phi$, $\bm g$,
$\hat H[\theta]$, $\rho(\omega)$, $\rho(\omega,x)$, $G_\theta$ и
функционалы $F_{\text{levels}}$, $F_{\text{geom}}$, $F_{\text{atom}}$.

%-------------------------------------------
\section{Состояние кода и внешние источники}
\label{app:code-and-refs}

Здесь даются короткие ориентиры: что уже реализовано в коде, что
нужно дописать и куда смотреть за пределами этого документа.

\subsection{Состояние кода v0.1 (чек-лист)}

\begin{itemize}
  \item \textbf{/core/}
        \begin{itemize}
          \item [\(\square\)] Базовые структуры сетки $X$ (1D/2D/3D).
          \item [\(\square\)] Представление графов $G_\theta$ (вершины,
                рёбра, вложение в пространство).
        \end{itemize}

  \item \textbf{/env/} — спектральная Среда и гравитация.
        \begin{itemize}
          \item [\(\square\)] Хранение $\rho_{\text{spec}}^{(0)}$ и
                $\delta\rho_{\text{spec}}$ на сетке.
          \item [\(\square\)] Функции для
                $I_{\text{grav}}(x)$,
                $\phi(x)$,
                $\bm g(x)$.
          \item [\(\square\)] Тесты на воспроизведение ньютоновского
                потенциала для простых конфигураций.
        \end{itemize}

  \item \textbf{/operatorH/}
        \begin{itemize}
          \item [\(\square\)] Построение разреженной матрицы
                $H(\theta)$ для 1D/2D сеток.
          \item [\(\square\)] Расчёт нескольких собственных значений
                (игрушечный спектр).
          \item [\(\square\)] Прототип функции DOS/LDOS по $H(\theta)$.
        \end{itemize}

  \item \textbf{/functionals/}
        \begin{itemize}
          \item [\(\square\)] Реализация базовой версии
                $F_{\text{levels}}$ (совпадение с целевыми частотами).
          \item [\(\square\)] Реализация $F_{\text{geom}}$
                (сложность + симметрия).
          \item [\(\square\)] Набор вспомогательных функций
                $F_{\text{atom}}$, $M_{\text{sol}}$.
        \end{itemize}

  \item \textbf{/optimize/}
        \begin{itemize}
          \item [\(\square\)] Symmetric Newton для малых
                размерностей $\theta$.
          \item [\(\square\)] Обёртки для численных интегралов по
                $\omega$ и $x$.
        \end{itemize}

  \item \textbf{/examples/}
        \begin{itemize}
          \item [\(\square\)] Гравитация одной спектральной ямы.
          \item [\(\square\)] 1D или 2D-решётка с вычислением DOS/LDOS.
          \item [\(\square\)] Простейший прототип геометрического
                атома (например, водород или гелий).
        \end{itemize}
\end{itemize}

Здесь галочки можно проставлять по мере того, как конкретные модули
доходят до рабочего состояния.

\subsection{Куда смотреть за пределами документа}

Этот текст принципиально самодостаточен, но при развитии модели полезно
держать в поле зрения несколько направлений:

\begin{itemize}
  \item Спектральная геометрия и операторы Лапласа на многообразиях
        (интуиция про «спектр $\Leftrightarrow$ геометрия»).
  \item Твёрдотельная физика: DOS, LDOS, сингулярности Ван Хова,
        методы функций Грина.
  \item Топологические солитоны и теория узлов: как считать
        инварианты, как они связаны с энергией.
  \item Математика случайных деревьев и процессов роста
        (для «модели ёлки» в кристаллографии и химии).
\end{itemize}

Конкретные ссылки и статьи можно добавить сюда по мере того, как
модель и код будут обрастать устойчивыми внешними опорами. На уровне
v0.1 достаточно понимать, в какие области литературы имеет смысл
заглядывать, не подменяя ими собственную онтологию Среды.

%-------------------------------------------
\section{Черновики: полярность цепочек C--C--O--H и Si--O--Si}

После анализа одиночных связей HF и HCl естественно перейти к
простым цепочкам, где вместе проявляются геометрические роли
(hub/bridge/terminator), знаковая геометрическая электроотрицательность
$\chi_{\text{geom}}^{\text{sgn}}$ и портовая геометрия. В качестве
минимальных тестовых мотивов рассмотрим цепочки C--C--O--H и Si--O--Si.

\subsection*{Фрагмент C--C--O--H: мостовой акцептор O в органической цепи}

В геометрической таблице элементы имеют следующие роли:
углерод C --- многопортовый \texttt{hub} с
$\chi_{\text{geom}}^{\text{sgn}}(\mathrm{C}) \approx 0$,
кислород O --- двухпортовый \texttt{bridge} с положительной
$\chi_{\text{geom}}^{\text{sgn}}(\mathrm{O})$ (акцептор),
водород H --- \texttt{terminator} с умеренно положительной
$\chi_{\text{geom}}^{\text{sgn}}(\mathrm{H})$, а связи C--C, C--O,
O--H образуют линейную цепочку:
\[
  \mathrm{C}_0 - \mathrm{C}_1 - \mathrm{O}_2 - \mathrm{H}_3.
\]

Геометрическая полярность каждой связи определяется как
\[
  \Delta\chi_{\text{geom}}(A\text{--}B)
  = \chi_{\text{geom}}^{\text{sgn}}(B)
  - \chi_{\text{geom}}^{\text{sgn}}(A).
\]
Численно в игрушечной реализации получается:
\begin{itemize}
  \item связь C$_0$--C$_1$ практически неполярна:
        $\Delta\chi_{\text{geom}}(\mathrm{C}_0\text{--}\mathrm{C}_1)
         \approx 0$;
  \item связь C$_1$--O$_2$ поляризована к кислороду:
        $\Delta\chi_{\text{geom}}(\mathrm{C}_1\text{--}\mathrm{O}_2) > 0$,
        поток электронной плотности направлен от C к O;
  \item связь O$_2$--H$_3$ также слегка поляризована в сторону кислорода
        (по модулю меньше, чем C--O): знак
        $\Delta\chi_{\text{geom}}(\mathrm{O}_2\text{--}\mathrm{H}_3)$
        таков, что эффективный поток идёт от H к O.
\end{itemize}

В сумме цепочка C--C--O--H в геометрической модели читается как
структурная пара C--C, к которой с одного конца прикреплён мостовой
акцептор O, собирающий на себе и часть плотности от углеродного
фрагмента, и долю от связанного водорода. Это соответствует привычной
химической картине: гидроксильная группа ``тянет'' электронную плотность
из углеродного скелета, повышая полярность и реакционную способность
фрагмента C--C--O--H.

\subsection*{Фрагмент Si--O--Si: мостиковый акцептор в силикатной сетке}

Для фрагмента Si--O--Si геометрическая таблица даёт:
кремний Si --- четырёхпортовый \texttt{hub} с
$\chi_{\text{geom}}^{\text{sgn}}(\mathrm{Si}) \approx 0$,
кислород O --- \texttt{bridge} с положительной
$\chi_{\text{geom}}^{\text{sgn}}(\mathrm{O}) > 0$. Линейный мотив
\[
  \mathrm{Si}_0 - \mathrm{O}_1 - \mathrm{Si}_2
\]
реализует типичный ``мостик'' в силикатных каркасах.

Геометрическая полярность связей в этой цепочке имеет вид:
\begin{itemize}
  \item связь Si$_0$--O$_1$ поляризована в сторону O:
        поток идёт от Si к O;
  \item связь O$_1$--Si$_2$ также, в эффективном смысле, направляет
        поток от второго Si к тому же кислородному центру.
\end{itemize}

Таким образом, кислород в мотиве Si--O--Si выступает как мостовой
акцептор между двумя структурными центрами Si: оба кремниевых
хаба относительно спектрально нейтральны, а O за счёт своей положительной
$\chi_{\text{geom}}^{\text{sgn}}$ и портовой геометрии \texttt{bent}
локально собирает на себе электронную плотность. Это хорошо согласуется
с интуитивной картиной силикатных сетей, где атомы кислорода играют роль
мостиковых анионов между тетраэдрами SiO$_4$.

\subsection*{Сетевой взгляд}

Обе рассмотренные цепочки иллюстрируют, как один и тот же аппарат
(геометрические роли, портовая геометрия и знаковая
$\chi_{\text{geom}}$) описывает не только отдельные связи, но и
распределение потоков в маленьких сетевых мотивах:
\begin{itemize}
  \item C--C--O--H: структурная пара hub--hub с примыкающим
        мостовым акцептором bridge--terminator;
  \item Si--O--Si: мостик hub--bridge--hub, в котором bridge
        выступает в роли локального стока.
\end{itemize}
На более сложных сетях тот же принцип позволяет рассматривать Среду
как систему узлов (hub), мостиков (bridge), терминаторов и
инертных центров, между которыми знаковая геометрическая
электроотрицательность задаёт направления эффективных потоков.

%-------------------------------------------
\section{Черновики: спектры графа атома как игрушечный LDOS}

До этого момента спектральный слой был описан концептуально: через
спектральную плотность $\rho_Z(\omega)$ и интеграл вида
\[
  F_{\text{spec}}(Z) = \int W_Z(\omega)\,\rho_Z(\omega)\,d\omega.
\]
Чтобы связать эти рассуждения с конкретной вычислимой моделью, введём
игрушечный спектр для графа, представляющего атом $Z$.

\subsection*{Канонический граф атома и лапласовский оператор}

Каждому атомному ``солитону'' $Z$ сопоставляется канонический граф
$G_Z$ с числом вершин $V_Z = \text{nodes}(Z)$ и рёбер
$E_Z = \text{edges}(Z)$:
\begin{itemize}
  \item вершины пронумерованы $0,\dots,V_Z-1$;
  \item сначала строится путь $0-1-2-\dots-(V_Z-1)$, обеспечивающий
        связность;
  \item затем добавляются дополнительные рёбра из вершины $0$ к
        вершинам $2,3,\dots$ до достижения требуемого числа рёбер
        $E_Z$.
\end{itemize}
Такой граф сохраняет ключевые геометрические параметры (число вершин,
рёбер, цикломатическое число $\mu_Z = E_Z - V_Z + 1$) и служит
игрушечной реализацией внутренней структуры атома в Среде.

По матрице смежности $A_Z$ канонического графа определяется
лапласовский оператор
\[
  L_Z = D_Z - A_Z,
\]
где $D_Z$ --- диагональная матрица степеней, $(D_Z)_{ii} = \deg(i)$.
Собственные значения $L_Z$,
\[
  0 = \lambda_0(Z) \le \lambda_1(Z) \le \dots \le \lambda_{V_Z-1}(Z),
\]
задают дискретный спектр $G_Z$, который можно рассматривать как
игрушечный аналог спектральной плотности $\rho_Z(\omega)$.

В коде \texttt{geom\_atoms.py} это реализовано методами
\texttt{canonical\_adjacency\_matrix()} и
\texttt{laplacian\_eigenvalues()} класса \texttt{AtomGraph}.

\subsection*{Спектральный масштаб $\varepsilon_{\text{spec}}(Z)$
и функционал $F_{\text{spec}}^{\text{toy}}$}

В качестве простейшей спектральной характеристики атома удобно выделить
так называемое значение Фидлера --- первое ненулевое собственное
значение лапласовского оператора:
\[
  \varepsilon_{\text{spec}}(Z)
  \;\equiv\;
  \lambda_1(Z),
\]
которое в теории графов измеряет ``жёсткость'' и связность $G_Z$.
Для одиночного узла (атом H) $\varepsilon_{\text{spec}} = 0$, для
двухузлового пути (He) получается $\lambda_1 = 2$, а для более сложных
графов значения $\lambda_1$ уменьшаются по мере появления циклов и
более распределённой топологии.

Дополнительно вводится игрушечный спектральный функционал:
\[
  F_{\text{spec}}^{\text{toy}}(Z)
  \;=\;
  \sum_{i=0}^{V_Z-1} \exp\bigl(-\beta\,\lambda_i(Z)\bigr),
\]
где $\beta$ --- небольшой параметр. При малых $\beta$ в сумму вносят
наибольший вклад малые собственные значения, так что
$F_{\text{spec}}^{\text{toy}}$ чувствителен в первую очередь к низкоэнергетической
части спектра.

В коде соответствующие величины реализованы методами
\texttt{epsilon\_spec()} и \texttt{F\_spec\_toy()}, а сводная таблица
по элементам H--Ar выводится функцией \texttt{print\_spectral\_summary()}.

\subsection*{Пример спектральной сводки для H--Ar}

Типичный численный вывод для элементов H--Ar имеет вид:
\[
\begin{array}{l}
\texttt{Spectral summary of atomic graphs (beta = 0.5)}\\
\texttt{El   Z ports  mu   lambda1  lambda\_max  eps\_spec    F\_spec}\\
\texttt{-------------------------------------------------------------}\\
\texttt{H    1     1   0     0.000      0.000     0.000     1.000}\\
\texttt{He   2     0   0     2.000      2.000     2.000     1.37}\\
\texttt{C    6     4   1     0.325      4.214     0.325     2.90}\\
\texttt{O    8     2   1     0.167      4.233     0.167     3.83}\\
\texttt{F    9     1   2     0.144      4.581     0.144     4.03}\\
\texttt{Ne  10     0   2     0.112      4.581     0.112     4.49}\\
\texttt{...}
\end{array}
\]

Качественно видно, что:
\begin{itemize}
  \item у H спектр вырожден в одно нулевое значение
        ($\varepsilon_{\text{spec}} = 0$);
  \item у He присутствует высокий одиночный масштаб
        $\varepsilon_{\text{spec}} \approx 2$, соответствующий
        жёсткой двухузловой связке;
  \item по мере роста сложности графа (возникновение циклов, рост числа
        рёбер при фиксированном числе вершин) спектр растягивается,
        а $\varepsilon_{\text{spec}}$ уменьшается;
  \item функционал $F_{\text{spec}}^{\text{toy}}(Z)$ плавно растёт
        с ростом ``объёма'' и разветвлённости графа, играя роль
        игрушечной спектральной меры сложности атома.
\end{itemize}

\subsection*{Связь с ранее введённым $F_{\text{spec}}$ и $\varepsilon_Z$}

В исходных черновиках спектральный вклад
$F_{\text{spec}}(Z)$ задавался через интеграл по спектральной плотности
$\rho_Z(\omega)$ и параметр $\varepsilon_Z$, измеряющий положение
характерного уровня относительно химического потенциала среды
$\mu_{\text{env}}$. В приведённой здесь игрушечной реализации:
\begin{itemize}
  \item дискретный спектр $\{\lambda_i(Z)\}$ играет роль набора
        ``уровней'' в пространстве графа;
  \item значение $\varepsilon_{\text{spec}}(Z) = \lambda_1(Z)$
        можно рассматривать как кандидата на ``спектральный масштаб''
        для дальнейшей подстановки в модель $\varepsilon_Z$;
  \item функционал $F_{\text{spec}}^{\text{toy}}(Z)$ --- один из возможных
        упрощённых вариантов спектрального вклада в общую энергию
        атома, который уже реально вычисляется по геометрии графа.
\end{itemize}

На более продвинутом этапе эта конструкция может быть усложнена:
вместо канонического графа $G_Z$ --- более точные топологии солитонных
структур Среды, вместо простой суммы $e^{-\beta \lambda_i}$ --- ядра,
ближе стоящие к реальным плотностям состояний. Тем не менее уже на
уровне текущей модели спектральный слой выходит из режима чисто
словесного описания и проявляется в виде конкретных вычислимых
спектров $L_Z$.

%-------------------------------------------
\section{Черновики: спектральный периодический закон}
\label{sec:drafts-spectral-periodic}

В геометрической таблице для элементов H--Ar ($Z=1\ldots 18$) уже были
введены роли \texttt{terminator}, \texttt{bridge}, \texttt{hub},
\texttt{inert} и геометрические характеристики
$F_{\text{geom}}$, $E_{\text{port}}$ и портовая геометрия.
Спектральный слой добавляет к этому набору ещё несколько величин:

\begin{itemize}
  \item $\varepsilon_{\text{spec}}(Z)$ --- эффективное
        спектральное ``положение'' атома, извлекаемое из
        спектра лапласиана канонического графа атома
        (через первую ненулевую собственную величину и
        нормировку);
  \item $F_{\text{spec}}(Z)$ --- интегральная спектральная
        энергия, получающаяся как игрушечный интеграл вида
        \[
          F_{\text{spec}}(Z)
          = \int_{\omega_{\min}}^{\omega_{\max}}
            W(\omega)\,\rho_Z(\omega)\,d\omega,
        \]
        где $\rho_Z(\omega)$ --- сглаженная LDOS лапласиана
        канонического графа, а $W(\omega)$ --- выбранная
        весовая функция (в коде реализованы экспоненциальный,
        квадратичный и линейный варианты);
  \item $E_{\text{port}}(Z)$ --- ``цена'' одного порта,
        определяемая как
        $E_{\text{port}} = F_{\text{geom}} / p_Z$ при
        $p_Z>0$;
  \item $\chi_{\text{spec}}(Z)$ --- знаковая
        геометрико-спектральная электроотрицательность:
        модуль $|\chi_{\text{spec}}|$ берётся пропорциональным
        $E_{\text{port}}$, а знак и демпфирование определяются
        положением $\varepsilon_{\text{spec}}(Z)$ относительно
        спектрального ``химического потенциала''
        $\mu_{\text{env}}^{\text{spec}}$.
\end{itemize}
Численные значения $\chi_{\text{spec}}(Z)$ калибруются по табличной
шкале Полинга: в коде для элементов H--Cl подбираются параметры
глобального масштаба $\alpha$, демпфирования доноров
$\gamma_{\text{donor}}$ и слабого фонового вклада хабов
$k_{\text{center}}$ так, чтобы сумма квадратов разностей
$\bigl(\chi_{\text{spec}}(Z) - \chi_{\text{Pauling}}(Z)\bigr)^2$
была минимальной. Для версии v1.0 получаются значения порядка
$\alpha \approx 1.24$, $\gamma_{\text{donor}} \approx 3.0$,
$k_{\text{center}} \approx 0.1$, что заметно снижает численное
расхождение с Полингом, не ломая при этом исходное разделение ролей
на доноров, акцепторов, структурные центры и инертные элементы.

Для удобства все эти величины сведены в явную табличку
\texttt{Spectral periodic table}, которую печатает функция
\texttt{print\_spectral\_periodic\_table()} в коде
\texttt{geom\_atoms.py}. В таблице для каждого $Z$ фиксируются:
атом, номер периода \texttt{per}, роль \texttt{role},
$\varepsilon_{\text{spec}}$, $F_{\text{exp}}$
(экспоненциальный вариант $F_{\text{spec}}$),
$E_{\text{port}}$ и $\chi_{\text{spec}}$.

\subsection*{Повторяемость спектрального кода по периодам}

Если посмотреть на строки для второго и третьего периодов,
получается спектральный аналог периодического закона:

\begin{itemize}
  \item пары Li--Na, Be--Mg, B--Al, C--Si, N--P, O--S, F--Cl, Ne--Ar
        имеют совпадающие роли (\texttt{terminator},
        \texttt{bridge}, \texttt{hub}, \texttt{inert}) и практически
        одинаковые численные значения
        $\varepsilon_{\text{spec}}$, $F_{\text{exp}}$,
        $E_{\text{port}}$ и $|\chi_{\text{spec}}|$;
  \item внутри одного периода (Li $\to$ Ne или Na $\to$ Ar)
        спектральные величины упорядочены по $Z$ --- например,
        $F_{\text{exp}}(Z)$ растёт от Li/Na к Ne/Ar;
  \item инертные газы Ne и Ar образуют отдельную ``вершину''
        по $F_{\text{exp}}$ при малом $E_{\text{port}}$ и
        нулевой $\chi_{\text{spec}}$, что соответствует
        замкнутым конфигурациям без активных портов.
\end{itemize}

То есть стандартный периодический закон
\[
  \text{``свойства элементов периодически повторяются с ростом }Z\text{''}
\]
в геометрико-спектральной модели переформулируется как
повторяемость \emph{спектрального кода} атома:
\[
  \bigl(
    \texttt{role}(Z),\,
    \varepsilon_{\text{spec}}(Z),\,
    F_{\text{spec}}(Z),\,
    E_{\text{port}}(Z),\,
    \chi_{\text{spec}}(Z)
  \bigr)
\]
при переходе от периода к периоду.

\subsection*{Ролевые полосы в спектральном пространстве}

Особенно наглядно это проявляется, если группировать элементы
по ролям:

\begin{itemize}
  \item \textbf{terminator} (H, Li, F, Na, Cl)
        разбиваются на два подтипа:
        ``металлические терминаторы'' Li/Na с
        $\varepsilon_{\text{spec}}\approx 1$ и умеренным
        по модулю $\chi_{\text{spec}}<0$, и
        ``галогеноподобные терминаторы'' F/Cl с малой
        $\varepsilon_{\text{spec}}$ и максимальным
        $|\chi_{\text{spec}}|\approx 4$;
  \item \textbf{bridge} (Be, Mg, O, S) формируют две пары
        с одинаковыми $\varepsilon_{\text{spec}}$ и
        близкими $F_{\text{exp}}$: металлические мосты
        Be/Mg и неметаллические мосты O/S;
  \item \textbf{hub} (B, C, N, Al, Si, P) образуют три
        спектральных ``уровня'' по $\varepsilon_{\text{spec}}$:
        B/Al, C/Si, N/P; при этом модуль $\chi_{\text{spec}}$
        у хабов существенно меньше, чем у терминаторов и мостов,
        что согласуется с их ролью структурных центров сетей;
  \item \textbf{inert} (He, Ne, Ar) характеризуются нулевым
        числом портов, $\chi_{\text{spec}}=0$ и сравнительно
        большими $F_{\text{exp}}$, то есть большими
        ``спектральными объёмами'' при отсутствии активных
        направлений для потоков.
\end{itemize}

Таким образом, в пространстве
$(\varepsilon_{\text{spec}}, F_{\text{spec}}, E_{\text{port}},
\chi_{\text{spec}})$ роли \texttt{terminator}, \texttt{bridge},
\texttt{hub}, \texttt{inert} уже фактически реализуются как
четыре полосы, которые повторяются при переходе от второго
периода к третьему. Это и есть спектральная форма
периодического закона в рамках предложенной геометрико-спектральной
модели: не только ``заряды и орбитали'', но и целый набор
спектральных инвариантов, которые повторяются на новых
масштабах $Z$.

%-------------------------------------------
\section{Черновики: Гармонический предел и энергия молекулы}
\label{sec:harmonic-limit}

\subsection{Спектральный функционал зарядов как гармоническое приближение}

В спектральной картине основным объектом считается не точечный заряд, а распределение плотности среды $\rho_{\text{spec}}(r)$. Полная энергия молекулы в идеале является некоторым (неизвестным нам явно) функционалом $F_{\text{full}}[\rho_{\text{spec}}]$, зависящим от формы солитонов-«атомов» и их взаимного спектрального и топологического расположения.

В практической модели мы работаем не с непрерывной $\rho_{\text{spec}}$, а с интегральными «зарядами» $q_i$ на атомах — отклонениями от нейтрального состояния. Тогда естественным шагом является квадратичное (гармоническое) приближение полного функционала по этим отклонениям:
\[
  F_{\text{flow}}(\{q_i\})
  \approx
  \sum_i \left( \chi_i^{\text{spec}}\, q_i + \frac{1}{2} \eta_i q_i^2 \right)
  + \frac{1}{2} \sum_{i \ne j} J_{ij} q_i q_j.
\]
Здесь $\chi_i^{\text{spec}}$ мы отождествляем с «спектральной электроотрицательностью» атома (первый производный от энергии по заряду), $\eta_i$ — с локальной «жесткостью» (у нас она связана с портовой энергией $E_{\text{port}}$), а $J_{ij}$ описывает взаимное отталкивание и поляризационную связь между атомами.

Минимизируя $F_{\text{flow}}$ по $\{q_i\}$ при фиксированной сумме зарядов, мы получаем стационарное распределение частичных зарядов и эффективный химический потенциал молекулы. Таким образом, QEq-подобная схема, которую мы используем, — это не отдельная «инородная механика», а гармоническое приближение к более общей спектральной энергетике. В этом смысле $F_{\text{flow}}$ играет роль «акустического предела» более сложной полевой теории.

\subsection{Полный энергофункционал молекулы $F_{\text{mol}}$}

Для ранжирования молекул по стабильности и оценки «цены» образования связей вводится полный молекулярный функционал $F_{\text{mol}}$, объединяющий геометрические, угловые и потоковые вклады:
\[
  F_{\text{mol}}
  = F_{\text{geom}} + F_{\text{angle}} + F_{\text{flow}}.
\]
Где:
\begin{itemize}
  \item $F_{\text{geom}} = \sum_i F_{\text{geom}}(Z_i)$ — сумма собственных геометрических энергий атомов (сложность графов);
  \item $F_{\text{angle}}$ — штраф за отклонение валентных углов от идеальных (например, sp3-тетраэдра);
  \item $F_{\text{flow}}$ — выигрыш (или проигрыш) энергии за счёт перераспределения электронной плотности (выравнивания химических потенциалов).
\end{itemize}

Примеры расчёта (по данным R\&D-лаборатории):
\begin{itemize}
  \item \textbf{H$_2$O}: $F_{\text{total}} \approx 8.0$. Система сильно стабилизирована, $F_{\text{flow}}$ мал, так как связь O--H близка к ковалентной в текущей калибровке.
  \item \textbf{HF}: $F_{\text{total}} \approx 4.5$. Низкая энергия (высокая стабильность), заметный вклад $F_{\text{flow}}$ из-за большой разности $\chi_{\text{spec}}$.
  \item \textbf{Si--O--Si}: $F_{\text{total}} \approx 16.8$. Более тяжёлая система, но стабилизированная сильным перетеканием заряда к мостиковому кислороду ($F_{\text{flow}} \approx -1.0$).
\end{itemize}

Такой подход позволяет в рамках единой модели сравнивать «геометрическую стоимость» атомов и «энергетическую выгоду» их соединения.

\end{document}
